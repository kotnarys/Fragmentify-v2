(function(Ie,Qe){typeof exports=="object"&&typeof module<"u"?Qe(exports):typeof define=="function"&&define.amd?define(["exports"],Qe):(Ie=typeof globalThis<"u"?globalThis:Ie||self,Qe(Ie["@walletconnect/sign-client"]={}))})(this,function(Ie){"use strict";var Qe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Kt(e){var t=e.default;if(typeof t=="function"){var r=function(){return t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var i=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,i.get?i:{enumerable:!0,get:function(){return e[n]}})}),r}function Za(e){try{return JSON.stringify(e)}catch{return'"[Circular]"'}}var Qa=ec;function ec(e,t,r){var n=r&&r.stringify||Za,i=1;if(typeof e=="object"&&e!==null){var s=t.length+i;if(s===1)return e;var a=new Array(s);a[0]=n(e);for(var c=1;c<s;c++)a[c]=n(t[c]);return a.join(" ")}if(typeof e!="string")return e;var l=t.length;if(l===0)return e;for(var f="",h=1-i,m=-1,b=e&&e.length||0,y=0;y<b;){if(e.charCodeAt(y)===37&&y+1<b){switch(m=m>-1?m:0,e.charCodeAt(y+1)){case 100:case 102:if(h>=l||t[h]==null)break;m<y&&(f+=e.slice(m,y)),f+=Number(t[h]),m=y+2,y++;break;case 105:if(h>=l||t[h]==null)break;m<y&&(f+=e.slice(m,y)),f+=Math.floor(Number(t[h])),m=y+2,y++;break;case 79:case 111:case 106:if(h>=l||t[h]===void 0)break;m<y&&(f+=e.slice(m,y));var D=typeof t[h];if(D==="string"){f+="'"+t[h]+"'",m=y+2,y++;break}if(D==="function"){f+=t[h].name||"<anonymous>",m=y+2,y++;break}f+=n(t[h]),m=y+2,y++;break;case 115:if(h>=l)break;m<y&&(f+=e.slice(m,y)),f+=String(t[h]),m=y+2,y++;break;case 37:m<y&&(f+=e.slice(m,y)),f+="%",m=y+2,y++,h--;break}++h}++y}return m===-1?e:(m<b&&(f+=e.slice(m)),f)}const zi=Qa;var Br=St;const lr=fc().console||{},tc={mapHttpRequest:Kr,mapHttpResponse:Kr,wrapRequestSerializer:xn,wrapResponseSerializer:xn,wrapErrorSerializer:xn,req:Kr,res:Kr,err:oc};function rc(e,t){return Array.isArray(e)?e.filter(function(n){return n!=="!stdSerializers.err"}):e===!0?Object.keys(t):!1}function St(e){e=e||{},e.browser=e.browser||{};const t=e.browser.transmit;if(t&&typeof t.send!="function")throw Error("pino: transmit option must have a send function");const r=e.browser.write||lr;e.browser.write&&(e.browser.asObject=!0);const n=e.serializers||{},i=rc(e.browser.serialize,n);let s=e.browser.serialize;Array.isArray(e.browser.serialize)&&e.browser.serialize.indexOf("!stdSerializers.err")>-1&&(s=!1);const a=["error","fatal","warn","info","debug","trace"];typeof r=="function"&&(r.error=r.fatal=r.warn=r.info=r.debug=r.trace=r),e.enabled===!1&&(e.level="silent");const c=e.level||"info",l=Object.create(r);l.log||(l.log=hr),Object.defineProperty(l,"levelVal",{get:h}),Object.defineProperty(l,"level",{get:m,set:b});const f={transmit:t,serialize:i,asObject:e.browser.asObject,levels:a,timestamp:ac(e)};l.levels=St.levels,l.level=c,l.setMaxListeners=l.getMaxListeners=l.emit=l.addListener=l.on=l.prependListener=l.once=l.prependOnceListener=l.removeListener=l.removeAllListeners=l.listeners=l.listenerCount=l.eventNames=l.write=l.flush=hr,l.serializers=n,l._serialize=i,l._stdErrSerialize=s,l.child=y,t&&(l._logEvent=Sn());function h(){return this.level==="silent"?1/0:this.levels.values[this.level]}function m(){return this._level}function b(D){if(D!=="silent"&&!this.levels.values[D])throw Error("unknown level "+D);this._level=D,rr(f,l,"error","log"),rr(f,l,"fatal","error"),rr(f,l,"warn","error"),rr(f,l,"info","log"),rr(f,l,"debug","log"),rr(f,l,"trace","log")}function y(D,R){if(!D)throw new Error("missing bindings for child Pino");R=R||{},i&&D.serializers&&(R.serializers=D.serializers);const P=R.serializers;if(i&&P){var j=Object.assign({},n,P),E=e.browser.serialize===!0?Object.keys(j):i;delete D.serializers,qr([D],E,j,this._stdErrSerialize)}function O(g){this._childLevel=(g._childLevel|0)+1,this.error=nr(g,D,"error"),this.fatal=nr(g,D,"fatal"),this.warn=nr(g,D,"warn"),this.info=nr(g,D,"info"),this.debug=nr(g,D,"debug"),this.trace=nr(g,D,"trace"),j&&(this.serializers=j,this._serialize=E),t&&(this._logEvent=Sn([].concat(g._logEvent.bindings,D)))}return O.prototype=this,new O(this)}return l}St.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},St.stdSerializers=tc,St.stdTimeFunctions=Object.assign({},{nullTime:Bi,epochTime:qi,unixTime:cc,isoTime:uc});function rr(e,t,r,n){const i=Object.getPrototypeOf(t);t[r]=t.levelVal>t.levels.values[r]?hr:i[r]?i[r]:lr[r]||lr[n]||hr,nc(e,t,r)}function nc(e,t,r){!e.transmit&&t[r]===hr||(t[r]=function(n){return function(){const s=e.timestamp(),a=new Array(arguments.length),c=Object.getPrototypeOf&&Object.getPrototypeOf(this)===lr?lr:this;for(var l=0;l<a.length;l++)a[l]=arguments[l];if(e.serialize&&!e.asObject&&qr(a,this._serialize,this.serializers,this._stdErrSerialize),e.asObject?n.call(c,ic(this,r,a,s)):n.apply(c,a),e.transmit){const f=e.transmit.level||t.level,h=St.levels.values[f],m=St.levels.values[r];if(m<h)return;sc(this,{ts:s,methodLevel:r,methodValue:m,transmitLevel:f,transmitValue:St.levels.values[e.transmit.level||t.level],send:e.transmit.send,val:t.levelVal},a)}}}(t[r]))}function ic(e,t,r,n){e._serialize&&qr(r,e._serialize,e.serializers,e._stdErrSerialize);const i=r.slice();let s=i[0];const a={};n&&(a.time=n),a.level=St.levels.values[t];let c=(e._childLevel|0)+1;if(c<1&&(c=1),s!==null&&typeof s=="object"){for(;c--&&typeof i[0]=="object";)Object.assign(a,i.shift());s=i.length?zi(i.shift(),i):void 0}else typeof s=="string"&&(s=zi(i.shift(),i));return s!==void 0&&(a.msg=s),a}function qr(e,t,r,n){for(const i in e)if(n&&e[i]instanceof Error)e[i]=St.stdSerializers.err(e[i]);else if(typeof e[i]=="object"&&!Array.isArray(e[i]))for(const s in e[i])t&&t.indexOf(s)>-1&&s in r&&(e[i][s]=r[s](e[i][s]))}function nr(e,t,r){return function(){const n=new Array(1+arguments.length);n[0]=t;for(var i=1;i<n.length;i++)n[i]=arguments[i-1];return e[r].apply(this,n)}}function sc(e,t,r){const n=t.send,i=t.ts,s=t.methodLevel,a=t.methodValue,c=t.val,l=e._logEvent.bindings;qr(r,e._serialize||Object.keys(e.serializers),e.serializers,e._stdErrSerialize===void 0?!0:e._stdErrSerialize),e._logEvent.ts=i,e._logEvent.messages=r.filter(function(f){return l.indexOf(f)===-1}),e._logEvent.level.label=s,e._logEvent.level.value=a,n(s,e._logEvent,c),e._logEvent=Sn(l)}function Sn(e){return{ts:0,messages:[],bindings:e||[],level:{label:"",value:0}}}function oc(e){const t={type:e.constructor.name,msg:e.message,stack:e.stack};for(const r in e)t[r]===void 0&&(t[r]=e[r]);return t}function ac(e){return typeof e.timestamp=="function"?e.timestamp:e.timestamp===!1?Bi:qi}function Kr(){return{}}function xn(e){return e}function hr(){}function Bi(){return!1}function qi(){return Date.now()}function cc(){return Math.round(Date.now()/1e3)}function uc(){return new Date(Date.now()).toISOString()}function fc(){function e(t){return typeof t<"u"&&t}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return e(self)||e(window)||e(this)||{}}}var ut={exports:{}},ir=typeof Reflect=="object"?Reflect:null,Ki=ir&&typeof ir.apply=="function"?ir.apply:function(t,r,n){return Function.prototype.apply.call(t,r,n)},Hr;ir&&typeof ir.ownKeys=="function"?Hr=ir.ownKeys:Object.getOwnPropertySymbols?Hr=function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:Hr=function(t){return Object.getOwnPropertyNames(t)};function lc(e){console&&console.warn&&console.warn(e)}var Hi=Number.isNaN||function(t){return t!==t};function Se(){Se.init.call(this)}ut.exports=Se,ut.exports.once=gc,Se.EventEmitter=Se,Se.prototype._events=void 0,Se.prototype._eventsCount=0,Se.prototype._maxListeners=void 0;var Vi=10;function Vr(e){if(typeof e!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}Object.defineProperty(Se,"defaultMaxListeners",{enumerable:!0,get:function(){return Vi},set:function(e){if(typeof e!="number"||e<0||Hi(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");Vi=e}}),Se.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},Se.prototype.setMaxListeners=function(t){if(typeof t!="number"||t<0||Hi(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this};function Gi(e){return e._maxListeners===void 0?Se.defaultMaxListeners:e._maxListeners}Se.prototype.getMaxListeners=function(){return Gi(this)},Se.prototype.emit=function(t){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=t==="error",s=this._events;if(s!==void 0)i=i&&s.error===void 0;else if(!i)return!1;if(i){var a;if(r.length>0&&(a=r[0]),a instanceof Error)throw a;var c=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw c.context=a,c}var l=s[t];if(l===void 0)return!1;if(typeof l=="function")Ki(l,this,r);else for(var f=l.length,h=Ji(l,f),n=0;n<f;++n)Ki(h[n],this,r);return!0};function Wi(e,t,r,n){var i,s,a;if(Vr(r),s=e._events,s===void 0?(s=e._events=Object.create(null),e._eventsCount=0):(s.newListener!==void 0&&(e.emit("newListener",t,r.listener?r.listener:r),s=e._events),a=s[t]),a===void 0)a=s[t]=r,++e._eventsCount;else if(typeof a=="function"?a=s[t]=n?[r,a]:[a,r]:n?a.unshift(r):a.push(r),i=Gi(e),i>0&&a.length>i&&!a.warned){a.warned=!0;var c=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");c.name="MaxListenersExceededWarning",c.emitter=e,c.type=t,c.count=a.length,lc(c)}return e}Se.prototype.addListener=function(t,r){return Wi(this,t,r,!1)},Se.prototype.on=Se.prototype.addListener,Se.prototype.prependListener=function(t,r){return Wi(this,t,r,!0)};function hc(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function Yi(e,t,r){var n={fired:!1,wrapFn:void 0,target:e,type:t,listener:r},i=hc.bind(n);return i.listener=r,n.wrapFn=i,i}Se.prototype.once=function(t,r){return Vr(r),this.on(t,Yi(this,t,r)),this},Se.prototype.prependOnceListener=function(t,r){return Vr(r),this.prependListener(t,Yi(this,t,r)),this},Se.prototype.removeListener=function(t,r){var n,i,s,a,c;if(Vr(r),i=this._events,i===void 0)return this;if(n=i[t],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,n.listener||r));else if(typeof n!="function"){for(s=-1,a=n.length-1;a>=0;a--)if(n[a]===r||n[a].listener===r){c=n[a].listener,s=a;break}if(s<0)return this;s===0?n.shift():dc(n,s),n.length===1&&(i[t]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",t,c||r)}return this},Se.prototype.off=Se.prototype.removeListener,Se.prototype.removeAllListeners=function(t){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[t]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[t]),this;if(arguments.length===0){var s=Object.keys(n),a;for(i=0;i<s.length;++i)a=s[i],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[t],typeof r=="function")this.removeListener(t,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(t,r[i]);return this};function ki(e,t,r){var n=e._events;if(n===void 0)return[];var i=n[t];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?pc(i):Ji(i,i.length)}Se.prototype.listeners=function(t){return ki(this,t,!0)},Se.prototype.rawListeners=function(t){return ki(this,t,!1)},Se.listenerCount=function(e,t){return typeof e.listenerCount=="function"?e.listenerCount(t):Xi.call(e,t)},Se.prototype.listenerCount=Xi;function Xi(e){var t=this._events;if(t!==void 0){var r=t[e];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}Se.prototype.eventNames=function(){return this._eventsCount>0?Hr(this._events):[]};function Ji(e,t){for(var r=new Array(t),n=0;n<t;++n)r[n]=e[n];return r}function dc(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}function pc(e){for(var t=new Array(e.length),r=0;r<t.length;++r)t[r]=e[r].listener||e[r];return t}function gc(e,t){return new Promise(function(r,n){function i(a){e.removeListener(t,s),n(a)}function s(){typeof e.removeListener=="function"&&e.removeListener("error",i),r([].slice.call(arguments))}Zi(e,t,s,{once:!0}),t!=="error"&&_c(e,i,{once:!0})})}function _c(e,t,r){typeof e.on=="function"&&Zi(e,"error",t,r)}function Zi(e,t,r,n){if(typeof e.on=="function")n.once?e.once(t,r):e.on(t,r);else if(typeof e.addEventListener=="function")e.addEventListener(t,function i(s){n.once&&e.removeEventListener(t,i),r(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e)}var Gr={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var On=function(e,t){return On=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},On(e,t)};function yc(e,t){On(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var In=function(){return In=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},In.apply(this,arguments)};function bc(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function wc(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(s=(i<3?a(s):i>3?a(t,r,s):a(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function vc(e,t){return function(r,n){t(r,n,e)}}function mc(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Ec(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(m){a(m)}}function l(h){try{f(n.throw(h))}catch(m){a(m)}}function f(h){h.done?s(h.value):i(h.value).then(c,l)}f((n=n.apply(e,t||[])).next())})}function Dc(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(h){return l([f,h])}}function l(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(h){f=[6,h],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Sc(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function xc(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function Tn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qi(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function Oc(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Qi(arguments[t]));return e}function Ic(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function dr(e){return this instanceof dr?(this.v=e,this):new dr(e)}function Tc(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(y){return new Promise(function(D,R){s.push([b,y,D,R])>1||c(b,y)})})}function c(b,y){try{l(n[b](y))}catch(D){m(s[0][3],D)}}function l(b){b.value instanceof dr?Promise.resolve(b.value.v).then(f,h):m(s[0][2],b)}function f(b){c("next",b)}function h(b){c("throw",b)}function m(b,y){b(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Nc(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(a){return(r=!r)?{value:dr(e[i](a)),done:i==="return"}:s?s(a):a}:s}}function Ac(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Tn=="function"?Tn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(a){return new Promise(function(c,l){a=e[s](a),i(c,l,a.done,a.value)})}}function i(s,a,c,l){Promise.resolve(l).then(function(f){s({value:f,done:c})},a)}}function Rc(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Pc(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Cc(e){return e&&e.__esModule?e:{default:e}}function Fc(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Lc(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var Uc=Object.freeze({__proto__:null,__extends:yc,get __assign(){return In},__rest:bc,__decorate:wc,__param:vc,__metadata:mc,__awaiter:Ec,__generator:Dc,__createBinding:Sc,__exportStar:xc,__values:Tn,__read:Qi,__spread:Oc,__spreadArrays:Ic,__await:dr,__asyncGenerator:Tc,__asyncDelegator:Nc,__asyncValues:Ac,__makeTemplateObject:Rc,__importStar:Pc,__importDefault:Cc,__classPrivateFieldGet:Fc,__classPrivateFieldSet:Lc}),es=Kt(Uc),pr={};Object.defineProperty(pr,"__esModule",{value:!0});function $c(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}pr.safeJsonParse=$c;function Mc(e){return typeof e=="string"?e:JSON.stringify(e,(t,r)=>typeof r>"u"?null:r)}pr.safeJsonStringify=Mc;var gr={exports:{}},ts;function jc(){return ts||(ts=1,function(){let e;function t(){}e=t,e.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},e.prototype.setItem=function(r,n){this[r]=String(n)},e.prototype.removeItem=function(r){delete this[r]},e.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},e.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},e.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Qe<"u"&&Qe.localStorage?gr.exports=Qe.localStorage:typeof window<"u"&&window.localStorage?gr.exports=window.localStorage:gr.exports=new t}()),gr.exports}var Nn={},_r={},rs;function zc(){if(rs)return _r;rs=1,Object.defineProperty(_r,"__esModule",{value:!0}),_r.IKeyValueStorage=void 0;class e{}return _r.IKeyValueStorage=e,_r}var yr={},ns;function Bc(){if(ns)return yr;ns=1,Object.defineProperty(yr,"__esModule",{value:!0}),yr.parseEntry=void 0;const e=pr;function t(r){var n;return[r[0],e.safeJsonParse((n=r[1])!==null&&n!==void 0?n:"")]}return yr.parseEntry=t,yr}var is;function qc(){return is||(is=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=es;t.__exportStar(zc(),e),t.__exportStar(Bc(),e)}(Nn)),Nn}Object.defineProperty(Gr,"__esModule",{value:!0}),Gr.KeyValueStorage=void 0;const sr=es,ss=pr,Kc=sr.__importDefault(jc()),Hc=qc();class os{constructor(){this.localStorage=Kc.default}getKeys(){return sr.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return sr.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(Hc.parseEntry)})}getItem(t){return sr.__awaiter(this,void 0,void 0,function*(){const r=this.localStorage.getItem(t);if(r!==null)return ss.safeJsonParse(r)})}setItem(t,r){return sr.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(t,ss.safeJsonStringify(r))})}removeItem(t){return sr.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(t)})}}Gr.KeyValueStorage=os;var Vc=Gr.default=os,br={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var An=function(e,t){return An=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},An(e,t)};function Gc(e,t){An(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Rn=function(){return Rn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Rn.apply(this,arguments)};function Wc(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Yc(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(s=(i<3?a(s):i>3?a(t,r,s):a(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function kc(e,t){return function(r,n){t(r,n,e)}}function Xc(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Jc(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(m){a(m)}}function l(h){try{f(n.throw(h))}catch(m){a(m)}}function f(h){h.done?s(h.value):i(h.value).then(c,l)}f((n=n.apply(e,t||[])).next())})}function Zc(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(h){return l([f,h])}}function l(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(h){f=[6,h],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Qc(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function eu(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function Pn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function as(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function tu(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(as(arguments[t]));return e}function ru(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function wr(e){return this instanceof wr?(this.v=e,this):new wr(e)}function nu(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(y){return new Promise(function(D,R){s.push([b,y,D,R])>1||c(b,y)})})}function c(b,y){try{l(n[b](y))}catch(D){m(s[0][3],D)}}function l(b){b.value instanceof wr?Promise.resolve(b.value.v).then(f,h):m(s[0][2],b)}function f(b){c("next",b)}function h(b){c("throw",b)}function m(b,y){b(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function iu(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(a){return(r=!r)?{value:wr(e[i](a)),done:i==="return"}:s?s(a):a}:s}}function su(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Pn=="function"?Pn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(a){return new Promise(function(c,l){a=e[s](a),i(c,l,a.done,a.value)})}}function i(s,a,c,l){Promise.resolve(l).then(function(f){s({value:f,done:c})},a)}}function ou(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function au(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function cu(e){return e&&e.__esModule?e:{default:e}}function uu(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function fu(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var lu=Object.freeze({__proto__:null,__extends:Gc,get __assign(){return Rn},__rest:Wc,__decorate:Yc,__param:kc,__metadata:Xc,__awaiter:Jc,__generator:Zc,__createBinding:Qc,__exportStar:eu,__values:Pn,__read:as,__spread:tu,__spreadArrays:ru,__await:wr,__asyncGenerator:nu,__asyncDelegator:iu,__asyncValues:su,__makeTemplateObject:ou,__importStar:au,__importDefault:cu,__classPrivateFieldGet:uu,__classPrivateFieldSet:fu}),Wr=Kt(lu),vr={},Z={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var Cn=function(e,t){return Cn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},Cn(e,t)};function hu(e,t){Cn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Fn=function(){return Fn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Fn.apply(this,arguments)};function du(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function pu(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(s=(i<3?a(s):i>3?a(t,r,s):a(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function gu(e,t){return function(r,n){t(r,n,e)}}function _u(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function yu(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(m){a(m)}}function l(h){try{f(n.throw(h))}catch(m){a(m)}}function f(h){h.done?s(h.value):i(h.value).then(c,l)}f((n=n.apply(e,t||[])).next())})}function bu(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(h){return l([f,h])}}function l(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(h){f=[6,h],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function wu(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function vu(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function Ln(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function cs(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function mu(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(cs(arguments[t]));return e}function Eu(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function mr(e){return this instanceof mr?(this.v=e,this):new mr(e)}function Du(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(y){return new Promise(function(D,R){s.push([b,y,D,R])>1||c(b,y)})})}function c(b,y){try{l(n[b](y))}catch(D){m(s[0][3],D)}}function l(b){b.value instanceof mr?Promise.resolve(b.value.v).then(f,h):m(s[0][2],b)}function f(b){c("next",b)}function h(b){c("throw",b)}function m(b,y){b(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Su(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(a){return(r=!r)?{value:mr(e[i](a)),done:i==="return"}:s?s(a):a}:s}}function xu(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Ln=="function"?Ln(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(a){return new Promise(function(c,l){a=e[s](a),i(c,l,a.done,a.value)})}}function i(s,a,c,l){Promise.resolve(l).then(function(f){s({value:f,done:c})},a)}}function Ou(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function Iu(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function Tu(e){return e&&e.__esModule?e:{default:e}}function Nu(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function Au(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var Ru=Object.freeze({__proto__:null,__extends:hu,get __assign(){return Fn},__rest:du,__decorate:pu,__param:gu,__metadata:_u,__awaiter:yu,__generator:bu,__createBinding:wu,__exportStar:vu,__values:Ln,__read:cs,__spread:mu,__spreadArrays:Eu,__await:mr,__asyncGenerator:Du,__asyncDelegator:Su,__asyncValues:xu,__makeTemplateObject:Ou,__importStar:Iu,__importDefault:Tu,__classPrivateFieldGet:Nu,__classPrivateFieldSet:Au}),Yr=Kt(Ru),Un={},Er={},us;function Pu(){if(us)return Er;us=1,Object.defineProperty(Er,"__esModule",{value:!0}),Er.delay=void 0;function e(t){return new Promise(r=>{setTimeout(()=>{r(!0)},t)})}return Er.delay=e,Er}var Ht={},$n={},Vt={},fs;function Cu(){return fs||(fs=1,Object.defineProperty(Vt,"__esModule",{value:!0}),Vt.ONE_THOUSAND=Vt.ONE_HUNDRED=void 0,Vt.ONE_HUNDRED=100,Vt.ONE_THOUSAND=1e3),Vt}var Mn={},ls;function Fu(){return ls||(ls=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.ONE_YEAR=e.FOUR_WEEKS=e.THREE_WEEKS=e.TWO_WEEKS=e.ONE_WEEK=e.THIRTY_DAYS=e.SEVEN_DAYS=e.FIVE_DAYS=e.THREE_DAYS=e.ONE_DAY=e.TWENTY_FOUR_HOURS=e.TWELVE_HOURS=e.SIX_HOURS=e.THREE_HOURS=e.ONE_HOUR=e.SIXTY_MINUTES=e.THIRTY_MINUTES=e.TEN_MINUTES=e.FIVE_MINUTES=e.ONE_MINUTE=e.SIXTY_SECONDS=e.THIRTY_SECONDS=e.TEN_SECONDS=e.FIVE_SECONDS=e.ONE_SECOND=void 0,e.ONE_SECOND=1,e.FIVE_SECONDS=5,e.TEN_SECONDS=10,e.THIRTY_SECONDS=30,e.SIXTY_SECONDS=60,e.ONE_MINUTE=e.SIXTY_SECONDS,e.FIVE_MINUTES=e.ONE_MINUTE*5,e.TEN_MINUTES=e.ONE_MINUTE*10,e.THIRTY_MINUTES=e.ONE_MINUTE*30,e.SIXTY_MINUTES=e.ONE_MINUTE*60,e.ONE_HOUR=e.SIXTY_MINUTES,e.THREE_HOURS=e.ONE_HOUR*3,e.SIX_HOURS=e.ONE_HOUR*6,e.TWELVE_HOURS=e.ONE_HOUR*12,e.TWENTY_FOUR_HOURS=e.ONE_HOUR*24,e.ONE_DAY=e.TWENTY_FOUR_HOURS,e.THREE_DAYS=e.ONE_DAY*3,e.FIVE_DAYS=e.ONE_DAY*5,e.SEVEN_DAYS=e.ONE_DAY*7,e.THIRTY_DAYS=e.ONE_DAY*30,e.ONE_WEEK=e.SEVEN_DAYS,e.TWO_WEEKS=e.ONE_WEEK*2,e.THREE_WEEKS=e.ONE_WEEK*3,e.FOUR_WEEKS=e.ONE_WEEK*4,e.ONE_YEAR=e.ONE_DAY*365}(Mn)),Mn}var hs;function ds(){return hs||(hs=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Yr;t.__exportStar(Cu(),e),t.__exportStar(Fu(),e)}($n)),$n}var ps;function Lu(){if(ps)return Ht;ps=1,Object.defineProperty(Ht,"__esModule",{value:!0}),Ht.fromMiliseconds=Ht.toMiliseconds=void 0;const e=ds();function t(n){return n*e.ONE_THOUSAND}Ht.toMiliseconds=t;function r(n){return Math.floor(n/e.ONE_THOUSAND)}return Ht.fromMiliseconds=r,Ht}var gs;function Uu(){return gs||(gs=1,function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Yr;t.__exportStar(Pu(),e),t.__exportStar(Lu(),e)}(Un)),Un}var or={},_s;function $u(){if(_s)return or;_s=1,Object.defineProperty(or,"__esModule",{value:!0}),or.Watch=void 0;class e{constructor(){this.timestamps=new Map}start(r){if(this.timestamps.has(r))throw new Error(`Watch already started for label: ${r}`);this.timestamps.set(r,{started:Date.now()})}stop(r){const n=this.get(r);if(typeof n.elapsed<"u")throw new Error(`Watch already stopped for label: ${r}`);const i=Date.now()-n.started;this.timestamps.set(r,{started:n.started,elapsed:i})}get(r){const n=this.timestamps.get(r);if(typeof n>"u")throw new Error(`No timestamp found for label: ${r}`);return n}elapsed(r){const n=this.get(r);return n.elapsed||Date.now()-n.started}}return or.Watch=e,or.default=e,or}var jn={},Dr={},ys;function Mu(){if(ys)return Dr;ys=1,Object.defineProperty(Dr,"__esModule",{value:!0}),Dr.IWatch=void 0;class e{}return Dr.IWatch=e,Dr}var bs;function ju(){return bs||(bs=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Yr.__exportStar(Mu(),e)}(jn)),jn}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Yr;t.__exportStar(Uu(),e),t.__exportStar($u(),e),t.__exportStar(ju(),e),t.__exportStar(ds(),e)})(Z);var zn={},Sr={};class Gt{}var zu=Object.freeze({__proto__:null,IEvents:Gt}),Bu=Kt(zu),ws;function qu(){if(ws)return Sr;ws=1,Object.defineProperty(Sr,"__esModule",{value:!0}),Sr.IHeartBeat=void 0;const e=Bu;class t extends e.IEvents{constructor(n){super()}}return Sr.IHeartBeat=t,Sr}var vs;function ms(){return vs||(vs=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Wr.__exportStar(qu(),e)}(zn)),zn}var Bn={},Wt={},Es;function Ku(){if(Es)return Wt;Es=1,Object.defineProperty(Wt,"__esModule",{value:!0}),Wt.HEARTBEAT_EVENTS=Wt.HEARTBEAT_INTERVAL=void 0;const e=Z;return Wt.HEARTBEAT_INTERVAL=e.FIVE_SECONDS,Wt.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Wt}var Ds;function Ss(){return Ds||(Ds=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),Wr.__exportStar(Ku(),e)}(Bn)),Bn}var xs;function Hu(){if(xs)return vr;xs=1,Object.defineProperty(vr,"__esModule",{value:!0}),vr.HeartBeat=void 0;const e=Wr,t=ut.exports,r=Z,n=ms(),i=Ss();class s extends n.IHeartBeat{constructor(c){super(c),this.events=new t.EventEmitter,this.interval=i.HEARTBEAT_INTERVAL,this.interval=c?.interval||i.HEARTBEAT_INTERVAL}static init(c){return e.__awaiter(this,void 0,void 0,function*(){const l=new s(c);return yield l.init(),l})}init(){return e.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(c,l){this.events.on(c,l)}once(c,l){this.events.once(c,l)}off(c,l){this.events.off(c,l)}removeListener(c,l){this.events.removeListener(c,l)}initialize(){return e.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(i.HEARTBEAT_EVENTS.pulse)}}return vr.HeartBeat=s,vr}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=Wr;t.__exportStar(Hu(),e),t.__exportStar(ms(),e),t.__exportStar(Ss(),e)})(br);var xe={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var qn=function(e,t){return qn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},qn(e,t)};function Vu(e,t){qn(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Kn=function(){return Kn=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Kn.apply(this,arguments)};function Gu(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Wu(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(s=(i<3?a(s):i>3?a(t,r,s):a(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function Yu(e,t){return function(r,n){t(r,n,e)}}function ku(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Xu(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(m){a(m)}}function l(h){try{f(n.throw(h))}catch(m){a(m)}}function f(h){h.done?s(h.value):i(h.value).then(c,l)}f((n=n.apply(e,t||[])).next())})}function Ju(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(h){return l([f,h])}}function l(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(h){f=[6,h],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Zu(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Qu(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function Hn(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Os(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function ef(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Os(arguments[t]));return e}function tf(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function xr(e){return this instanceof xr?(this.v=e,this):new xr(e)}function rf(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(y){return new Promise(function(D,R){s.push([b,y,D,R])>1||c(b,y)})})}function c(b,y){try{l(n[b](y))}catch(D){m(s[0][3],D)}}function l(b){b.value instanceof xr?Promise.resolve(b.value.v).then(f,h):m(s[0][2],b)}function f(b){c("next",b)}function h(b){c("throw",b)}function m(b,y){b(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function nf(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(a){return(r=!r)?{value:xr(e[i](a)),done:i==="return"}:s?s(a):a}:s}}function sf(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Hn=="function"?Hn(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(a){return new Promise(function(c,l){a=e[s](a),i(c,l,a.done,a.value)})}}function i(s,a,c,l){Promise.resolve(l).then(function(f){s({value:f,done:c})},a)}}function of(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function af(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function cf(e){return e&&e.__esModule?e:{default:e}}function uf(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function ff(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var lf=Object.freeze({__proto__:null,__extends:Vu,get __assign(){return Kn},__rest:Gu,__decorate:Wu,__param:Yu,__metadata:ku,__awaiter:Xu,__generator:Ju,__createBinding:Zu,__exportStar:Qu,__values:Hn,__read:Os,__spread:ef,__spreadArrays:tf,__await:xr,__asyncGenerator:rf,__asyncDelegator:nf,__asyncValues:sf,__makeTemplateObject:of,__importStar:af,__importDefault:cf,__classPrivateFieldGet:uf,__classPrivateFieldSet:ff}),hf=Kt(lf),Yt={},Is;function Ts(){return Is||(Is=1,Object.defineProperty(Yt,"__esModule",{value:!0}),Yt.PINO_CUSTOM_CONTEXT_KEY=Yt.PINO_LOGGER_DEFAULTS=void 0,Yt.PINO_LOGGER_DEFAULTS={level:"info"},Yt.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Yt}var ot={},Ns;function df(){if(Ns)return ot;Ns=1,Object.defineProperty(ot,"__esModule",{value:!0}),ot.generateChildLogger=ot.formatChildLoggerContext=ot.getLoggerContext=ot.setBrowserLoggerContext=ot.getBrowserLoggerContext=ot.getDefaultLoggerOptions=void 0;const e=Ts();function t(c){return Object.assign(Object.assign({},c),{level:c?.level||e.PINO_LOGGER_DEFAULTS.level})}ot.getDefaultLoggerOptions=t;function r(c,l=e.PINO_CUSTOM_CONTEXT_KEY){return c[l]||""}ot.getBrowserLoggerContext=r;function n(c,l,f=e.PINO_CUSTOM_CONTEXT_KEY){return c[f]=l,c}ot.setBrowserLoggerContext=n;function i(c,l=e.PINO_CUSTOM_CONTEXT_KEY){let f="";return typeof c.bindings>"u"?f=r(c,l):f=c.bindings().context||"",f}ot.getLoggerContext=i;function s(c,l,f=e.PINO_CUSTOM_CONTEXT_KEY){const h=i(c,f);return h.trim()?`${h}/${l}`:l}ot.formatChildLoggerContext=s;function a(c,l,f=e.PINO_CUSTOM_CONTEXT_KEY){const h=s(c,l,f),m=c.child({context:h});return n(m,h,f)}return ot.generateChildLogger=a,ot}(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.pino=void 0;const t=hf,r=t.__importDefault(Br);Object.defineProperty(e,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(Ts(),e),t.__exportStar(df(),e)})(xe);class pf extends Gt{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}class gf extends Gt{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}}class _f{constructor(t,r){this.logger=t,this.core=r}}class yf extends Gt{constructor(t,r){super(),this.relayer=t,this.logger=r}}class bf extends Gt{constructor(t){super()}}class wf{constructor(t,r,n,i){this.core=t,this.logger=r,this.name=n}}class vf extends Gt{constructor(t,r){super(),this.relayer=t,this.logger=r}}class mf extends Gt{constructor(t,r){super(),this.core=t,this.logger=r}}class Ef{constructor(t){this.opts=t,this.protocol="wc",this.version=2}}class Df{constructor(t){this.client=t}}function As(e){if(typeof e!="string")throw new Error(`Cannot safe json parse value of type ${typeof e}`);try{return JSON.parse(e)}catch{return e}}function Vn(e){return typeof e=="string"?e:JSON.stringify(e)}var Gn={},ar={},kr={},Xr={};Object.defineProperty(Xr,"__esModule",{value:!0}),Xr.BrowserRandomSource=void 0;const Rs=65536;class Sf{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const t=typeof self<"u"?self.crypto||self.msCrypto:null;t&&t.getRandomValues!==void 0&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const r=new Uint8Array(t);for(let n=0;n<r.length;n+=Rs)this._crypto.getRandomValues(r.subarray(n,n+Math.min(r.length-n,Rs)));return r}}Xr.BrowserRandomSource=Sf;function xf(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Jr={},pt={};Object.defineProperty(pt,"__esModule",{value:!0});function Of(e){for(var t=0;t<e.length;t++)e[t]=0;return e}pt.wipe=Of;var If={},Tf=Object.freeze({__proto__:null,default:If}),Nf=Kt(Tf);Object.defineProperty(Jr,"__esModule",{value:!0}),Jr.NodeRandomSource=void 0;const Af=pt;class Rf{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof xf<"u"){const t=Nf;t&&t.randomBytes&&(this._crypto=t,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(t){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let r=this._crypto.randomBytes(t);if(r.length!==t)throw new Error("NodeRandomSource: got fewer bytes than requested");const n=new Uint8Array(t);for(let i=0;i<n.length;i++)n[i]=r[i];return(0,Af.wipe)(r),n}}Jr.NodeRandomSource=Rf,Object.defineProperty(kr,"__esModule",{value:!0}),kr.SystemRandomSource=void 0;const Pf=Xr,Cf=Jr;class Ff{constructor(){if(this.isAvailable=!1,this.name="",this._source=new Pf.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new Cf.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(t){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(t)}}kr.SystemRandomSource=Ff;var te={},Ps={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});function t(c,l){var f=c>>>16&65535,h=c&65535,m=l>>>16&65535,b=l&65535;return h*b+(f*b+h*m<<16>>>0)|0}e.mul=Math.imul||t;function r(c,l){return c+l|0}e.add=r;function n(c,l){return c-l|0}e.sub=n;function i(c,l){return c<<l|c>>>32-l}e.rotl=i;function s(c,l){return c<<32-l|c>>>l}e.rotr=s;function a(c){return typeof c=="number"&&isFinite(c)&&Math.floor(c)===c}e.isInteger=Number.isInteger||a,e.MAX_SAFE_INTEGER=9007199254740991,e.isSafeInteger=function(c){return e.isInteger(c)&&c>=-e.MAX_SAFE_INTEGER&&c<=e.MAX_SAFE_INTEGER}})(Ps),Object.defineProperty(te,"__esModule",{value:!0});var Cs=Ps;function Lf(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])<<16>>16}te.readInt16BE=Lf;function Uf(e,t){return t===void 0&&(t=0),(e[t+0]<<8|e[t+1])>>>0}te.readUint16BE=Uf;function $f(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])<<16>>16}te.readInt16LE=$f;function Mf(e,t){return t===void 0&&(t=0),(e[t+1]<<8|e[t])>>>0}te.readUint16LE=Mf;function Fs(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>8,t[r+1]=e>>>0,t}te.writeUint16BE=Fs,te.writeInt16BE=Fs;function Ls(e,t,r){return t===void 0&&(t=new Uint8Array(2)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t}te.writeUint16LE=Ls,te.writeInt16LE=Ls;function Wn(e,t){return t===void 0&&(t=0),e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]}te.readInt32BE=Wn;function Yn(e,t){return t===void 0&&(t=0),(e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3])>>>0}te.readUint32BE=Yn;function kn(e,t){return t===void 0&&(t=0),e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]}te.readInt32LE=kn;function Xn(e,t){return t===void 0&&(t=0),(e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t])>>>0}te.readUint32LE=Xn;function Zr(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>24,t[r+1]=e>>>16,t[r+2]=e>>>8,t[r+3]=e>>>0,t}te.writeUint32BE=Zr,te.writeInt32BE=Zr;function Qr(e,t,r){return t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0),t[r+0]=e>>>0,t[r+1]=e>>>8,t[r+2]=e>>>16,t[r+3]=e>>>24,t}te.writeUint32LE=Qr,te.writeInt32LE=Qr;function jf(e,t){t===void 0&&(t=0);var r=Wn(e,t),n=Wn(e,t+4);return r*4294967296+n-(n>>31)*4294967296}te.readInt64BE=jf;function zf(e,t){t===void 0&&(t=0);var r=Yn(e,t),n=Yn(e,t+4);return r*4294967296+n}te.readUint64BE=zf;function Bf(e,t){t===void 0&&(t=0);var r=kn(e,t),n=kn(e,t+4);return n*4294967296+r-(r>>31)*4294967296}te.readInt64LE=Bf;function qf(e,t){t===void 0&&(t=0);var r=Xn(e,t),n=Xn(e,t+4);return n*4294967296+r}te.readUint64LE=qf;function Us(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Zr(e/4294967296>>>0,t,r),Zr(e>>>0,t,r+4),t}te.writeUint64BE=Us,te.writeInt64BE=Us;function $s(e,t,r){return t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0),Qr(e>>>0,t,r),Qr(e/4294967296>>>0,t,r+4),t}te.writeUint64LE=$s,te.writeInt64LE=$s;function Kf(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintBE: array is too short for the given bitLength");for(var n=0,i=1,s=e/8+r-1;s>=r;s--)n+=t[s]*i,i*=256;return n}te.readUintBE=Kf;function Hf(e,t,r){if(r===void 0&&(r=0),e%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(e/8>t.length-r)throw new Error("readUintLE: array is too short for the given bitLength");for(var n=0,i=1,s=r;s<r+e/8;s++)n+=t[s]*i,i*=256;return n}te.readUintLE=Hf;function Vf(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Cs.isSafeInteger(t))throw new Error("writeUintBE value must be an integer");for(var i=1,s=e/8+n-1;s>=n;s--)r[s]=t/i&255,i*=256;return r}te.writeUintBE=Vf;function Gf(e,t,r,n){if(r===void 0&&(r=new Uint8Array(e/8)),n===void 0&&(n=0),e%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Cs.isSafeInteger(t))throw new Error("writeUintLE value must be an integer");for(var i=1,s=n;s<n+e/8;s++)r[s]=t/i&255,i*=256;return r}te.writeUintLE=Gf;function Wf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t)}te.readFloat32BE=Wf;function Yf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat32(t,!0)}te.readFloat32LE=Yf;function kf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t)}te.readFloat64BE=kf;function Xf(e,t){t===void 0&&(t=0);var r=new DataView(e.buffer,e.byteOffset,e.byteLength);return r.getFloat64(t,!0)}te.readFloat64LE=Xf;function Jf(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e),t}te.writeFloat32BE=Jf;function Zf(e,t,r){t===void 0&&(t=new Uint8Array(4)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat32(r,e,!0),t}te.writeFloat32LE=Zf;function Qf(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e),t}te.writeFloat64BE=Qf;function el(e,t,r){t===void 0&&(t=new Uint8Array(8)),r===void 0&&(r=0);var n=new DataView(t.buffer,t.byteOffset,t.byteLength);return n.setFloat64(r,e,!0),t}te.writeFloat64LE=el,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.randomStringForEntropy=e.randomString=e.randomUint32=e.randomBytes=e.defaultRandomSource=void 0;const t=kr,r=te,n=pt;e.defaultRandomSource=new t.SystemRandomSource;function i(f,h=e.defaultRandomSource){return h.randomBytes(f)}e.randomBytes=i;function s(f=e.defaultRandomSource){const h=i(4,f),m=(0,r.readUint32LE)(h);return(0,n.wipe)(h),m}e.randomUint32=s;const a="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function c(f,h=a,m=e.defaultRandomSource){if(h.length<2)throw new Error("randomString charset is too short");if(h.length>256)throw new Error("randomString charset is too long");let b="";const y=h.length,D=256-256%y;for(;f>0;){const R=i(Math.ceil(f*256/D),m);for(let P=0;P<R.length&&f>0;P++){const j=R[P];j<D&&(b+=h.charAt(j%y),f--)}(0,n.wipe)(R)}return b}e.randomString=c;function l(f,h=a,m=e.defaultRandomSource){const b=Math.ceil(f/(Math.log(h.length)/Math.LN2));return c(b,h,m)}e.randomStringForEntropy=l}(ar);var Ms={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=te,r=pt;e.DIGEST_LENGTH=64,e.BLOCK_SIZE=128;var n=function(){function c(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},c.prototype.update=function(l,f){if(f===void 0&&(f=l.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var h=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<e.BLOCK_SIZE&&f>0;)this._buffer[this._bufferLength++]=l[h++],f--;this._bufferLength===this.blockSize&&(s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(h=s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,l,h,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=l[h++],f--;return this},c.prototype.finish=function(l){if(!this._finished){var f=this._bytesHashed,h=this._bufferLength,m=f/536870912|0,b=f<<3,y=f%128<112?128:256;this._buffer[h]=128;for(var D=h+1;D<y-8;D++)this._buffer[D]=0;t.writeUint32BE(m,this._buffer,y-8),t.writeUint32BE(b,this._buffer,y-4),s(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,y),this._finished=!0}for(var D=0;D<this.digestLength/8;D++)t.writeUint32BE(this._stateHi[D],l,D*8),t.writeUint32BE(this._stateLo[D],l,D*8+4);return this},c.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(l){return this._stateHi.set(l.stateHi),this._stateLo.set(l.stateLo),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(l){r.wipe(l.stateHi),r.wipe(l.stateLo),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},c}();e.SHA512=n;var i=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function s(c,l,f,h,m,b,y){for(var D=f[0],R=f[1],P=f[2],j=f[3],E=f[4],O=f[5],g=f[6],v=f[7],w=h[0],o=h[1],p=h[2],L=h[3],z=h[4],k=h[5],X=h[6],J=h[7],A,N,W,M,F,U,$,B;y>=128;){for(var ne=0;ne<16;ne++){var q=8*ne+b;c[ne]=t.readUint32BE(m,q),l[ne]=t.readUint32BE(m,q+4)}for(var ne=0;ne<80;ne++){var Q=D,Y=R,ae=P,T=j,I=E,S=O,u=g,_=v,K=w,V=o,le=p,ye=L,de=z,ve=k,Ue=X,Re=J;if(A=v,N=J,F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=(E>>>14|z<<32-14)^(E>>>18|z<<32-18)^(z>>>41-32|E<<32-(41-32)),N=(z>>>14|E<<32-14)^(z>>>18|E<<32-18)^(E>>>41-32|z<<32-(41-32)),F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,A=E&O^~E&g,N=z&k^~z&X,F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,A=i[ne*2],N=i[ne*2+1],F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,A=c[ne%16],N=l[ne%16],F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,W=$&65535|B<<16,M=F&65535|U<<16,A=W,N=M,F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=(D>>>28|w<<32-28)^(w>>>34-32|D<<32-(34-32))^(w>>>39-32|D<<32-(39-32)),N=(w>>>28|D<<32-28)^(D>>>34-32|w<<32-(34-32))^(D>>>39-32|w<<32-(39-32)),F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,A=D&R^D&P^R&P,N=w&o^w&p^o&p,F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,_=$&65535|B<<16,Re=F&65535|U<<16,A=T,N=ye,F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=W,N=M,F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,T=$&65535|B<<16,ye=F&65535|U<<16,R=Q,P=Y,j=ae,E=T,O=I,g=S,v=u,D=_,o=K,p=V,L=le,z=ye,k=de,X=ve,J=Ue,w=Re,ne%16===15)for(var q=0;q<16;q++)A=c[q],N=l[q],F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=c[(q+9)%16],N=l[(q+9)%16],F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,W=c[(q+1)%16],M=l[(q+1)%16],A=(W>>>1|M<<32-1)^(W>>>8|M<<32-8)^W>>>7,N=(M>>>1|W<<32-1)^(M>>>8|W<<32-8)^(M>>>7|W<<32-7),F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,W=c[(q+14)%16],M=l[(q+14)%16],A=(W>>>19|M<<32-19)^(M>>>61-32|W<<32-(61-32))^W>>>6,N=(M>>>19|W<<32-19)^(W>>>61-32|M<<32-(61-32))^(M>>>6|W<<32-6),F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,c[q]=$&65535|B<<16,l[q]=F&65535|U<<16}A=D,N=w,F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[0],N=h[0],F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,f[0]=D=$&65535|B<<16,h[0]=w=F&65535|U<<16,A=R,N=o,F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[1],N=h[1],F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,f[1]=R=$&65535|B<<16,h[1]=o=F&65535|U<<16,A=P,N=p,F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[2],N=h[2],F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,f[2]=P=$&65535|B<<16,h[2]=p=F&65535|U<<16,A=j,N=L,F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[3],N=h[3],F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,f[3]=j=$&65535|B<<16,h[3]=L=F&65535|U<<16,A=E,N=z,F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[4],N=h[4],F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,f[4]=E=$&65535|B<<16,h[4]=z=F&65535|U<<16,A=O,N=k,F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[5],N=h[5],F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,f[5]=O=$&65535|B<<16,h[5]=k=F&65535|U<<16,A=g,N=X,F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[6],N=h[6],F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,f[6]=g=$&65535|B<<16,h[6]=X=F&65535|U<<16,A=v,N=J,F=N&65535,U=N>>>16,$=A&65535,B=A>>>16,A=f[7],N=h[7],F+=N&65535,U+=N>>>16,$+=A&65535,B+=A>>>16,U+=F>>>16,$+=U>>>16,B+=$>>>16,f[7]=v=$&65535|B<<16,h[7]=J=F&65535|U<<16,b+=128,y-=128}return b}function a(c){var l=new n;l.update(c);var f=l.digest();return l.clean(),f}e.hash=a})(Ms),function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.convertSecretKeyToX25519=e.convertPublicKeyToX25519=e.verify=e.sign=e.extractPublicKeyFromSecretKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.SEED_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=e.SIGNATURE_LENGTH=void 0;const t=ar,r=Ms,n=pt;e.SIGNATURE_LENGTH=64,e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=64,e.SEED_LENGTH=32;function i(T){const I=new Float64Array(16);if(T)for(let S=0;S<T.length;S++)I[S]=T[S];return I}const s=new Uint8Array(32);s[0]=9;const a=i(),c=i([1]),l=i([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),f=i([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),h=i([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),m=i([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),b=i([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function y(T,I){for(let S=0;S<16;S++)T[S]=I[S]|0}function D(T){let I=1;for(let S=0;S<16;S++){let u=T[S]+I+65535;I=Math.floor(u/65536),T[S]=u-I*65536}T[0]+=I-1+37*(I-1)}function R(T,I,S){const u=~(S-1);for(let _=0;_<16;_++){const K=u&(T[_]^I[_]);T[_]^=K,I[_]^=K}}function P(T,I){const S=i(),u=i();for(let _=0;_<16;_++)u[_]=I[_];D(u),D(u),D(u);for(let _=0;_<2;_++){S[0]=u[0]-65517;for(let V=1;V<15;V++)S[V]=u[V]-65535-(S[V-1]>>16&1),S[V-1]&=65535;S[15]=u[15]-32767-(S[14]>>16&1);const K=S[15]>>16&1;S[14]&=65535,R(u,S,1-K)}for(let _=0;_<16;_++)T[2*_]=u[_]&255,T[2*_+1]=u[_]>>8}function j(T,I){let S=0;for(let u=0;u<32;u++)S|=T[u]^I[u];return(1&S-1>>>8)-1}function E(T,I){const S=new Uint8Array(32),u=new Uint8Array(32);return P(S,T),P(u,I),j(S,u)}function O(T){const I=new Uint8Array(32);return P(I,T),I[0]&1}function g(T,I){for(let S=0;S<16;S++)T[S]=I[2*S]+(I[2*S+1]<<8);T[15]&=32767}function v(T,I,S){for(let u=0;u<16;u++)T[u]=I[u]+S[u]}function w(T,I,S){for(let u=0;u<16;u++)T[u]=I[u]-S[u]}function o(T,I,S){let u,_,K=0,V=0,le=0,ye=0,de=0,ve=0,Ue=0,Re=0,_e=0,pe=0,he=0,ue=0,ce=0,oe=0,se=0,ee=0,fe=0,ge=0,re=0,be=0,we=0,Ee=0,De=0,me=0,Et=0,Nt=0,jt=0,gt=0,Zt=0,Mr=0,yn=0,$e=S[0],Pe=S[1],Me=S[2],je=S[3],ze=S[4],Ce=S[5],Ve=S[6],Ge=S[7],We=S[8],Ye=S[9],ke=S[10],qe=S[11],Be=S[12],Ne=S[13],Xe=S[14],Je=S[15];u=I[0],K+=u*$e,V+=u*Pe,le+=u*Me,ye+=u*je,de+=u*ze,ve+=u*Ce,Ue+=u*Ve,Re+=u*Ge,_e+=u*We,pe+=u*Ye,he+=u*ke,ue+=u*qe,ce+=u*Be,oe+=u*Ne,se+=u*Xe,ee+=u*Je,u=I[1],V+=u*$e,le+=u*Pe,ye+=u*Me,de+=u*je,ve+=u*ze,Ue+=u*Ce,Re+=u*Ve,_e+=u*Ge,pe+=u*We,he+=u*Ye,ue+=u*ke,ce+=u*qe,oe+=u*Be,se+=u*Ne,ee+=u*Xe,fe+=u*Je,u=I[2],le+=u*$e,ye+=u*Pe,de+=u*Me,ve+=u*je,Ue+=u*ze,Re+=u*Ce,_e+=u*Ve,pe+=u*Ge,he+=u*We,ue+=u*Ye,ce+=u*ke,oe+=u*qe,se+=u*Be,ee+=u*Ne,fe+=u*Xe,ge+=u*Je,u=I[3],ye+=u*$e,de+=u*Pe,ve+=u*Me,Ue+=u*je,Re+=u*ze,_e+=u*Ce,pe+=u*Ve,he+=u*Ge,ue+=u*We,ce+=u*Ye,oe+=u*ke,se+=u*qe,ee+=u*Be,fe+=u*Ne,ge+=u*Xe,re+=u*Je,u=I[4],de+=u*$e,ve+=u*Pe,Ue+=u*Me,Re+=u*je,_e+=u*ze,pe+=u*Ce,he+=u*Ve,ue+=u*Ge,ce+=u*We,oe+=u*Ye,se+=u*ke,ee+=u*qe,fe+=u*Be,ge+=u*Ne,re+=u*Xe,be+=u*Je,u=I[5],ve+=u*$e,Ue+=u*Pe,Re+=u*Me,_e+=u*je,pe+=u*ze,he+=u*Ce,ue+=u*Ve,ce+=u*Ge,oe+=u*We,se+=u*Ye,ee+=u*ke,fe+=u*qe,ge+=u*Be,re+=u*Ne,be+=u*Xe,we+=u*Je,u=I[6],Ue+=u*$e,Re+=u*Pe,_e+=u*Me,pe+=u*je,he+=u*ze,ue+=u*Ce,ce+=u*Ve,oe+=u*Ge,se+=u*We,ee+=u*Ye,fe+=u*ke,ge+=u*qe,re+=u*Be,be+=u*Ne,we+=u*Xe,Ee+=u*Je,u=I[7],Re+=u*$e,_e+=u*Pe,pe+=u*Me,he+=u*je,ue+=u*ze,ce+=u*Ce,oe+=u*Ve,se+=u*Ge,ee+=u*We,fe+=u*Ye,ge+=u*ke,re+=u*qe,be+=u*Be,we+=u*Ne,Ee+=u*Xe,De+=u*Je,u=I[8],_e+=u*$e,pe+=u*Pe,he+=u*Me,ue+=u*je,ce+=u*ze,oe+=u*Ce,se+=u*Ve,ee+=u*Ge,fe+=u*We,ge+=u*Ye,re+=u*ke,be+=u*qe,we+=u*Be,Ee+=u*Ne,De+=u*Xe,me+=u*Je,u=I[9],pe+=u*$e,he+=u*Pe,ue+=u*Me,ce+=u*je,oe+=u*ze,se+=u*Ce,ee+=u*Ve,fe+=u*Ge,ge+=u*We,re+=u*Ye,be+=u*ke,we+=u*qe,Ee+=u*Be,De+=u*Ne,me+=u*Xe,Et+=u*Je,u=I[10],he+=u*$e,ue+=u*Pe,ce+=u*Me,oe+=u*je,se+=u*ze,ee+=u*Ce,fe+=u*Ve,ge+=u*Ge,re+=u*We,be+=u*Ye,we+=u*ke,Ee+=u*qe,De+=u*Be,me+=u*Ne,Et+=u*Xe,Nt+=u*Je,u=I[11],ue+=u*$e,ce+=u*Pe,oe+=u*Me,se+=u*je,ee+=u*ze,fe+=u*Ce,ge+=u*Ve,re+=u*Ge,be+=u*We,we+=u*Ye,Ee+=u*ke,De+=u*qe,me+=u*Be,Et+=u*Ne,Nt+=u*Xe,jt+=u*Je,u=I[12],ce+=u*$e,oe+=u*Pe,se+=u*Me,ee+=u*je,fe+=u*ze,ge+=u*Ce,re+=u*Ve,be+=u*Ge,we+=u*We,Ee+=u*Ye,De+=u*ke,me+=u*qe,Et+=u*Be,Nt+=u*Ne,jt+=u*Xe,gt+=u*Je,u=I[13],oe+=u*$e,se+=u*Pe,ee+=u*Me,fe+=u*je,ge+=u*ze,re+=u*Ce,be+=u*Ve,we+=u*Ge,Ee+=u*We,De+=u*Ye,me+=u*ke,Et+=u*qe,Nt+=u*Be,jt+=u*Ne,gt+=u*Xe,Zt+=u*Je,u=I[14],se+=u*$e,ee+=u*Pe,fe+=u*Me,ge+=u*je,re+=u*ze,be+=u*Ce,we+=u*Ve,Ee+=u*Ge,De+=u*We,me+=u*Ye,Et+=u*ke,Nt+=u*qe,jt+=u*Be,gt+=u*Ne,Zt+=u*Xe,Mr+=u*Je,u=I[15],ee+=u*$e,fe+=u*Pe,ge+=u*Me,re+=u*je,be+=u*ze,we+=u*Ce,Ee+=u*Ve,De+=u*Ge,me+=u*We,Et+=u*Ye,Nt+=u*ke,jt+=u*qe,gt+=u*Be,Zt+=u*Ne,Mr+=u*Xe,yn+=u*Je,K+=38*fe,V+=38*ge,le+=38*re,ye+=38*be,de+=38*we,ve+=38*Ee,Ue+=38*De,Re+=38*me,_e+=38*Et,pe+=38*Nt,he+=38*jt,ue+=38*gt,ce+=38*Zt,oe+=38*Mr,se+=38*yn,_=1,u=K+_+65535,_=Math.floor(u/65536),K=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=le+_+65535,_=Math.floor(u/65536),le=u-_*65536,u=ye+_+65535,_=Math.floor(u/65536),ye=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=ve+_+65535,_=Math.floor(u/65536),ve=u-_*65536,u=Ue+_+65535,_=Math.floor(u/65536),Ue=u-_*65536,u=Re+_+65535,_=Math.floor(u/65536),Re=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=pe+_+65535,_=Math.floor(u/65536),pe=u-_*65536,u=he+_+65535,_=Math.floor(u/65536),he=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=ce+_+65535,_=Math.floor(u/65536),ce=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,K+=_-1+37*(_-1),_=1,u=K+_+65535,_=Math.floor(u/65536),K=u-_*65536,u=V+_+65535,_=Math.floor(u/65536),V=u-_*65536,u=le+_+65535,_=Math.floor(u/65536),le=u-_*65536,u=ye+_+65535,_=Math.floor(u/65536),ye=u-_*65536,u=de+_+65535,_=Math.floor(u/65536),de=u-_*65536,u=ve+_+65535,_=Math.floor(u/65536),ve=u-_*65536,u=Ue+_+65535,_=Math.floor(u/65536),Ue=u-_*65536,u=Re+_+65535,_=Math.floor(u/65536),Re=u-_*65536,u=_e+_+65535,_=Math.floor(u/65536),_e=u-_*65536,u=pe+_+65535,_=Math.floor(u/65536),pe=u-_*65536,u=he+_+65535,_=Math.floor(u/65536),he=u-_*65536,u=ue+_+65535,_=Math.floor(u/65536),ue=u-_*65536,u=ce+_+65535,_=Math.floor(u/65536),ce=u-_*65536,u=oe+_+65535,_=Math.floor(u/65536),oe=u-_*65536,u=se+_+65535,_=Math.floor(u/65536),se=u-_*65536,u=ee+_+65535,_=Math.floor(u/65536),ee=u-_*65536,K+=_-1+37*(_-1),T[0]=K,T[1]=V,T[2]=le,T[3]=ye,T[4]=de,T[5]=ve,T[6]=Ue,T[7]=Re,T[8]=_e,T[9]=pe,T[10]=he,T[11]=ue,T[12]=ce,T[13]=oe,T[14]=se,T[15]=ee}function p(T,I){o(T,I,I)}function L(T,I){const S=i();let u;for(u=0;u<16;u++)S[u]=I[u];for(u=253;u>=0;u--)p(S,S),u!==2&&u!==4&&o(S,S,I);for(u=0;u<16;u++)T[u]=S[u]}function z(T,I){const S=i();let u;for(u=0;u<16;u++)S[u]=I[u];for(u=250;u>=0;u--)p(S,S),u!==1&&o(S,S,I);for(u=0;u<16;u++)T[u]=S[u]}function k(T,I){const S=i(),u=i(),_=i(),K=i(),V=i(),le=i(),ye=i(),de=i(),ve=i();w(S,T[1],T[0]),w(ve,I[1],I[0]),o(S,S,ve),v(u,T[0],T[1]),v(ve,I[0],I[1]),o(u,u,ve),o(_,T[3],I[3]),o(_,_,f),o(K,T[2],I[2]),v(K,K,K),w(V,u,S),w(le,K,_),v(ye,K,_),v(de,u,S),o(T[0],V,le),o(T[1],de,ye),o(T[2],ye,le),o(T[3],V,de)}function X(T,I,S){for(let u=0;u<4;u++)R(T[u],I[u],S)}function J(T,I){const S=i(),u=i(),_=i();L(_,I[2]),o(S,I[0],_),o(u,I[1],_),P(T,u),T[31]^=O(S)<<7}function A(T,I,S){y(T[0],a),y(T[1],c),y(T[2],c),y(T[3],a);for(let u=255;u>=0;--u){const _=S[u/8|0]>>(u&7)&1;X(T,I,_),k(I,T),k(T,T),X(T,I,_)}}function N(T,I){const S=[i(),i(),i(),i()];y(S[0],h),y(S[1],m),y(S[2],c),o(S[3],h,m),A(T,S,I)}function W(T){if(T.length!==e.SEED_LENGTH)throw new Error(`ed25519: seed must be ${e.SEED_LENGTH} bytes`);const I=(0,r.hash)(T);I[0]&=248,I[31]&=127,I[31]|=64;const S=new Uint8Array(32),u=[i(),i(),i(),i()];N(u,I),J(S,u);const _=new Uint8Array(64);return _.set(T),_.set(S,32),{publicKey:S,secretKey:_}}e.generateKeyPairFromSeed=W;function M(T){const I=(0,t.randomBytes)(32,T),S=W(I);return(0,n.wipe)(I),S}e.generateKeyPair=M;function F(T){if(T.length!==e.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${e.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(T.subarray(32))}e.extractPublicKeyFromSecretKey=F;const U=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function $(T,I){let S,u,_,K;for(u=63;u>=32;--u){for(S=0,_=u-32,K=u-12;_<K;++_)I[_]+=S-16*I[u]*U[_-(u-32)],S=Math.floor((I[_]+128)/256),I[_]-=S*256;I[_]+=S,I[u]=0}for(S=0,_=0;_<32;_++)I[_]+=S-(I[31]>>4)*U[_],S=I[_]>>8,I[_]&=255;for(_=0;_<32;_++)I[_]-=S*U[_];for(u=0;u<32;u++)I[u+1]+=I[u]>>8,T[u]=I[u]&255}function B(T){const I=new Float64Array(64);for(let S=0;S<64;S++)I[S]=T[S];for(let S=0;S<64;S++)T[S]=0;$(T,I)}function ne(T,I){const S=new Float64Array(64),u=[i(),i(),i(),i()],_=(0,r.hash)(T.subarray(0,32));_[0]&=248,_[31]&=127,_[31]|=64;const K=new Uint8Array(64);K.set(_.subarray(32),32);const V=new r.SHA512;V.update(K.subarray(32)),V.update(I);const le=V.digest();V.clean(),B(le),N(u,le),J(K,u),V.reset(),V.update(K.subarray(0,32)),V.update(T.subarray(32)),V.update(I);const ye=V.digest();B(ye);for(let de=0;de<32;de++)S[de]=le[de];for(let de=0;de<32;de++)for(let ve=0;ve<32;ve++)S[de+ve]+=ye[de]*_[ve];return $(K.subarray(32),S),K}e.sign=ne;function q(T,I){const S=i(),u=i(),_=i(),K=i(),V=i(),le=i(),ye=i();return y(T[2],c),g(T[1],I),p(_,T[1]),o(K,_,l),w(_,_,T[2]),v(K,T[2],K),p(V,K),p(le,V),o(ye,le,V),o(S,ye,_),o(S,S,K),z(S,S),o(S,S,_),o(S,S,K),o(S,S,K),o(T[0],S,K),p(u,T[0]),o(u,u,K),E(u,_)&&o(T[0],T[0],b),p(u,T[0]),o(u,u,K),E(u,_)?-1:(O(T[0])===I[31]>>7&&w(T[0],a,T[0]),o(T[3],T[0],T[1]),0)}function Q(T,I,S){const u=new Uint8Array(32),_=[i(),i(),i(),i()],K=[i(),i(),i(),i()];if(S.length!==e.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${e.SIGNATURE_LENGTH} bytes`);if(q(K,T))return!1;const V=new r.SHA512;V.update(S.subarray(0,32)),V.update(T),V.update(I);const le=V.digest();return B(le),A(_,K,le),N(K,S.subarray(32)),k(_,K),J(u,_),!j(S,u)}e.verify=Q;function Y(T){let I=[i(),i(),i(),i()];if(q(I,T))throw new Error("Ed25519: invalid public key");let S=i(),u=i(),_=I[1];v(S,c,_),w(u,c,_),L(u,u),o(S,S,u);let K=new Uint8Array(32);return P(K,S),K}e.convertPublicKeyToX25519=Y;function ae(T){const I=(0,r.hash)(T.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const S=new Uint8Array(I.subarray(0,32));return(0,n.wipe)(I),S}e.convertSecretKeyToX25519=ae}(Gn);const tl="EdDSA",rl="JWT",js=".",zs="base64url",nl="utf8",il="utf8",sl=":",ol="did",al="key",Bs="base58btc",cl="z",ul="K36",fl=32;function qs(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function Jn(e,t){t||(t=e.reduce((i,s)=>i+s.length,0));const r=qs(t);let n=0;for(const i of e)r.set(i,n),n+=i.length;return r}function ll(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var c=e.length,l=e.charAt(0),f=Math.log(c)/Math.log(256),h=Math.log(256)/Math.log(c);function m(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var R=0,P=0,j=0,E=D.length;j!==E&&D[j]===0;)j++,R++;for(var O=(E-j)*h+1>>>0,g=new Uint8Array(O);j!==E;){for(var v=D[j],w=0,o=O-1;(v!==0||w<P)&&o!==-1;o--,w++)v+=256*g[o]>>>0,g[o]=v%c>>>0,v=v/c>>>0;if(v!==0)throw new Error("Non-zero carry");P=w,j++}for(var p=O-P;p!==O&&g[p]===0;)p++;for(var L=l.repeat(R);p<O;++p)L+=e.charAt(g[p]);return L}function b(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var R=0;if(D[R]!==" "){for(var P=0,j=0;D[R]===l;)P++,R++;for(var E=(D.length-R)*f+1>>>0,O=new Uint8Array(E);D[R];){var g=r[D.charCodeAt(R)];if(g===255)return;for(var v=0,w=E-1;(g!==0||v<j)&&w!==-1;w--,v++)g+=c*O[w]>>>0,O[w]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");j=v,R++}if(D[R]!==" "){for(var o=E-j;o!==E&&O[o]===0;)o++;for(var p=new Uint8Array(P+(E-o)),L=P;o!==E;)p[L++]=O[o++];return p}}}function y(D){var R=b(D);if(R)return R;throw new Error(`Non-${t} character`)}return{encode:m,decodeUnsafe:b,decode:y}}var hl=ll,dl=hl;const Ks=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},pl=e=>new TextEncoder().encode(e),gl=e=>new TextDecoder().decode(e);class _l{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class yl{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Hs(this,t)}}class bl{constructor(t){this.decoders=t}or(t){return Hs(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const Hs=(e,t)=>new bl({...e.decoders||{[e.prefix]:e},...t.decoders||{[t.prefix]:t}});class wl{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new _l(t,r,n),this.decoder=new yl(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const en=({name:e,prefix:t,encode:r,decode:n})=>new wl(e,t,r,n),Or=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=dl(r,t);return en({prefix:e,name:t,encode:n,decode:s=>Ks(i(s))})},vl=(e,t,r,n)=>{const i={};for(let h=0;h<t.length;++h)i[t[h]]=h;let s=e.length;for(;e[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,l=0,f=0;for(let h=0;h<s;++h){const m=i[e[h]];if(m===void 0)throw new SyntaxError(`Non-${n} character`);l=l<<r|m,c+=r,c>=8&&(c-=8,a[f++]=255&l>>c)}if(c>=r||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return a},ml=(e,t,r)=>{const n=t[t.length-1]==="=",i=(1<<r)-1;let s="",a=0,c=0;for(let l=0;l<e.length;++l)for(c=c<<8|e[l],a+=8;a>r;)a-=r,s+=t[i&c>>a];if(a&&(s+=t[i&c<<r-a]),n)for(;s.length*r&7;)s+="=";return s},et=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>en({prefix:t,name:e,encode(i){return ml(i,n,r)},decode(i){return vl(i,n,r,e)}}),El=en({prefix:"\0",name:"identity",encode:e=>gl(e),decode:e=>pl(e)});var Dl=Object.freeze({__proto__:null,identity:El});const Sl=et({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var xl=Object.freeze({__proto__:null,base2:Sl});const Ol=et({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var Il=Object.freeze({__proto__:null,base8:Ol});const Tl=Or({prefix:"9",name:"base10",alphabet:"0123456789"});var Nl=Object.freeze({__proto__:null,base10:Tl});const Al=et({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Rl=et({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Pl=Object.freeze({__proto__:null,base16:Al,base16upper:Rl});const Cl=et({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Fl=et({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Ll=et({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Ul=et({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),$l=et({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Ml=et({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),jl=et({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),zl=et({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),Bl=et({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var ql=Object.freeze({__proto__:null,base32:Cl,base32upper:Fl,base32pad:Ll,base32padupper:Ul,base32hex:$l,base32hexupper:Ml,base32hexpad:jl,base32hexpadupper:zl,base32z:Bl});const Kl=Or({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Hl=Or({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var Vl=Object.freeze({__proto__:null,base36:Kl,base36upper:Hl});const Gl=Or({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Wl=Or({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Yl=Object.freeze({__proto__:null,base58btc:Gl,base58flickr:Wl});const kl=et({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Xl=et({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Jl=et({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Zl=et({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Ql=Object.freeze({__proto__:null,base64:kl,base64pad:Xl,base64url:Jl,base64urlpad:Zl});const Vs=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),eh=Vs.reduce((e,t,r)=>(e[r]=t,e),[]),th=Vs.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function rh(e){return e.reduce((t,r)=>(t+=eh[r],t),"")}function nh(e){const t=[];for(const r of e){const n=th[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const ih=en({prefix:"\u{1F680}",name:"base256emoji",encode:rh,decode:nh});var sh=Object.freeze({__proto__:null,base256emoji:ih}),oh=Ws,Gs=128,ah=127,ch=~ah,uh=Math.pow(2,31);function Ws(e,t,r){t=t||[],r=r||0;for(var n=r;e>=uh;)t[r++]=e&255|Gs,e/=128;for(;e&ch;)t[r++]=e&255|Gs,e>>>=7;return t[r]=e|0,Ws.bytes=r-n+1,t}var fh=Zn,lh=128,Ys=127;function Zn(e,n){var r=0,n=n||0,i=0,s=n,a,c=e.length;do{if(s>=c)throw Zn.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=i<28?(a&Ys)<<i:(a&Ys)*Math.pow(2,i),i+=7}while(a>=lh);return Zn.bytes=s-n,r}var hh=Math.pow(2,7),dh=Math.pow(2,14),ph=Math.pow(2,21),gh=Math.pow(2,28),_h=Math.pow(2,35),yh=Math.pow(2,42),bh=Math.pow(2,49),wh=Math.pow(2,56),vh=Math.pow(2,63),mh=function(e){return e<hh?1:e<dh?2:e<ph?3:e<gh?4:e<_h?5:e<yh?6:e<bh?7:e<wh?8:e<vh?9:10},Eh={encode:oh,decode:fh,encodingLength:mh},ks=Eh;const Xs=(e,t,r=0)=>(ks.encode(e,t,r),t),Js=e=>ks.encodingLength(e),Qn=(e,t)=>{const r=t.byteLength,n=Js(e),i=n+Js(r),s=new Uint8Array(i+r);return Xs(e,s,0),Xs(r,s,n),s.set(t,i),new Dh(e,r,t,s)};class Dh{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}}const Zs=({name:e,code:t,encode:r})=>new Sh(e,t,r);class Sh{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Qn(this.code,r):r.then(n=>Qn(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Qs=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),xh=Zs({name:"sha2-256",code:18,encode:Qs("SHA-256")}),Oh=Zs({name:"sha2-512",code:19,encode:Qs("SHA-512")});var Ih=Object.freeze({__proto__:null,sha256:xh,sha512:Oh});const eo=0,Th="identity",to=Ks;var Nh=Object.freeze({__proto__:null,identity:{code:eo,name:Th,encode:to,digest:e=>Qn(eo,to(e))}});new TextEncoder,new TextDecoder;const ro={...Dl,...xl,...Il,...Nl,...Pl,...ql,...Vl,...Yl,...Ql,...sh};({...Ih,...Nh});function no(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const io=no("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),ei=no("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=qs(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),so={utf8:io,"utf-8":io,hex:ro.base16,latin1:ei,ascii:ei,binary:ei,...ro};function ft(e,t="utf8"){const r=so[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e.buffer,e.byteOffset,e.byteLength).toString("utf8"):r.encoder.encode(e).substring(1)}function lt(e,t="utf8"){const r=so[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}function tn(e){return ft(lt(Vn(e),nl),zs)}function oo(e){const t=lt(ul,Bs),r=cl+ft(Jn([t,e]),Bs);return[ol,al,r].join(sl)}function Ah(e){return ft(e,zs)}function Rh(e){return lt([tn(e.header),tn(e.payload)].join(js),il)}function Ph(e){return[tn(e.header),tn(e.payload),Ah(e.signature)].join(js)}function ao(e=ar.randomBytes(fl)){return Gn.generateKeyPairFromSeed(e)}async function Ch(e,t,r,n,i=Z.fromMiliseconds(Date.now())){const s={alg:tl,typ:rl},a=oo(n.publicKey),c=i+r,l={iss:a,sub:e,aud:t,iat:i,exp:c},f=Rh({header:s,payload:l}),h=Gn.sign(n.secretKey,f);return Ph({header:s,payload:l,signature:h})}var ti={},rn={};Object.defineProperty(rn,"__esModule",{value:!0});var it=te,ri=pt,Fh=20;function Lh(e,t,r){for(var n=1634760805,i=857760878,s=2036477234,a=1797285236,c=r[3]<<24|r[2]<<16|r[1]<<8|r[0],l=r[7]<<24|r[6]<<16|r[5]<<8|r[4],f=r[11]<<24|r[10]<<16|r[9]<<8|r[8],h=r[15]<<24|r[14]<<16|r[13]<<8|r[12],m=r[19]<<24|r[18]<<16|r[17]<<8|r[16],b=r[23]<<24|r[22]<<16|r[21]<<8|r[20],y=r[27]<<24|r[26]<<16|r[25]<<8|r[24],D=r[31]<<24|r[30]<<16|r[29]<<8|r[28],R=t[3]<<24|t[2]<<16|t[1]<<8|t[0],P=t[7]<<24|t[6]<<16|t[5]<<8|t[4],j=t[11]<<24|t[10]<<16|t[9]<<8|t[8],E=t[15]<<24|t[14]<<16|t[13]<<8|t[12],O=n,g=i,v=s,w=a,o=c,p=l,L=f,z=h,k=m,X=b,J=y,A=D,N=R,W=P,M=j,F=E,U=0;U<Fh;U+=2)O=O+o|0,N^=O,N=N>>>32-16|N<<16,k=k+N|0,o^=k,o=o>>>32-12|o<<12,g=g+p|0,W^=g,W=W>>>32-16|W<<16,X=X+W|0,p^=X,p=p>>>32-12|p<<12,v=v+L|0,M^=v,M=M>>>32-16|M<<16,J=J+M|0,L^=J,L=L>>>32-12|L<<12,w=w+z|0,F^=w,F=F>>>32-16|F<<16,A=A+F|0,z^=A,z=z>>>32-12|z<<12,v=v+L|0,M^=v,M=M>>>32-8|M<<8,J=J+M|0,L^=J,L=L>>>32-7|L<<7,w=w+z|0,F^=w,F=F>>>32-8|F<<8,A=A+F|0,z^=A,z=z>>>32-7|z<<7,g=g+p|0,W^=g,W=W>>>32-8|W<<8,X=X+W|0,p^=X,p=p>>>32-7|p<<7,O=O+o|0,N^=O,N=N>>>32-8|N<<8,k=k+N|0,o^=k,o=o>>>32-7|o<<7,O=O+p|0,F^=O,F=F>>>32-16|F<<16,J=J+F|0,p^=J,p=p>>>32-12|p<<12,g=g+L|0,N^=g,N=N>>>32-16|N<<16,A=A+N|0,L^=A,L=L>>>32-12|L<<12,v=v+z|0,W^=v,W=W>>>32-16|W<<16,k=k+W|0,z^=k,z=z>>>32-12|z<<12,w=w+o|0,M^=w,M=M>>>32-16|M<<16,X=X+M|0,o^=X,o=o>>>32-12|o<<12,v=v+z|0,W^=v,W=W>>>32-8|W<<8,k=k+W|0,z^=k,z=z>>>32-7|z<<7,w=w+o|0,M^=w,M=M>>>32-8|M<<8,X=X+M|0,o^=X,o=o>>>32-7|o<<7,g=g+L|0,N^=g,N=N>>>32-8|N<<8,A=A+N|0,L^=A,L=L>>>32-7|L<<7,O=O+p|0,F^=O,F=F>>>32-8|F<<8,J=J+F|0,p^=J,p=p>>>32-7|p<<7;it.writeUint32LE(O+n|0,e,0),it.writeUint32LE(g+i|0,e,4),it.writeUint32LE(v+s|0,e,8),it.writeUint32LE(w+a|0,e,12),it.writeUint32LE(o+c|0,e,16),it.writeUint32LE(p+l|0,e,20),it.writeUint32LE(L+f|0,e,24),it.writeUint32LE(z+h|0,e,28),it.writeUint32LE(k+m|0,e,32),it.writeUint32LE(X+b|0,e,36),it.writeUint32LE(J+y|0,e,40),it.writeUint32LE(A+D|0,e,44),it.writeUint32LE(N+R|0,e,48),it.writeUint32LE(W+P|0,e,52),it.writeUint32LE(M+j|0,e,56),it.writeUint32LE(F+E|0,e,60)}function co(e,t,r,n,i){if(i===void 0&&(i=0),e.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(n.length<r.length)throw new Error("ChaCha: destination is shorter than source");var s,a;if(i===0){if(t.length!==8&&t.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");s=new Uint8Array(16),a=s.length-t.length,s.set(t,a)}else{if(t.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");s=t,a=i}for(var c=new Uint8Array(64),l=0;l<r.length;l+=64){Lh(c,s,e);for(var f=l;f<l+64&&f<r.length;f++)n[f]=r[f]^c[f-l];$h(s,0,a)}return ri.wipe(c),i===0&&ri.wipe(s),n}rn.streamXOR=co;function Uh(e,t,r,n){return n===void 0&&(n=0),ri.wipe(r),co(e,t,r,r,n)}rn.stream=Uh;function $h(e,t,r){for(var n=1;r--;)n=n+(e[t]&255)|0,e[t]=n&255,n>>>=8,t++;if(n>0)throw new Error("ChaCha: counter overflow")}var uo={},Lt={};Object.defineProperty(Lt,"__esModule",{value:!0});function Mh(e,t,r){return~(e-1)&t|e-1&r}Lt.select=Mh;function jh(e,t){return(e|0)-(t|0)-1>>>31&1}Lt.lessOrEqual=jh;function fo(e,t){if(e.length!==t.length)return 0;for(var r=0,n=0;n<e.length;n++)r|=e[n]^t[n];return 1&r-1>>>8}Lt.compare=fo;function zh(e,t){return e.length===0||t.length===0?!1:fo(e,t)!==0}Lt.equal=zh,function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=Lt,r=pt;e.DIGEST_LENGTH=16;var n=function(){function a(c){this.digestLength=e.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var l=c[0]|c[1]<<8;this._r[0]=l&8191;var f=c[2]|c[3]<<8;this._r[1]=(l>>>13|f<<3)&8191;var h=c[4]|c[5]<<8;this._r[2]=(f>>>10|h<<6)&7939;var m=c[6]|c[7]<<8;this._r[3]=(h>>>7|m<<9)&8191;var b=c[8]|c[9]<<8;this._r[4]=(m>>>4|b<<12)&255,this._r[5]=b>>>1&8190;var y=c[10]|c[11]<<8;this._r[6]=(b>>>14|y<<2)&8191;var D=c[12]|c[13]<<8;this._r[7]=(y>>>11|D<<5)&8065;var R=c[14]|c[15]<<8;this._r[8]=(D>>>8|R<<8)&8191,this._r[9]=R>>>5&127,this._pad[0]=c[16]|c[17]<<8,this._pad[1]=c[18]|c[19]<<8,this._pad[2]=c[20]|c[21]<<8,this._pad[3]=c[22]|c[23]<<8,this._pad[4]=c[24]|c[25]<<8,this._pad[5]=c[26]|c[27]<<8,this._pad[6]=c[28]|c[29]<<8,this._pad[7]=c[30]|c[31]<<8}return a.prototype._blocks=function(c,l,f){for(var h=this._fin?0:2048,m=this._h[0],b=this._h[1],y=this._h[2],D=this._h[3],R=this._h[4],P=this._h[5],j=this._h[6],E=this._h[7],O=this._h[8],g=this._h[9],v=this._r[0],w=this._r[1],o=this._r[2],p=this._r[3],L=this._r[4],z=this._r[5],k=this._r[6],X=this._r[7],J=this._r[8],A=this._r[9];f>=16;){var N=c[l+0]|c[l+1]<<8;m+=N&8191;var W=c[l+2]|c[l+3]<<8;b+=(N>>>13|W<<3)&8191;var M=c[l+4]|c[l+5]<<8;y+=(W>>>10|M<<6)&8191;var F=c[l+6]|c[l+7]<<8;D+=(M>>>7|F<<9)&8191;var U=c[l+8]|c[l+9]<<8;R+=(F>>>4|U<<12)&8191,P+=U>>>1&8191;var $=c[l+10]|c[l+11]<<8;j+=(U>>>14|$<<2)&8191;var B=c[l+12]|c[l+13]<<8;E+=($>>>11|B<<5)&8191;var ne=c[l+14]|c[l+15]<<8;O+=(B>>>8|ne<<8)&8191,g+=ne>>>5|h;var q=0,Q=q;Q+=m*v,Q+=b*(5*A),Q+=y*(5*J),Q+=D*(5*X),Q+=R*(5*k),q=Q>>>13,Q&=8191,Q+=P*(5*z),Q+=j*(5*L),Q+=E*(5*p),Q+=O*(5*o),Q+=g*(5*w),q+=Q>>>13,Q&=8191;var Y=q;Y+=m*w,Y+=b*v,Y+=y*(5*A),Y+=D*(5*J),Y+=R*(5*X),q=Y>>>13,Y&=8191,Y+=P*(5*k),Y+=j*(5*z),Y+=E*(5*L),Y+=O*(5*p),Y+=g*(5*o),q+=Y>>>13,Y&=8191;var ae=q;ae+=m*o,ae+=b*w,ae+=y*v,ae+=D*(5*A),ae+=R*(5*J),q=ae>>>13,ae&=8191,ae+=P*(5*X),ae+=j*(5*k),ae+=E*(5*z),ae+=O*(5*L),ae+=g*(5*p),q+=ae>>>13,ae&=8191;var T=q;T+=m*p,T+=b*o,T+=y*w,T+=D*v,T+=R*(5*A),q=T>>>13,T&=8191,T+=P*(5*J),T+=j*(5*X),T+=E*(5*k),T+=O*(5*z),T+=g*(5*L),q+=T>>>13,T&=8191;var I=q;I+=m*L,I+=b*p,I+=y*o,I+=D*w,I+=R*v,q=I>>>13,I&=8191,I+=P*(5*A),I+=j*(5*J),I+=E*(5*X),I+=O*(5*k),I+=g*(5*z),q+=I>>>13,I&=8191;var S=q;S+=m*z,S+=b*L,S+=y*p,S+=D*o,S+=R*w,q=S>>>13,S&=8191,S+=P*v,S+=j*(5*A),S+=E*(5*J),S+=O*(5*X),S+=g*(5*k),q+=S>>>13,S&=8191;var u=q;u+=m*k,u+=b*z,u+=y*L,u+=D*p,u+=R*o,q=u>>>13,u&=8191,u+=P*w,u+=j*v,u+=E*(5*A),u+=O*(5*J),u+=g*(5*X),q+=u>>>13,u&=8191;var _=q;_+=m*X,_+=b*k,_+=y*z,_+=D*L,_+=R*p,q=_>>>13,_&=8191,_+=P*o,_+=j*w,_+=E*v,_+=O*(5*A),_+=g*(5*J),q+=_>>>13,_&=8191;var K=q;K+=m*J,K+=b*X,K+=y*k,K+=D*z,K+=R*L,q=K>>>13,K&=8191,K+=P*p,K+=j*o,K+=E*w,K+=O*v,K+=g*(5*A),q+=K>>>13,K&=8191;var V=q;V+=m*A,V+=b*J,V+=y*X,V+=D*k,V+=R*z,q=V>>>13,V&=8191,V+=P*L,V+=j*p,V+=E*o,V+=O*w,V+=g*v,q+=V>>>13,V&=8191,q=(q<<2)+q|0,q=q+Q|0,Q=q&8191,q=q>>>13,Y+=q,m=Q,b=Y,y=ae,D=T,R=I,P=S,j=u,E=_,O=K,g=V,l+=16,f-=16}this._h[0]=m,this._h[1]=b,this._h[2]=y,this._h[3]=D,this._h[4]=R,this._h[5]=P,this._h[6]=j,this._h[7]=E,this._h[8]=O,this._h[9]=g},a.prototype.finish=function(c,l){l===void 0&&(l=0);var f=new Uint16Array(10),h,m,b,y;if(this._leftover){for(y=this._leftover,this._buffer[y++]=1;y<16;y++)this._buffer[y]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(h=this._h[1]>>>13,this._h[1]&=8191,y=2;y<10;y++)this._h[y]+=h,h=this._h[y]>>>13,this._h[y]&=8191;for(this._h[0]+=h*5,h=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=h,h=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=h,f[0]=this._h[0]+5,h=f[0]>>>13,f[0]&=8191,y=1;y<10;y++)f[y]=this._h[y]+h,h=f[y]>>>13,f[y]&=8191;for(f[9]-=1<<13,m=(h^1)-1,y=0;y<10;y++)f[y]&=m;for(m=~m,y=0;y<10;y++)this._h[y]=this._h[y]&m|f[y];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,b=this._h[0]+this._pad[0],this._h[0]=b&65535,y=1;y<8;y++)b=(this._h[y]+this._pad[y]|0)+(b>>>16)|0,this._h[y]=b&65535;return c[l+0]=this._h[0]>>>0,c[l+1]=this._h[0]>>>8,c[l+2]=this._h[1]>>>0,c[l+3]=this._h[1]>>>8,c[l+4]=this._h[2]>>>0,c[l+5]=this._h[2]>>>8,c[l+6]=this._h[3]>>>0,c[l+7]=this._h[3]>>>8,c[l+8]=this._h[4]>>>0,c[l+9]=this._h[4]>>>8,c[l+10]=this._h[5]>>>0,c[l+11]=this._h[5]>>>8,c[l+12]=this._h[6]>>>0,c[l+13]=this._h[6]>>>8,c[l+14]=this._h[7]>>>0,c[l+15]=this._h[7]>>>8,this._finished=!0,this},a.prototype.update=function(c){var l=0,f=c.length,h;if(this._leftover){h=16-this._leftover,h>f&&(h=f);for(var m=0;m<h;m++)this._buffer[this._leftover+m]=c[l+m];if(f-=h,l+=h,this._leftover+=h,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(f>=16&&(h=f-f%16,this._blocks(c,l,h),l+=h,f-=h),f){for(var m=0;m<f;m++)this._buffer[this._leftover+m]=c[l+m];this._leftover+=f}return this},a.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var c=new Uint8Array(16);return this.finish(c),c},a.prototype.clean=function(){return r.wipe(this._buffer),r.wipe(this._r),r.wipe(this._h),r.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},a}();e.Poly1305=n;function i(a,c){var l=new n(a);l.update(c);var f=l.digest();return l.clean(),f}e.oneTimeAuth=i;function s(a,c){return a.length!==e.DIGEST_LENGTH||c.length!==e.DIGEST_LENGTH?!1:t.equal(a,c)}e.equal=s}(uo),function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=rn,r=uo,n=pt,i=te,s=Lt;e.KEY_LENGTH=32,e.NONCE_LENGTH=12,e.TAG_LENGTH=16;var a=new Uint8Array(16),c=function(){function l(f){if(this.nonceLength=e.NONCE_LENGTH,this.tagLength=e.TAG_LENGTH,f.length!==e.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(f)}return l.prototype.seal=function(f,h,m,b){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var y=new Uint8Array(16);y.set(f,y.length-f.length);var D=new Uint8Array(32);t.stream(this._key,y,D,4);var R=h.length+this.tagLength,P;if(b){if(b.length!==R)throw new Error("ChaCha20Poly1305: incorrect destination length");P=b}else P=new Uint8Array(R);return t.streamXOR(this._key,y,h,P,4),this._authenticate(P.subarray(P.length-this.tagLength,P.length),D,P.subarray(0,P.length-this.tagLength),m),n.wipe(y),P},l.prototype.open=function(f,h,m,b){if(f.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(h.length<this.tagLength)return null;var y=new Uint8Array(16);y.set(f,y.length-f.length);var D=new Uint8Array(32);t.stream(this._key,y,D,4);var R=new Uint8Array(this.tagLength);if(this._authenticate(R,D,h.subarray(0,h.length-this.tagLength),m),!s.equal(R,h.subarray(h.length-this.tagLength,h.length)))return null;var P=h.length-this.tagLength,j;if(b){if(b.length!==P)throw new Error("ChaCha20Poly1305: incorrect destination length");j=b}else j=new Uint8Array(P);return t.streamXOR(this._key,y,h.subarray(0,h.length-this.tagLength),j,4),n.wipe(y),j},l.prototype.clean=function(){return n.wipe(this._key),this},l.prototype._authenticate=function(f,h,m,b){var y=new r.Poly1305(h);b&&(y.update(b),b.length%16>0&&y.update(a.subarray(b.length%16))),y.update(m),m.length%16>0&&y.update(a.subarray(m.length%16));var D=new Uint8Array(8);b&&i.writeUint64LE(b.length,D),y.update(D),i.writeUint64LE(m.length,D),y.update(D);for(var R=y.digest(),P=0;P<R.length;P++)f[P]=R[P];y.clean(),n.wipe(R),n.wipe(D)},l}();e.ChaCha20Poly1305=c}(ti);var lo={},Ir={},ni={};Object.defineProperty(ni,"__esModule",{value:!0});function Bh(e){return typeof e.saveState<"u"&&typeof e.restoreState<"u"&&typeof e.cleanSavedState<"u"}ni.isSerializableHash=Bh,Object.defineProperty(Ir,"__esModule",{value:!0});var xt=ni,qh=Lt,Kh=pt,ho=function(){function e(t,r){this._finished=!1,this._inner=new t,this._outer=new t,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var n=new Uint8Array(this.blockSize);r.length>this.blockSize?this._inner.update(r).finish(n).clean():n.set(r);for(var i=0;i<n.length;i++)n[i]^=54;this._inner.update(n);for(var i=0;i<n.length;i++)n[i]^=106;this._outer.update(n),xt.isSerializableHash(this._inner)&&xt.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),Kh.wipe(n)}return e.prototype.reset=function(){if(!xt.isSerializableHash(this._inner)||!xt.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.clean=function(){xt.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),xt.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},e.prototype.update=function(t){return this._inner.update(t),this},e.prototype.finish=function(t){return this._finished?(this._outer.finish(t),this):(this._inner.finish(t),this._outer.update(t.subarray(0,this.digestLength)).finish(t),this._finished=!0,this)},e.prototype.digest=function(){var t=new Uint8Array(this.digestLength);return this.finish(t),t},e.prototype.saveState=function(){if(!xt.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},e.prototype.restoreState=function(t){if(!xt.isSerializableHash(this._inner)||!xt.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(t),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},e.prototype.cleanSavedState=function(t){if(!xt.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(t)},e}();Ir.HMAC=ho;function Hh(e,t,r){var n=new ho(e,t);n.update(r);var i=n.digest();return n.clean(),i}Ir.hmac=Hh,Ir.equal=qh.equal,Object.defineProperty(lo,"__esModule",{value:!0});var po=Ir,go=pt,Vh=function(){function e(t,r,n,i){n===void 0&&(n=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=t,this._info=i;var s=po.hmac(this._hash,n,r);this._hmac=new po.HMAC(t,s),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return e.prototype._fillBuffer=function(){this._counter[0]++;var t=this._counter[0];if(t===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),t>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},e.prototype.expand=function(t){for(var r=new Uint8Array(t),n=0;n<r.length;n++)this._bufpos===this._buffer.length&&this._fillBuffer(),r[n]=this._buffer[this._bufpos++];return r},e.prototype.clean=function(){this._hmac.clean(),go.wipe(this._buffer),go.wipe(this._counter),this._bufpos=0},e}(),Gh=lo.HKDF=Vh,nn={};(function(e){Object.defineProperty(e,"__esModule",{value:!0});var t=te,r=pt;e.DIGEST_LENGTH=32,e.BLOCK_SIZE=64;var n=function(){function c(){this.digestLength=e.DIGEST_LENGTH,this.blockSize=e.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return c.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},c.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},c.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._temp),this.reset()},c.prototype.update=function(l,f){if(f===void 0&&(f=l.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var h=0;if(this._bytesHashed+=f,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&f>0;)this._buffer[this._bufferLength++]=l[h++],f--;this._bufferLength===this.blockSize&&(s(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(f>=this.blockSize&&(h=s(this._temp,this._state,l,h,f),f%=this.blockSize);f>0;)this._buffer[this._bufferLength++]=l[h++],f--;return this},c.prototype.finish=function(l){if(!this._finished){var f=this._bytesHashed,h=this._bufferLength,m=f/536870912|0,b=f<<3,y=f%64<56?64:128;this._buffer[h]=128;for(var D=h+1;D<y-8;D++)this._buffer[D]=0;t.writeUint32BE(m,this._buffer,y-8),t.writeUint32BE(b,this._buffer,y-4),s(this._temp,this._state,this._buffer,0,y),this._finished=!0}for(var D=0;D<this.digestLength/4;D++)t.writeUint32BE(this._state[D],l,D*4);return this},c.prototype.digest=function(){var l=new Uint8Array(this.digestLength);return this.finish(l),l},c.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},c.prototype.restoreState=function(l){return this._state.set(l.state),this._bufferLength=l.bufferLength,l.buffer&&this._buffer.set(l.buffer),this._bytesHashed=l.bytesHashed,this._finished=!1,this},c.prototype.cleanSavedState=function(l){r.wipe(l.state),l.buffer&&r.wipe(l.buffer),l.bufferLength=0,l.bytesHashed=0},c}();e.SHA256=n;var i=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function s(c,l,f,h,m){for(;m>=64;){for(var b=l[0],y=l[1],D=l[2],R=l[3],P=l[4],j=l[5],E=l[6],O=l[7],g=0;g<16;g++){var v=h+g*4;c[g]=t.readUint32BE(f,v)}for(var g=16;g<64;g++){var w=c[g-2],o=(w>>>17|w<<32-17)^(w>>>19|w<<32-19)^w>>>10;w=c[g-15];var p=(w>>>7|w<<32-7)^(w>>>18|w<<32-18)^w>>>3;c[g]=(o+c[g-7]|0)+(p+c[g-16]|0)}for(var g=0;g<64;g++){var o=(((P>>>6|P<<26)^(P>>>11|P<<21)^(P>>>25|P<<7))+(P&j^~P&E)|0)+(O+(i[g]+c[g]|0)|0)|0,p=((b>>>2|b<<32-2)^(b>>>13|b<<32-13)^(b>>>22|b<<32-22))+(b&y^b&D^y&D)|0;O=E,E=j,j=P,P=R+o|0,R=D,D=y,y=b,b=o+p|0}l[0]+=b,l[1]+=y,l[2]+=D,l[3]+=R,l[4]+=P,l[5]+=j,l[6]+=E,l[7]+=O,h+=64,m-=64}return h}function a(c){var l=new n;l.update(c);var f=l.digest();return l.clean(),f}e.hash=a})(nn);var ii={};(function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.sharedKey=e.generateKeyPair=e.generateKeyPairFromSeed=e.scalarMultBase=e.scalarMult=e.SHARED_KEY_LENGTH=e.SECRET_KEY_LENGTH=e.PUBLIC_KEY_LENGTH=void 0;const t=ar,r=pt;e.PUBLIC_KEY_LENGTH=32,e.SECRET_KEY_LENGTH=32,e.SHARED_KEY_LENGTH=32;function n(g){const v=new Float64Array(16);if(g)for(let w=0;w<g.length;w++)v[w]=g[w];return v}const i=new Uint8Array(32);i[0]=9;const s=n([56129,1]);function a(g){let v=1;for(let w=0;w<16;w++){let o=g[w]+v+65535;v=Math.floor(o/65536),g[w]=o-v*65536}g[0]+=v-1+37*(v-1)}function c(g,v,w){const o=~(w-1);for(let p=0;p<16;p++){const L=o&(g[p]^v[p]);g[p]^=L,v[p]^=L}}function l(g,v){const w=n(),o=n();for(let p=0;p<16;p++)o[p]=v[p];a(o),a(o),a(o);for(let p=0;p<2;p++){w[0]=o[0]-65517;for(let z=1;z<15;z++)w[z]=o[z]-65535-(w[z-1]>>16&1),w[z-1]&=65535;w[15]=o[15]-32767-(w[14]>>16&1);const L=w[15]>>16&1;w[14]&=65535,c(o,w,1-L)}for(let p=0;p<16;p++)g[2*p]=o[p]&255,g[2*p+1]=o[p]>>8}function f(g,v){for(let w=0;w<16;w++)g[w]=v[2*w]+(v[2*w+1]<<8);g[15]&=32767}function h(g,v,w){for(let o=0;o<16;o++)g[o]=v[o]+w[o]}function m(g,v,w){for(let o=0;o<16;o++)g[o]=v[o]-w[o]}function b(g,v,w){let o,p,L=0,z=0,k=0,X=0,J=0,A=0,N=0,W=0,M=0,F=0,U=0,$=0,B=0,ne=0,q=0,Q=0,Y=0,ae=0,T=0,I=0,S=0,u=0,_=0,K=0,V=0,le=0,ye=0,de=0,ve=0,Ue=0,Re=0,_e=w[0],pe=w[1],he=w[2],ue=w[3],ce=w[4],oe=w[5],se=w[6],ee=w[7],fe=w[8],ge=w[9],re=w[10],be=w[11],we=w[12],Ee=w[13],De=w[14],me=w[15];o=v[0],L+=o*_e,z+=o*pe,k+=o*he,X+=o*ue,J+=o*ce,A+=o*oe,N+=o*se,W+=o*ee,M+=o*fe,F+=o*ge,U+=o*re,$+=o*be,B+=o*we,ne+=o*Ee,q+=o*De,Q+=o*me,o=v[1],z+=o*_e,k+=o*pe,X+=o*he,J+=o*ue,A+=o*ce,N+=o*oe,W+=o*se,M+=o*ee,F+=o*fe,U+=o*ge,$+=o*re,B+=o*be,ne+=o*we,q+=o*Ee,Q+=o*De,Y+=o*me,o=v[2],k+=o*_e,X+=o*pe,J+=o*he,A+=o*ue,N+=o*ce,W+=o*oe,M+=o*se,F+=o*ee,U+=o*fe,$+=o*ge,B+=o*re,ne+=o*be,q+=o*we,Q+=o*Ee,Y+=o*De,ae+=o*me,o=v[3],X+=o*_e,J+=o*pe,A+=o*he,N+=o*ue,W+=o*ce,M+=o*oe,F+=o*se,U+=o*ee,$+=o*fe,B+=o*ge,ne+=o*re,q+=o*be,Q+=o*we,Y+=o*Ee,ae+=o*De,T+=o*me,o=v[4],J+=o*_e,A+=o*pe,N+=o*he,W+=o*ue,M+=o*ce,F+=o*oe,U+=o*se,$+=o*ee,B+=o*fe,ne+=o*ge,q+=o*re,Q+=o*be,Y+=o*we,ae+=o*Ee,T+=o*De,I+=o*me,o=v[5],A+=o*_e,N+=o*pe,W+=o*he,M+=o*ue,F+=o*ce,U+=o*oe,$+=o*se,B+=o*ee,ne+=o*fe,q+=o*ge,Q+=o*re,Y+=o*be,ae+=o*we,T+=o*Ee,I+=o*De,S+=o*me,o=v[6],N+=o*_e,W+=o*pe,M+=o*he,F+=o*ue,U+=o*ce,$+=o*oe,B+=o*se,ne+=o*ee,q+=o*fe,Q+=o*ge,Y+=o*re,ae+=o*be,T+=o*we,I+=o*Ee,S+=o*De,u+=o*me,o=v[7],W+=o*_e,M+=o*pe,F+=o*he,U+=o*ue,$+=o*ce,B+=o*oe,ne+=o*se,q+=o*ee,Q+=o*fe,Y+=o*ge,ae+=o*re,T+=o*be,I+=o*we,S+=o*Ee,u+=o*De,_+=o*me,o=v[8],M+=o*_e,F+=o*pe,U+=o*he,$+=o*ue,B+=o*ce,ne+=o*oe,q+=o*se,Q+=o*ee,Y+=o*fe,ae+=o*ge,T+=o*re,I+=o*be,S+=o*we,u+=o*Ee,_+=o*De,K+=o*me,o=v[9],F+=o*_e,U+=o*pe,$+=o*he,B+=o*ue,ne+=o*ce,q+=o*oe,Q+=o*se,Y+=o*ee,ae+=o*fe,T+=o*ge,I+=o*re,S+=o*be,u+=o*we,_+=o*Ee,K+=o*De,V+=o*me,o=v[10],U+=o*_e,$+=o*pe,B+=o*he,ne+=o*ue,q+=o*ce,Q+=o*oe,Y+=o*se,ae+=o*ee,T+=o*fe,I+=o*ge,S+=o*re,u+=o*be,_+=o*we,K+=o*Ee,V+=o*De,le+=o*me,o=v[11],$+=o*_e,B+=o*pe,ne+=o*he,q+=o*ue,Q+=o*ce,Y+=o*oe,ae+=o*se,T+=o*ee,I+=o*fe,S+=o*ge,u+=o*re,_+=o*be,K+=o*we,V+=o*Ee,le+=o*De,ye+=o*me,o=v[12],B+=o*_e,ne+=o*pe,q+=o*he,Q+=o*ue,Y+=o*ce,ae+=o*oe,T+=o*se,I+=o*ee,S+=o*fe,u+=o*ge,_+=o*re,K+=o*be,V+=o*we,le+=o*Ee,ye+=o*De,de+=o*me,o=v[13],ne+=o*_e,q+=o*pe,Q+=o*he,Y+=o*ue,ae+=o*ce,T+=o*oe,I+=o*se,S+=o*ee,u+=o*fe,_+=o*ge,K+=o*re,V+=o*be,le+=o*we,ye+=o*Ee,de+=o*De,ve+=o*me,o=v[14],q+=o*_e,Q+=o*pe,Y+=o*he,ae+=o*ue,T+=o*ce,I+=o*oe,S+=o*se,u+=o*ee,_+=o*fe,K+=o*ge,V+=o*re,le+=o*be,ye+=o*we,de+=o*Ee,ve+=o*De,Ue+=o*me,o=v[15],Q+=o*_e,Y+=o*pe,ae+=o*he,T+=o*ue,I+=o*ce,S+=o*oe,u+=o*se,_+=o*ee,K+=o*fe,V+=o*ge,le+=o*re,ye+=o*be,de+=o*we,ve+=o*Ee,Ue+=o*De,Re+=o*me,L+=38*Y,z+=38*ae,k+=38*T,X+=38*I,J+=38*S,A+=38*u,N+=38*_,W+=38*K,M+=38*V,F+=38*le,U+=38*ye,$+=38*de,B+=38*ve,ne+=38*Ue,q+=38*Re,p=1,o=L+p+65535,p=Math.floor(o/65536),L=o-p*65536,o=z+p+65535,p=Math.floor(o/65536),z=o-p*65536,o=k+p+65535,p=Math.floor(o/65536),k=o-p*65536,o=X+p+65535,p=Math.floor(o/65536),X=o-p*65536,o=J+p+65535,p=Math.floor(o/65536),J=o-p*65536,o=A+p+65535,p=Math.floor(o/65536),A=o-p*65536,o=N+p+65535,p=Math.floor(o/65536),N=o-p*65536,o=W+p+65535,p=Math.floor(o/65536),W=o-p*65536,o=M+p+65535,p=Math.floor(o/65536),M=o-p*65536,o=F+p+65535,p=Math.floor(o/65536),F=o-p*65536,o=U+p+65535,p=Math.floor(o/65536),U=o-p*65536,o=$+p+65535,p=Math.floor(o/65536),$=o-p*65536,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=ne+p+65535,p=Math.floor(o/65536),ne=o-p*65536,o=q+p+65535,p=Math.floor(o/65536),q=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,L+=p-1+37*(p-1),p=1,o=L+p+65535,p=Math.floor(o/65536),L=o-p*65536,o=z+p+65535,p=Math.floor(o/65536),z=o-p*65536,o=k+p+65535,p=Math.floor(o/65536),k=o-p*65536,o=X+p+65535,p=Math.floor(o/65536),X=o-p*65536,o=J+p+65535,p=Math.floor(o/65536),J=o-p*65536,o=A+p+65535,p=Math.floor(o/65536),A=o-p*65536,o=N+p+65535,p=Math.floor(o/65536),N=o-p*65536,o=W+p+65535,p=Math.floor(o/65536),W=o-p*65536,o=M+p+65535,p=Math.floor(o/65536),M=o-p*65536,o=F+p+65535,p=Math.floor(o/65536),F=o-p*65536,o=U+p+65535,p=Math.floor(o/65536),U=o-p*65536,o=$+p+65535,p=Math.floor(o/65536),$=o-p*65536,o=B+p+65535,p=Math.floor(o/65536),B=o-p*65536,o=ne+p+65535,p=Math.floor(o/65536),ne=o-p*65536,o=q+p+65535,p=Math.floor(o/65536),q=o-p*65536,o=Q+p+65535,p=Math.floor(o/65536),Q=o-p*65536,L+=p-1+37*(p-1),g[0]=L,g[1]=z,g[2]=k,g[3]=X,g[4]=J,g[5]=A,g[6]=N,g[7]=W,g[8]=M,g[9]=F,g[10]=U,g[11]=$,g[12]=B,g[13]=ne,g[14]=q,g[15]=Q}function y(g,v){b(g,v,v)}function D(g,v){const w=n();for(let o=0;o<16;o++)w[o]=v[o];for(let o=253;o>=0;o--)y(w,w),o!==2&&o!==4&&b(w,w,v);for(let o=0;o<16;o++)g[o]=w[o]}function R(g,v){const w=new Uint8Array(32),o=new Float64Array(80),p=n(),L=n(),z=n(),k=n(),X=n(),J=n();for(let M=0;M<31;M++)w[M]=g[M];w[31]=g[31]&127|64,w[0]&=248,f(o,v);for(let M=0;M<16;M++)L[M]=o[M];p[0]=k[0]=1;for(let M=254;M>=0;--M){const F=w[M>>>3]>>>(M&7)&1;c(p,L,F),c(z,k,F),h(X,p,z),m(p,p,z),h(z,L,k),m(L,L,k),y(k,X),y(J,p),b(p,z,p),b(z,L,X),h(X,p,z),m(p,p,z),y(L,p),m(z,k,J),b(p,z,s),h(p,p,k),b(z,z,p),b(p,k,J),b(k,L,o),y(L,X),c(p,L,F),c(z,k,F)}for(let M=0;M<16;M++)o[M+16]=p[M],o[M+32]=z[M],o[M+48]=L[M],o[M+64]=k[M];const A=o.subarray(32),N=o.subarray(16);D(A,A),b(N,N,A);const W=new Uint8Array(32);return l(W,N),W}e.scalarMult=R;function P(g){return R(g,i)}e.scalarMultBase=P;function j(g){if(g.length!==e.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${e.SECRET_KEY_LENGTH} bytes`);const v=new Uint8Array(g);return{publicKey:P(v),secretKey:v}}e.generateKeyPairFromSeed=j;function E(g){const v=(0,t.randomBytes)(32,g),w=j(v);return(0,r.wipe)(v),w}e.generateKeyPair=E;function O(g,v,w=!1){if(g.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(v.length!==e.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const o=R(g,v);if(w){let p=0;for(let L=0;L<o.length;L++)p|=o[L];if(p===0)throw new Error("X25519: invalid shared key")}return o}e.sharedKey=O})(ii);var _o=function(e,t,r){if(r||arguments.length===2)for(var n=0,i=t.length,s;n<i;n++)(s||!(n in t))&&(s||(s=Array.prototype.slice.call(t,0,n)),s[n]=t[n]);return e.concat(s||Array.prototype.slice.call(t))},Wh=function(){function e(t,r,n){this.name=t,this.version=r,this.os=n,this.type="browser"}return e}(),Yh=function(){function e(t){this.version=t,this.type="node",this.name="node",this.os=process.platform}return e}(),kh=function(){function e(t,r,n,i){this.name=t,this.version=r,this.os=n,this.bot=i,this.type="bot-device"}return e}(),Xh=function(){function e(){this.type="bot",this.bot=!0,this.name="bot",this.version=null,this.os=null}return e}(),Jh=function(){function e(){this.type="react-native",this.name="react-native",this.version=null,this.os=null}return e}(),Zh=/alexa|bot|crawl(er|ing)|facebookexternalhit|feedburner|google web preview|nagios|postrank|pingdom|slurp|spider|yahoo!|yandex/,Qh=/(nuhk|curl|Googlebot|Yammybot|Openbot|Slurp|MSNBot|Ask\ Jeeves\/Teoma|ia_archiver)/,yo=3,ed=[["aol",/AOLShield\/([0-9\._]+)/],["edge",/Edge\/([0-9\._]+)/],["edge-ios",/EdgiOS\/([0-9\._]+)/],["yandexbrowser",/YaBrowser\/([0-9\._]+)/],["kakaotalk",/KAKAOTALK\s([0-9\.]+)/],["samsung",/SamsungBrowser\/([0-9\.]+)/],["silk",/\bSilk\/([0-9._-]+)\b/],["miui",/MiuiBrowser\/([0-9\.]+)$/],["beaker",/BeakerBrowser\/([0-9\.]+)/],["edge-chromium",/EdgA?\/([0-9\.]+)/],["chromium-webview",/(?!Chrom.*OPR)wv\).*Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["chrome",/(?!Chrom.*OPR)Chrom(?:e|ium)\/([0-9\.]+)(:?\s|$)/],["phantomjs",/PhantomJS\/([0-9\.]+)(:?\s|$)/],["crios",/CriOS\/([0-9\.]+)(:?\s|$)/],["firefox",/Firefox\/([0-9\.]+)(?:\s|$)/],["fxios",/FxiOS\/([0-9\.]+)/],["opera-mini",/Opera Mini.*Version\/([0-9\.]+)/],["opera",/Opera\/([0-9\.]+)(?:\s|$)/],["opera",/OPR\/([0-9\.]+)(:?\s|$)/],["pie",/^Microsoft Pocket Internet Explorer\/(\d+\.\d+)$/],["pie",/^Mozilla\/\d\.\d+\s\(compatible;\s(?:MSP?IE|MSInternet Explorer) (\d+\.\d+);.*Windows CE.*\)$/],["netfront",/^Mozilla\/\d\.\d+.*NetFront\/(\d.\d)/],["ie",/Trident\/7\.0.*rv\:([0-9\.]+).*\).*Gecko$/],["ie",/MSIE\s([0-9\.]+);.*Trident\/[4-7].0/],["ie",/MSIE\s(7\.0)/],["bb10",/BB10;\sTouch.*Version\/([0-9\.]+)/],["android",/Android\s([0-9\.]+)/],["ios",/Version\/([0-9\._]+).*Mobile.*Safari.*/],["safari",/Version\/([0-9\._]+).*Safari/],["facebook",/FB[AS]V\/([0-9\.]+)/],["instagram",/Instagram\s([0-9\.]+)/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Mobile/],["ios-webview",/AppleWebKit\/([0-9\.]+).*Gecko\)$/],["curl",/^curl\/([0-9\.]+)$/],["searchbot",Zh]],bo=[["iOS",/iP(hone|od|ad)/],["Android OS",/Android/],["BlackBerry OS",/BlackBerry|BB10/],["Windows Mobile",/IEMobile/],["Amazon OS",/Kindle/],["Windows 3.11",/Win16/],["Windows 95",/(Windows 95)|(Win95)|(Windows_95)/],["Windows 98",/(Windows 98)|(Win98)/],["Windows 2000",/(Windows NT 5.0)|(Windows 2000)/],["Windows XP",/(Windows NT 5.1)|(Windows XP)/],["Windows Server 2003",/(Windows NT 5.2)/],["Windows Vista",/(Windows NT 6.0)/],["Windows 7",/(Windows NT 6.1)/],["Windows 8",/(Windows NT 6.2)/],["Windows 8.1",/(Windows NT 6.3)/],["Windows 10",/(Windows NT 10.0)/],["Windows ME",/Windows ME/],["Windows CE",/Windows CE|WinCE|Microsoft Pocket Internet Explorer/],["Open BSD",/OpenBSD/],["Sun OS",/SunOS/],["Chrome OS",/CrOS/],["Linux",/(Linux)|(X11)/],["Mac OS",/(Mac_PowerPC)|(Macintosh)/],["QNX",/QNX/],["BeOS",/BeOS/],["OS/2",/OS\/2/]];function td(e){return e?wo(e):typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"?new Jh:typeof navigator<"u"?wo(navigator.userAgent):id()}function rd(e){return e!==""&&ed.reduce(function(t,r){var n=r[0],i=r[1];if(t)return t;var s=i.exec(e);return!!s&&[n,s]},!1)}function wo(e){var t=rd(e);if(!t)return null;var r=t[0],n=t[1];if(r==="searchbot")return new Xh;var i=n[1]&&n[1].split(".").join("_").split("_").slice(0,3);i?i.length<yo&&(i=_o(_o([],i,!0),sd(yo-i.length),!0)):i=[];var s=i.join("."),a=nd(e),c=Qh.exec(e);return c&&c[1]?new kh(r,s,a,c[1]):new Wh(r,s,a)}function nd(e){for(var t=0,r=bo.length;t<r;t++){var n=bo[t],i=n[0],s=n[1],a=s.exec(e);if(a)return i}return null}function id(){var e=typeof process<"u"&&process.version;return e?new Yh(process.version.slice(1)):null}function sd(e){for(var t=[],r=0;r<e;r++)t.push("0");return t}var Oe={};Object.defineProperty(Oe,"__esModule",{value:!0}),Oe.getLocalStorage=Oe.getLocalStorageOrThrow=Oe.getCrypto=Oe.getCryptoOrThrow=mo=Oe.getLocation=Oe.getLocationOrThrow=si=Oe.getNavigator=Oe.getNavigatorOrThrow=vo=Oe.getDocument=Oe.getDocumentOrThrow=Oe.getFromWindowOrThrow=Oe.getFromWindow=void 0;function kt(e){let t;return typeof window<"u"&&typeof window[e]<"u"&&(t=window[e]),t}Oe.getFromWindow=kt;function cr(e){const t=kt(e);if(!t)throw new Error(`${e} is not defined in Window`);return t}Oe.getFromWindowOrThrow=cr;function od(){return cr("document")}Oe.getDocumentOrThrow=od;function ad(){return kt("document")}var vo=Oe.getDocument=ad;function cd(){return cr("navigator")}Oe.getNavigatorOrThrow=cd;function ud(){return kt("navigator")}var si=Oe.getNavigator=ud;function fd(){return cr("location")}Oe.getLocationOrThrow=fd;function ld(){return kt("location")}var mo=Oe.getLocation=ld;function hd(){return cr("crypto")}Oe.getCryptoOrThrow=hd;function dd(){return kt("crypto")}Oe.getCrypto=dd;function pd(){return cr("localStorage")}Oe.getLocalStorageOrThrow=pd;function gd(){return kt("localStorage")}Oe.getLocalStorage=gd;var oi={};Object.defineProperty(oi,"__esModule",{value:!0});var Eo=oi.getWindowMetadata=void 0;const Do=Oe;function _d(){let e,t;try{e=Do.getDocumentOrThrow(),t=Do.getLocationOrThrow()}catch{return null}function r(){const m=e.getElementsByTagName("link"),b=[];for(let y=0;y<m.length;y++){const D=m[y],R=D.getAttribute("rel");if(R&&R.toLowerCase().indexOf("icon")>-1){const P=D.getAttribute("href");if(P)if(P.toLowerCase().indexOf("https:")===-1&&P.toLowerCase().indexOf("http:")===-1&&P.indexOf("//")!==0){let j=t.protocol+"//"+t.host;if(P.indexOf("/")===0)j+=P;else{const E=t.pathname.split("/");E.pop();const O=E.join("/");j+=O+"/"+P}b.push(j)}else if(P.indexOf("//")===0){const j=t.protocol+P;b.push(j)}else b.push(P)}}return b}function n(...m){const b=e.getElementsByTagName("meta");for(let y=0;y<b.length;y++){const D=b[y],R=["itemprop","property","name"].map(P=>D.getAttribute(P)).filter(P=>P?m.includes(P):!1);if(R.length&&R){const P=D.getAttribute("content");if(P)return P}}return""}function i(){let m=n("name","og:site_name","og:title","twitter:title");return m||(m=e.title),m}function s(){return n("description","og:description","twitter:description","keywords")}const a=i(),c=s(),l=t.origin,f=r();return{description:c,url:l,icons:f,name:a}}Eo=oi.getWindowMetadata=_d;var Tr={},yd=e=>encodeURIComponent(e).replace(/[!'()*]/g,t=>`%${t.charCodeAt(0).toString(16).toUpperCase()}`),So="%[a-f0-9]{2}",xo=new RegExp("("+So+")|([^%]+?)","gi"),Oo=new RegExp("("+So+")+","gi");function ai(e,t){try{return[decodeURIComponent(e.join(""))]}catch{}if(e.length===1)return e;t=t||1;var r=e.slice(0,t),n=e.slice(t);return Array.prototype.concat.call([],ai(r),ai(n))}function bd(e){try{return decodeURIComponent(e)}catch{for(var t=e.match(xo)||[],r=1;r<t.length;r++)e=ai(t,r).join(""),t=e.match(xo)||[];return e}}function wd(e){for(var t={"%FE%FF":"\uFFFD\uFFFD","%FF%FE":"\uFFFD\uFFFD"},r=Oo.exec(e);r;){try{t[r[0]]=decodeURIComponent(r[0])}catch{var n=bd(r[0]);n!==r[0]&&(t[r[0]]=n)}r=Oo.exec(e)}t["%C2"]="\uFFFD";for(var i=Object.keys(t),s=0;s<i.length;s++){var a=i[s];e=e.replace(new RegExp(a,"g"),t[a])}return e}var vd=function(e){if(typeof e!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof e+"`");try{return e=e.replace(/\+/g," "),decodeURIComponent(e)}catch{return wd(e)}},md=(e,t)=>{if(!(typeof e=="string"&&typeof t=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(t==="")return[e];const r=e.indexOf(t);return r===-1?[e]:[e.slice(0,r),e.slice(r+t.length)]},Ed=function(e,t){for(var r={},n=Object.keys(e),i=Array.isArray(t),s=0;s<n.length;s++){var a=n[s],c=e[a];(i?t.indexOf(a)!==-1:t(a,c,e))&&(r[a]=c)}return r};(function(e){const t=yd,r=vd,n=md,i=Ed,s=E=>E==null,a=Symbol("encodeFragmentIdentifier");function c(E){switch(E.arrayFormat){case"index":return O=>(g,v)=>{const w=g.length;return v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,[h(O,E),"[",w,"]"].join("")]:[...g,[h(O,E),"[",h(w,E),"]=",h(v,E)].join("")]};case"bracket":return O=>(g,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,[h(O,E),"[]"].join("")]:[...g,[h(O,E),"[]=",h(v,E)].join("")];case"colon-list-separator":return O=>(g,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,[h(O,E),":list="].join("")]:[...g,[h(O,E),":list=",h(v,E)].join("")];case"comma":case"separator":case"bracket-separator":{const O=E.arrayFormat==="bracket-separator"?"[]=":"=";return g=>(v,w)=>w===void 0||E.skipNull&&w===null||E.skipEmptyString&&w===""?v:(w=w===null?"":w,v.length===0?[[h(g,E),O,h(w,E)].join("")]:[[v,h(w,E)].join(E.arrayFormatSeparator)])}default:return O=>(g,v)=>v===void 0||E.skipNull&&v===null||E.skipEmptyString&&v===""?g:v===null?[...g,h(O,E)]:[...g,[h(O,E),"=",h(v,E)].join("")]}}function l(E){let O;switch(E.arrayFormat){case"index":return(g,v,w)=>{if(O=/\[(\d*)\]$/.exec(g),g=g.replace(/\[\d*\]$/,""),!O){w[g]=v;return}w[g]===void 0&&(w[g]={}),w[g][O[1]]=v};case"bracket":return(g,v,w)=>{if(O=/(\[\])$/.exec(g),g=g.replace(/\[\]$/,""),!O){w[g]=v;return}if(w[g]===void 0){w[g]=[v];return}w[g]=[].concat(w[g],v)};case"colon-list-separator":return(g,v,w)=>{if(O=/(:list)$/.exec(g),g=g.replace(/:list$/,""),!O){w[g]=v;return}if(w[g]===void 0){w[g]=[v];return}w[g]=[].concat(w[g],v)};case"comma":case"separator":return(g,v,w)=>{const o=typeof v=="string"&&v.includes(E.arrayFormatSeparator),p=typeof v=="string"&&!o&&m(v,E).includes(E.arrayFormatSeparator);v=p?m(v,E):v;const L=o||p?v.split(E.arrayFormatSeparator).map(z=>m(z,E)):v===null?v:m(v,E);w[g]=L};case"bracket-separator":return(g,v,w)=>{const o=/(\[\])$/.test(g);if(g=g.replace(/\[\]$/,""),!o){w[g]=v&&m(v,E);return}const p=v===null?[]:v.split(E.arrayFormatSeparator).map(L=>m(L,E));if(w[g]===void 0){w[g]=p;return}w[g]=[].concat(w[g],p)};default:return(g,v,w)=>{if(w[g]===void 0){w[g]=v;return}w[g]=[].concat(w[g],v)}}}function f(E){if(typeof E!="string"||E.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function h(E,O){return O.encode?O.strict?t(E):encodeURIComponent(E):E}function m(E,O){return O.decode?r(E):E}function b(E){return Array.isArray(E)?E.sort():typeof E=="object"?b(Object.keys(E)).sort((O,g)=>Number(O)-Number(g)).map(O=>E[O]):E}function y(E){const O=E.indexOf("#");return O!==-1&&(E=E.slice(0,O)),E}function D(E){let O="";const g=E.indexOf("#");return g!==-1&&(O=E.slice(g)),O}function R(E){E=y(E);const O=E.indexOf("?");return O===-1?"":E.slice(O+1)}function P(E,O){return O.parseNumbers&&!Number.isNaN(Number(E))&&typeof E=="string"&&E.trim()!==""?E=Number(E):O.parseBooleans&&E!==null&&(E.toLowerCase()==="true"||E.toLowerCase()==="false")&&(E=E.toLowerCase()==="true"),E}function j(E,O){O=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},O),f(O.arrayFormatSeparator);const g=l(O),v=Object.create(null);if(typeof E!="string"||(E=E.trim().replace(/^[?#&]/,""),!E))return v;for(const w of E.split("&")){if(w==="")continue;let[o,p]=n(O.decode?w.replace(/\+/g," "):w,"=");p=p===void 0?null:["comma","separator","bracket-separator"].includes(O.arrayFormat)?p:m(p,O),g(m(o,O),p,v)}for(const w of Object.keys(v)){const o=v[w];if(typeof o=="object"&&o!==null)for(const p of Object.keys(o))o[p]=P(o[p],O);else v[w]=P(o,O)}return O.sort===!1?v:(O.sort===!0?Object.keys(v).sort():Object.keys(v).sort(O.sort)).reduce((w,o)=>{const p=v[o];return Boolean(p)&&typeof p=="object"&&!Array.isArray(p)?w[o]=b(p):w[o]=p,w},Object.create(null))}e.extract=R,e.parse=j,e.stringify=(E,O)=>{if(!E)return"";O=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},O),f(O.arrayFormatSeparator);const g=p=>O.skipNull&&s(E[p])||O.skipEmptyString&&E[p]==="",v=c(O),w={};for(const p of Object.keys(E))g(p)||(w[p]=E[p]);const o=Object.keys(w);return O.sort!==!1&&o.sort(O.sort),o.map(p=>{const L=E[p];return L===void 0?"":L===null?h(p,O):Array.isArray(L)?L.length===0&&O.arrayFormat==="bracket-separator"?h(p,O)+"[]":L.reduce(v(p),[]).join("&"):h(p,O)+"="+h(L,O)}).filter(p=>p.length>0).join("&")},e.parseUrl=(E,O)=>{O=Object.assign({decode:!0},O);const[g,v]=n(E,"#");return Object.assign({url:g.split("?")[0]||"",query:j(R(E),O)},O&&O.parseFragmentIdentifier&&v?{fragmentIdentifier:m(v,O)}:{})},e.stringifyUrl=(E,O)=>{O=Object.assign({encode:!0,strict:!0,[a]:!0},O);const g=y(E.url).split("?")[0]||"",v=e.extract(E.url),w=e.parse(v,{sort:!1}),o=Object.assign(w,E.query);let p=e.stringify(o,O);p&&(p=`?${p}`);let L=D(E.url);return E.fragmentIdentifier&&(L=`#${O[a]?h(E.fragmentIdentifier,O):E.fragmentIdentifier}`),`${g}${p}${L}`},e.pick=(E,O,g)=>{g=Object.assign({parseFragmentIdentifier:!0,[a]:!1},g);const{url:v,query:w,fragmentIdentifier:o}=e.parseUrl(E,g);return e.stringifyUrl({url:v,query:i(w,O),fragmentIdentifier:o},g)},e.exclude=(E,O,g)=>{const v=Array.isArray(O)?w=>!O.includes(w):(w,o)=>!O(w,o);return e.pick(E,v,g)}})(Tr);const Dd={waku:{publish:"waku_publish",subscribe:"waku_subscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe"},irn:{publish:"irn_publish",subscribe:"irn_subscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe"},iridium:{publish:"iridium_publish",subscribe:"iridium_subscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe"}};function ci(e,t){return e.includes(":")?[e]:t.chains||[]}const Io="base10",ht="base16",ui="base64pad",fi="utf8",To=0,Xt=1,Sd=0,No=1,li=12,hi=32;function xd(){const e=ii.generateKeyPair();return{privateKey:ft(e.secretKey,ht),publicKey:ft(e.publicKey,ht)}}function di(){const e=ar.randomBytes(hi);return ft(e,ht)}function Od(e,t){const r=ii.sharedKey(lt(e,ht),lt(t,ht)),n=new Gh(nn.SHA256,r).expand(hi);return ft(n,ht)}function Id(e){const t=nn.hash(lt(e,ht));return ft(t,ht)}function sn(e){const t=nn.hash(lt(e,fi));return ft(t,ht)}function Td(e){return lt(`${e}`,Io)}function Nr(e){return Number(ft(e,Io))}function Nd(e){const t=Td(typeof e.type<"u"?e.type:To);if(Nr(t)===Xt&&typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof e.senderPublicKey<"u"?lt(e.senderPublicKey,ht):void 0,n=typeof e.iv<"u"?lt(e.iv,ht):ar.randomBytes(li),i=new ti.ChaCha20Poly1305(lt(e.symKey,ht)).seal(n,lt(e.message,fi));return Rd({type:t,sealed:i,iv:n,senderPublicKey:r})}function Ad(e){const t=new ti.ChaCha20Poly1305(lt(e.symKey,ht)),{sealed:r,iv:n}=pi(e.encoded),i=t.open(n,r);if(i===null)throw new Error("Failed to decrypt");return ft(i,fi)}function Rd(e){if(Nr(e.type)===Xt){if(typeof e.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return ft(Jn([e.type,e.senderPublicKey,e.iv,e.sealed]),ui)}return ft(Jn([e.type,e.iv,e.sealed]),ui)}function pi(e){const t=lt(e,ui),r=t.slice(Sd,No),n=No;if(Nr(r)===Xt){const c=n+hi,l=c+li,f=t.slice(n,c),h=t.slice(c,l),m=t.slice(l);return{type:r,sealed:m,iv:h,senderPublicKey:f}}const i=n+li,s=t.slice(n,i),a=t.slice(i);return{type:r,sealed:a,iv:s}}function Pd(e,t){const r=pi(e);return Ao({type:Nr(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?ft(r.senderPublicKey,ht):void 0,receiverPublicKey:t?.receiverPublicKey})}function Ao(e){const t=e?.type||To;if(t===Xt){if(typeof e?.senderPublicKey>"u")throw new Error("missing sender public key");if(typeof e?.receiverPublicKey>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:e?.senderPublicKey,receiverPublicKey:e?.receiverPublicKey}}function Ro(e){return e.type===Xt&&typeof e.senderPublicKey=="string"&&typeof e.receiverPublicKey=="string"}var Cd=Object.defineProperty,Po=Object.getOwnPropertySymbols,Fd=Object.prototype.hasOwnProperty,Ld=Object.prototype.propertyIsEnumerable,Co=(e,t,r)=>t in e?Cd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Fo=(e,t)=>{for(var r in t||(t={}))Fd.call(t,r)&&Co(e,r,t[r]);if(Po)for(var r of Po(t))Ld.call(t,r)&&Co(e,r,t[r]);return e};const Ud="ReactNative",Ar={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},$d="js";function Lo(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function Md(){return!vo()&&!!si()&&navigator.product===Ud}function jd(){return!Lo()&&!!si()}function zd(){return Md()?Ar.reactNative:Lo()?Ar.node:jd()?Ar.browser:Ar.unknown}function Bd(e,t){let r=Tr.parse(e);return r=Fo(Fo({},r),t),e=Tr.stringify(r),e}function qd(){return Eo()||{name:"",description:"",url:"",icons:[""]}}function Kd(){const e=td();if(e===null)return"unknown";const t=e.os?e.os.replace(" ","").toLowerCase():"unknown";return e.type==="browser"?[t,e.name,e.version].join("-"):[t,e.version].join("-")}function Hd(){var e;const t=zd();return t===Ar.browser?[t,((e=mo())==null?void 0:e.host)||"unknown"].join(":"):t}function Vd(e,t,r){const n=Kd(),i=Hd();return[[e,t].join("-"),[$d,r].join("-"),n,i].join("/")}function Gd({protocol:e,version:t,relayUrl:r,sdkVersion:n,auth:i,projectId:s}){const a=r.split("?"),c=Vd(e,t,n),l={auth:i,ua:c,projectId:s},f=Bd(a[1]||"",l);return a[0]+"?"+f}function Ut(e,t){return e.filter(r=>t.includes(r)).length===e.length}function Uo(e){return Object.fromEntries(e.entries())}function $o(e){return new Map(Object.entries(e))}function Jt(e){const t=Z.toMiliseconds(e||Z.FIVE_MINUTES);let r,n,i;return{resolve:s=>{i&&r&&(clearTimeout(i),r(s))},reject:s=>{i&&n&&(clearTimeout(i),n(s))},done:()=>new Promise((s,a)=>{i=setTimeout(a,t),r=s,n=a})}}function Mo(e,t){return new Promise(async(r,n)=>{const i=setTimeout(()=>n(),t),s=await e;clearTimeout(i),r(s)})}function jo(e,t){if(typeof t=="string"&&t.startsWith(`${e}:`))return t;if(e.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(e.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${e}`)}function Wd(e){return jo("topic",e)}function Yd(e){return jo("id",e)}function zo(e){const[t,r]=e.split(":"),n={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")n.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return n}function Ot(e,t){return Z.fromMiliseconds((t||Date.now())+Z.toMiliseconds(e))}function $t(e){return Date.now()>=Z.toMiliseconds(e)}function Le(e,t){return`${e}${t?`:${t}`:""}`}const kd="irn";function gi(e){return e?.relay||{protocol:kd}}function _i(e){const t=Dd[e];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${e}`);return t}var Xd=Object.defineProperty,Bo=Object.getOwnPropertySymbols,Jd=Object.prototype.hasOwnProperty,Zd=Object.prototype.propertyIsEnumerable,qo=(e,t,r)=>t in e?Xd(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Qd=(e,t)=>{for(var r in t||(t={}))Jd.call(t,r)&&qo(e,r,t[r]);if(Bo)for(var r of Bo(t))Zd.call(t,r)&&qo(e,r,t[r]);return e};function ep(e,t="-"){const r={},n="relay"+t;return Object.keys(e).forEach(i=>{if(i.startsWith(n)){const s=i.replace(n,""),a=e[i];r[s]=a}}),r}function tp(e){const t=e.indexOf(":"),r=e.indexOf("?")!==-1?e.indexOf("?"):void 0,n=e.substring(0,t),i=e.substring(t+1,r).split("@"),s=typeof r<"u"?e.substring(r):"",a=Tr.parse(s);return{protocol:n,topic:i[0],version:parseInt(i[1],10),symKey:a.symKey,relay:ep(a)}}function rp(e,t="-"){const r="relay",n={};return Object.keys(e).forEach(i=>{const s=r+t+i;e[i]&&(n[s]=e[i])}),n}function np(e){return`${e.protocol}:${e.topic}@${e.version}?`+Tr.stringify(Qd({symKey:e.symKey},rp(e.relay)))}function Rr(e){const t=[];return e.forEach(r=>{const[n,i]=r.split(":");t.push(`${n}:${i}`)}),t}function ip(e){const t=[];return Object.values(e).forEach(r=>{t.push(...Rr(r.accounts))}),t}function sp(e,t){const r=[];return Object.values(e).forEach(n=>{Rr(n.accounts).includes(t)&&r.push(...n.methods)}),r}function op(e,t){const r=[];return Object.values(e).forEach(n=>{Rr(n.accounts).includes(t)&&r.push(...n.events)}),r}function ap(e,t){const r=an(e,t);if(r)throw new Error(r.message);const n={};for(const[i,s]of Object.entries(e))n[i]={methods:s.methods,events:s.events,chains:s.accounts.map(a=>`${a.split(":")[0]}:${a.split(":")[1]}`)};return n}const cp={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},up={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function H(e,t){const{message:r,code:n}=up[e];return{message:t?`${r} ${t}`:r,code:n}}function Ke(e,t){const{message:r,code:n}=cp[e];return{message:t?`${r} ${t}`:r,code:n}}function on(e,t){return Array.isArray(e)?typeof t<"u"&&e.length?e.every(t):!0:!1}function Pr(e){return Object.getPrototypeOf(e)===Object.prototype&&Object.keys(e).length}function at(e){return typeof e>"u"}function He(e,t){return t&&at(e)?!0:typeof e=="string"&&Boolean(e.trim().length)}function yi(e,t){return t&&at(e)?!0:typeof e=="number"&&!isNaN(e)}function fp(e,t){const{requiredNamespaces:r}=t,n=Object.keys(e.namespaces),i=Object.keys(r);let s=!0;return Ut(i,n)?(n.forEach(a=>{const{accounts:c,methods:l,events:f}=e.namespaces[a],h=Rr(c),m=r[a];(!Ut(ci(a,m),h)||!Ut(m.methods,l)||!Ut(m.events,f))&&(s=!1)}),s):!1}function bi(e){return He(e,!1)&&e.includes(":")?e.split(":").length===2:!1}function lp(e){if(He(e,!1)&&e.includes(":")){const t=e.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&bi(r)}}return!1}function hp(e){if(He(e,!1))try{return typeof new URL(e)<"u"}catch{return!1}return!1}function dp(e){var t;return(t=e?.proposer)==null?void 0:t.publicKey}function pp(e){return e?.topic}function gp(e,t){let r=null;return He(e?.publicKey,!1)||(r=H("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function Ko(e){let t=!0;return on(e)?e.length&&(t=e.every(r=>He(r,!1))):t=!1,t}function _p(e,t,r){let n=null;return on(t)?t.forEach(i=>{n||(!bi(i)||!i.includes(e))&&(n=Ke("UNSUPPORTED_CHAINS",`${r}, chain ${i} should be a string and conform to "namespace:chainId" format`))}):n=Ke("UNSUPPORTED_CHAINS",`${r}, chains ${t} should be an array of strings conforming to "namespace:chainId" format`),n}function yp(e,t){let r=null;return Object.entries(e).forEach(([n,i])=>{if(r)return;const s=_p(n,ci(n,i),`${t} requiredNamespace`);s&&(r=s)}),r}function bp(e,t){let r=null;return on(e)?e.forEach(n=>{r||lp(n)||(r=Ke("UNSUPPORTED_ACCOUNTS",`${t}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=Ke("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function wp(e,t){let r=null;return Object.values(e).forEach(n=>{if(r)return;const i=bp(n?.accounts,`${t} namespace`);i&&(r=i)}),r}function vp(e,t){let r=null;return Ko(e?.methods)?Ko(e?.events)||(r=Ke("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=Ke("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function Ho(e,t){let r=null;return Object.values(e).forEach(n=>{if(r)return;const i=vp(n,`${t}, namespace`);i&&(r=i)}),r}function mp(e,t,r){let n=null;if(e&&Pr(e)){const i=Ho(e,t);i&&(n=i);const s=yp(e,t);s&&(n=s)}else n=H("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return n}function an(e,t){let r=null;if(e&&Pr(e)){const n=Ho(e,t);n&&(r=n);const i=wp(e,t);i&&(r=i)}else r=H("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Vo(e){return He(e.protocol,!0)}function Ep(e,t){let r=!1;return t&&!e?r=!0:e&&on(e)&&e.length&&e.forEach(n=>{r=Vo(n)}),r}function Dp(e){return typeof e=="number"}function dt(e){return typeof e<"u"&&typeof e!==null}function Sp(e){return!(!e||typeof e!="object"||!e.code||!yi(e.code,!1)||!e.message||!He(e.message,!1))}function xp(e){return!(at(e)||!He(e.method,!1))}function Op(e){return!(at(e)||at(e.result)&&at(e.error)||!yi(e.id,!1)||!He(e.jsonrpc,!1))}function Ip(e){return!(at(e)||!He(e.name,!1))}function Go(e,t){return!(!bi(t)||!ip(e).includes(t))}function Tp(e,t,r){return He(r,!1)?sp(e,t).includes(r):!1}function Np(e,t,r){return He(r,!1)?op(e,t).includes(r):!1}function wi(e,t,r,n){let i=null;const s=Object.keys(e),a=Object.keys(t);return Ut(s,a)?s.forEach(c=>{if(i)return;const l=Rr(t[c].accounts);Ut(ci(c,e[c]),l)?Ut(e[c].methods,t[c].methods)?Ut(e[c].events,t[c].events)||(i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${c}`)):i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${c}`):i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace chains for ${c}`)}):i=H("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy ${n}`),i}function Ap(e,t){return yi(e,!1)&&e<=t.max&&e>=t.min}const Rp="PARSE_ERROR",Pp="INVALID_REQUEST",Cp="METHOD_NOT_FOUND",Fp="INVALID_PARAMS",Wo="INTERNAL_ERROR",vi="SERVER_ERROR",Lp=[-32700,-32600,-32601,-32602,-32603],Cr={[Rp]:{code:-32700,message:"Parse error"},[Pp]:{code:-32600,message:"Invalid Request"},[Cp]:{code:-32601,message:"Method not found"},[Fp]:{code:-32602,message:"Invalid params"},[Wo]:{code:-32603,message:"Internal error"},[vi]:{code:-32e3,message:"Server error"}},Yo=vi;function Up(e){return Lp.includes(e)}function ko(e){return Object.keys(Cr).includes(e)?Cr[e]:Cr[Yo]}function $p(e){const t=Object.values(Cr).find(r=>r.code===e);return t||Cr[Yo]}function Mp(e,t,r){return e.message.includes("getaddrinfo ENOTFOUND")||e.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${r} RPC url at ${t}`):e}var Xo={};/*! *****************************************************************************
	Copyright (c) Microsoft Corporation.

	Permission to use, copy, modify, and/or distribute this software for any
	purpose with or without fee is hereby granted.

	THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
	REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
	AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
	INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
	LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
	OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
	PERFORMANCE OF THIS SOFTWARE.
	***************************************************************************** */var mi=function(e,t){return mi=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)n.hasOwnProperty(i)&&(r[i]=n[i])},mi(e,t)};function jp(e,t){mi(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Ei=function(){return Ei=Object.assign||function(t){for(var r,n=1,i=arguments.length;n<i;n++){r=arguments[n];for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])}return t},Ei.apply(this,arguments)};function zp(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(e);i<n.length;i++)t.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(r[n[i]]=e[n[i]]);return r}function Bp(e,t,r,n){var i=arguments.length,s=i<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,a;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(s=(i<3?a(s):i>3?a(t,r,s):a(t,r))||s);return i>3&&s&&Object.defineProperty(t,r,s),s}function qp(e,t){return function(r,n){t(r,n,e)}}function Kp(e,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(e,t)}function Hp(e,t,r,n){function i(s){return s instanceof r?s:new r(function(a){a(s)})}return new(r||(r=Promise))(function(s,a){function c(h){try{f(n.next(h))}catch(m){a(m)}}function l(h){try{f(n.throw(h))}catch(m){a(m)}}function f(h){h.done?s(h.value):i(h.value).then(c,l)}f((n=n.apply(e,t||[])).next())})}function Vp(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},n,i,s,a;return a={next:c(0),throw:c(1),return:c(2)},typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function c(f){return function(h){return l([f,h])}}function l(f){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,i&&(s=f[0]&2?i.return:f[0]?i.throw||((s=i.return)&&s.call(i),0):i.next)&&!(s=s.call(i,f[1])).done)return s;switch(i=0,s&&(f=[f[0]&2,s.value]),f[0]){case 0:case 1:s=f;break;case 4:return r.label++,{value:f[1],done:!1};case 5:r.label++,i=f[1],f=[0];continue;case 7:f=r.ops.pop(),r.trys.pop();continue;default:if(s=r.trys,!(s=s.length>0&&s[s.length-1])&&(f[0]===6||f[0]===2)){r=0;continue}if(f[0]===3&&(!s||f[1]>s[0]&&f[1]<s[3])){r.label=f[1];break}if(f[0]===6&&r.label<s[1]){r.label=s[1],s=f;break}if(s&&r.label<s[2]){r.label=s[2],r.ops.push(f);break}s[2]&&r.ops.pop(),r.trys.pop();continue}f=t.call(e,r)}catch(h){f=[6,h],i=0}finally{n=s=0}if(f[0]&5)throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}}function Gp(e,t,r,n){n===void 0&&(n=r),e[n]=t[r]}function Wp(e,t){for(var r in e)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=e[r])}function Di(e){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jo(e,t){var r=typeof Symbol=="function"&&e[Symbol.iterator];if(!r)return e;var n=r.call(e),i,s=[],a;try{for(;(t===void 0||t-- >0)&&!(i=n.next()).done;)s.push(i.value)}catch(c){a={error:c}}finally{try{i&&!i.done&&(r=n.return)&&r.call(n)}finally{if(a)throw a.error}}return s}function Yp(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(Jo(arguments[t]));return e}function kp(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;for(var n=Array(e),i=0,t=0;t<r;t++)for(var s=arguments[t],a=0,c=s.length;a<c;a++,i++)n[i]=s[a];return n}function Fr(e){return this instanceof Fr?(this.v=e,this):new Fr(e)}function Xp(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(e,t||[]),i,s=[];return i={},a("next"),a("throw"),a("return"),i[Symbol.asyncIterator]=function(){return this},i;function a(b){n[b]&&(i[b]=function(y){return new Promise(function(D,R){s.push([b,y,D,R])>1||c(b,y)})})}function c(b,y){try{l(n[b](y))}catch(D){m(s[0][3],D)}}function l(b){b.value instanceof Fr?Promise.resolve(b.value.v).then(f,h):m(s[0][2],b)}function f(b){c("next",b)}function h(b){c("throw",b)}function m(b,y){b(y),s.shift(),s.length&&c(s[0][0],s[0][1])}}function Jp(e){var t,r;return t={},n("next"),n("throw",function(i){throw i}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(i,s){t[i]=e[i]?function(a){return(r=!r)?{value:Fr(e[i](a)),done:i==="return"}:s?s(a):a}:s}}function Zp(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],r;return t?t.call(e):(e=typeof Di=="function"?Di(e):e[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(s){r[s]=e[s]&&function(a){return new Promise(function(c,l){a=e[s](a),i(c,l,a.done,a.value)})}}function i(s,a,c,l){Promise.resolve(l).then(function(f){s({value:f,done:c})},a)}}function Qp(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}function eg(e){if(e&&e.__esModule)return e;var t={};if(e!=null)for(var r in e)Object.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t.default=e,t}function tg(e){return e&&e.__esModule?e:{default:e}}function rg(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)}function ng(e,t,r){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,r),r}var ig=Object.freeze({__proto__:null,__extends:jp,get __assign(){return Ei},__rest:zp,__decorate:Bp,__param:qp,__metadata:Kp,__awaiter:Hp,__generator:Vp,__createBinding:Gp,__exportStar:Wp,__values:Di,__read:Jo,__spread:Yp,__spreadArrays:kp,__await:Fr,__asyncGenerator:Xp,__asyncDelegator:Jp,__asyncValues:Zp,__makeTemplateObject:Qp,__importStar:eg,__importDefault:tg,__classPrivateFieldGet:rg,__classPrivateFieldSet:ng}),sg=Kt(ig),At={},Zo;function og(){if(Zo)return At;Zo=1,Object.defineProperty(At,"__esModule",{value:!0}),At.isBrowserCryptoAvailable=At.getSubtleCrypto=At.getBrowerCrypto=void 0;function e(){return Qe?.crypto||Qe?.msCrypto||{}}At.getBrowerCrypto=e;function t(){const n=e();return n.subtle||n.webkitSubtle}At.getSubtleCrypto=t;function r(){return!!e()&&!!t()}return At.isBrowserCryptoAvailable=r,At}var Rt={},Qo;function ag(){if(Qo)return Rt;Qo=1,Object.defineProperty(Rt,"__esModule",{value:!0}),Rt.isBrowser=Rt.isNode=Rt.isReactNative=void 0;function e(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}Rt.isReactNative=e;function t(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}Rt.isNode=t;function r(){return!e()&&!t()}return Rt.isBrowser=r,Rt}(function(e){Object.defineProperty(e,"__esModule",{value:!0});const t=sg;t.__exportStar(og(),e),t.__exportStar(ag(),e)})(Xo);function cg(){const e=Date.now()*Math.pow(10,3),t=Math.floor(Math.random()*Math.pow(10,3));return e+t}function cn(e,t,r){return{id:r||cg(),jsonrpc:"2.0",method:e,params:t}}function Si(e,t){return{id:e,jsonrpc:"2.0",result:t}}function xi(e,t,r){return{id:e,jsonrpc:"2.0",error:ug(t,r)}}function ug(e,t){return typeof e>"u"?ko(Wo):(typeof e=="string"&&(e=Object.assign(Object.assign({},ko(vi)),{message:e})),typeof t<"u"&&(e.data=t),Up(e.code)&&(e=$p(e.code)),e)}class fg{}class lg extends fg{constructor(){super()}}class hg extends lg{constructor(t){super()}}const dg="^wss?:";function pg(e){const t=e.match(new RegExp(/^\w+:/,"gi"));if(!(!t||!t.length))return t[0]}function gg(e,t){const r=pg(e);return typeof r>"u"?!1:new RegExp(t).test(r)}function ea(e){return gg(e,dg)}function _g(e){return new RegExp("wss?://localhost(:d{2,5})?").test(e)}function ta(e){return typeof e=="object"&&"id"in e&&"jsonrpc"in e&&e.jsonrpc==="2.0"}function Oi(e){return ta(e)&&"method"in e}function Ii(e){return ta(e)&&(Pt(e)||mt(e))}function Pt(e){return"result"in e}function mt(e){return"error"in e}class yg extends hg{constructor(t){super(t),this.events=new ut.exports.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(t),this.connection.connected&&this.registerEventListeners()}async connect(t=this.connection){await this.open(t)}async disconnect(){await this.close()}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async request(t,r){return this.requestStrict(cn(t.method,t.params||[]),r)}async requestStrict(t,r){return new Promise(async(n,i)=>{if(!this.connection.connected)try{await this.open()}catch(s){i(s)}this.events.on(`${t.id}`,s=>{mt(s)?i(s.error):n(s.result)});try{await this.connection.send(t,r)}catch(s){i(s)}})}setConnection(t=this.connection){return t}onPayload(t){this.events.emit("payload",t),Ii(t)?this.events.emit(`${t.id}`,t):this.events.emit("message",{type:t.method,data:t.params})}async open(t=this.connection){this.connection===t&&this.connection.connected||(this.connection.connected&&this.close(),typeof t=="string"&&(await this.connection.open(t),t=this.connection),this.connection=this.setConnection(t),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",t=>this.onPayload(t)),this.connection.on("close",()=>this.events.emit("disconnect")),this.connection.on("error",t=>this.events.emit("error",t)),this.hasRegisteredEventListeners=!0)}}const ra=10,bg=()=>typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:require("ws"),wg=()=>typeof window<"u",vg=bg();class mg{constructor(t){if(this.url=t,this.events=new ut.exports.EventEmitter,this.registering=!1,!ea(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=()=>{this.onClose(),t()},this.socket.close()})}async send(t,r){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Vn(t))}catch(n){this.onError(t.id,n)}}register(t=this.url){if(!ea(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,i)=>{this.events.once("register_error",s=>{this.resetMaxListeners(),i(s)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return i(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const i=Xo.isReactNative()?void 0:{rejectUnauthorized:!_g(t)},s=new vg(t,[],i);wg()?s.onerror=a=>{const c=a;n(this.emitError(c.error))}:s.on("error",a=>{n(this.emitError(a))}),s.onopen=()=>{this.onOpen(s),r(s)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=()=>this.onClose(),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(){this.socket=void 0,this.registering=!1,this.events.emit("close")}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?As(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),i=n.message||n.toString(),s=xi(t,i);this.events.emit("payload",s)}parseError(t,r=this.url){return Mp(t,r,"WS")}resetMaxListeners(){this.events.getMaxListeners()>ra&&this.events.setMaxListeners(ra)}emitError(t){const r=this.parseError(new Error(t?.message||`WebSocket connection failed for URL: ${this.url}`));return this.events.emit("register_error",r),r}}var Ti={exports:{}};(function(e,t){var r=200,n="__lodash_hash_undefined__",i=1,s=2,a=9007199254740991,c="[object Arguments]",l="[object Array]",f="[object AsyncFunction]",h="[object Boolean]",m="[object Date]",b="[object Error]",y="[object Function]",D="[object GeneratorFunction]",R="[object Map]",P="[object Number]",j="[object Null]",E="[object Object]",O="[object Promise]",g="[object Proxy]",v="[object RegExp]",w="[object Set]",o="[object String]",p="[object Symbol]",L="[object Undefined]",z="[object WeakMap]",k="[object ArrayBuffer]",X="[object DataView]",J="[object Float32Array]",A="[object Float64Array]",N="[object Int8Array]",W="[object Int16Array]",M="[object Int32Array]",F="[object Uint8Array]",U="[object Uint8ClampedArray]",$="[object Uint16Array]",B="[object Uint32Array]",ne=/[\\^$.*+?()[\]{}|]/g,q=/^\[object .+?Constructor\]$/,Q=/^(?:0|[1-9]\d*)$/,Y={};Y[J]=Y[A]=Y[N]=Y[W]=Y[M]=Y[F]=Y[U]=Y[$]=Y[B]=!0,Y[c]=Y[l]=Y[k]=Y[h]=Y[X]=Y[m]=Y[b]=Y[y]=Y[R]=Y[P]=Y[E]=Y[v]=Y[w]=Y[o]=Y[z]=!1;var ae=typeof Qe=="object"&&Qe&&Qe.Object===Object&&Qe,T=typeof self=="object"&&self&&self.Object===Object&&self,I=ae||T||Function("return this")(),S=t&&!t.nodeType&&t,u=S&&!0&&e&&!e.nodeType&&e,_=u&&u.exports===S,K=_&&ae.process,V=function(){try{return K&&K.binding&&K.binding("util")}catch{}}(),le=V&&V.isTypedArray;function ye(d,x){for(var C=-1,G=d==null?0:d.length,Te=0,ie=[];++C<G;){var Fe=d[C];x(Fe,C,d)&&(ie[Te++]=Fe)}return ie}function de(d,x){for(var C=-1,G=x.length,Te=d.length;++C<G;)d[Te+C]=x[C];return d}function ve(d,x){for(var C=-1,G=d==null?0:d.length;++C<G;)if(x(d[C],C,d))return!0;return!1}function Ue(d,x){for(var C=-1,G=Array(d);++C<d;)G[C]=x(C);return G}function Re(d){return function(x){return d(x)}}function _e(d,x){return d.has(x)}function pe(d,x){return d?.[x]}function he(d){var x=-1,C=Array(d.size);return d.forEach(function(G,Te){C[++x]=[Te,G]}),C}function ue(d,x){return function(C){return d(x(C))}}function ce(d){var x=-1,C=Array(d.size);return d.forEach(function(G){C[++x]=G}),C}var oe=Array.prototype,se=Function.prototype,ee=Object.prototype,fe=I["__core-js_shared__"],ge=se.toString,re=ee.hasOwnProperty,be=function(){var d=/[^.]+$/.exec(fe&&fe.keys&&fe.keys.IE_PROTO||"");return d?"Symbol(src)_1."+d:""}(),we=ee.toString,Ee=RegExp("^"+ge.call(re).replace(ne,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),De=_?I.Buffer:void 0,me=I.Symbol,Et=I.Uint8Array,Nt=ee.propertyIsEnumerable,jt=oe.splice,gt=me?me.toStringTag:void 0,Zt=Object.getOwnPropertySymbols,Mr=De?De.isBuffer:void 0,yn=ue(Object.keys,Object),$e=fr(I,"DataView"),Pe=fr(I,"Map"),Me=fr(I,"Promise"),je=fr(I,"Set"),ze=fr(I,"WeakMap"),Ce=fr(Object,"create"),Ve=er($e),Ge=er(Pe),We=er(Me),Ye=er(je),ke=er(ze),qe=me?me.prototype:void 0,Be=qe?qe.valueOf:void 0;function Ne(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function Xe(){this.__data__=Ce?Ce(null):{},this.size=0}function Je(d){var x=this.has(d)&&delete this.__data__[d];return this.size-=x?1:0,x}function ay(d){var x=this.__data__;if(Ce){var C=x[d];return C===n?void 0:C}return re.call(x,d)?x[d]:void 0}function cy(d){var x=this.__data__;return Ce?x[d]!==void 0:re.call(x,d)}function uy(d,x){var C=this.__data__;return this.size+=this.has(d)?0:1,C[d]=Ce&&x===void 0?n:x,this}Ne.prototype.clear=Xe,Ne.prototype.delete=Je,Ne.prototype.get=ay,Ne.prototype.has=cy,Ne.prototype.set=uy;function Ct(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function fy(){this.__data__=[],this.size=0}function ly(d){var x=this.__data__,C=wn(x,d);if(C<0)return!1;var G=x.length-1;return C==G?x.pop():jt.call(x,C,1),--this.size,!0}function hy(d){var x=this.__data__,C=wn(x,d);return C<0?void 0:x[C][1]}function dy(d){return wn(this.__data__,d)>-1}function py(d,x){var C=this.__data__,G=wn(C,d);return G<0?(++this.size,C.push([d,x])):C[G][1]=x,this}Ct.prototype.clear=fy,Ct.prototype.delete=ly,Ct.prototype.get=hy,Ct.prototype.has=dy,Ct.prototype.set=py;function Qt(d){var x=-1,C=d==null?0:d.length;for(this.clear();++x<C;){var G=d[x];this.set(G[0],G[1])}}function gy(){this.size=0,this.__data__={hash:new Ne,map:new(Pe||Ct),string:new Ne}}function _y(d){var x=vn(this,d).delete(d);return this.size-=x?1:0,x}function yy(d){return vn(this,d).get(d)}function by(d){return vn(this,d).has(d)}function wy(d,x){var C=vn(this,d),G=C.size;return C.set(d,x),this.size+=C.size==G?0:1,this}Qt.prototype.clear=gy,Qt.prototype.delete=_y,Qt.prototype.get=yy,Qt.prototype.has=by,Qt.prototype.set=wy;function bn(d){var x=-1,C=d==null?0:d.length;for(this.__data__=new Qt;++x<C;)this.add(d[x])}function vy(d){return this.__data__.set(d,n),this}function my(d){return this.__data__.has(d)}bn.prototype.add=bn.prototype.push=vy,bn.prototype.has=my;function zt(d){var x=this.__data__=new Ct(d);this.size=x.size}function Ey(){this.__data__=new Ct,this.size=0}function Dy(d){var x=this.__data__,C=x.delete(d);return this.size=x.size,C}function Sy(d){return this.__data__.get(d)}function xy(d){return this.__data__.has(d)}function Oy(d,x){var C=this.__data__;if(C instanceof Ct){var G=C.__data__;if(!Pe||G.length<r-1)return G.push([d,x]),this.size=++C.size,this;C=this.__data__=new Qt(G)}return C.set(d,x),this.size=C.size,this}zt.prototype.clear=Ey,zt.prototype.delete=Dy,zt.prototype.get=Sy,zt.prototype.has=xy,zt.prototype.set=Oy;function Iy(d,x){var C=mn(d),G=!C&&qy(d),Te=!C&&!G&&ji(d),ie=!C&&!G&&!Te&&Xa(d),Fe=C||G||Te||ie,Ze=Fe?Ue(d.length,String):[],nt=Ze.length;for(var Ae in d)(x||re.call(d,Ae))&&!(Fe&&(Ae=="length"||Te&&(Ae=="offset"||Ae=="parent")||ie&&(Ae=="buffer"||Ae=="byteLength"||Ae=="byteOffset")||$y(Ae,nt)))&&Ze.push(Ae);return Ze}function wn(d,x){for(var C=d.length;C--;)if(Ga(d[C][0],x))return C;return-1}function Ty(d,x,C){var G=x(d);return mn(d)?G:de(G,C(d))}function jr(d){return d==null?d===void 0?L:j:gt&&gt in Object(d)?Ly(d):By(d)}function qa(d){return zr(d)&&jr(d)==c}function Ka(d,x,C,G,Te){return d===x?!0:d==null||x==null||!zr(d)&&!zr(x)?d!==d&&x!==x:Ny(d,x,C,G,Ka,Te)}function Ny(d,x,C,G,Te,ie){var Fe=mn(d),Ze=mn(x),nt=Fe?l:Bt(d),Ae=Ze?l:Bt(x);nt=nt==c?E:nt,Ae=Ae==c?E:Ae;var _t=nt==E,Dt=Ae==E,st=nt==Ae;if(st&&ji(d)){if(!ji(x))return!1;Fe=!0,_t=!1}if(st&&!_t)return ie||(ie=new zt),Fe||Xa(d)?Ha(d,x,C,G,Te,ie):Cy(d,x,nt,C,G,Te,ie);if(!(C&i)){var wt=_t&&re.call(d,"__wrapped__"),vt=Dt&&re.call(x,"__wrapped__");if(wt||vt){var qt=wt?d.value():d,Ft=vt?x.value():x;return ie||(ie=new zt),Te(qt,Ft,C,G,ie)}}return st?(ie||(ie=new zt),Fy(d,x,C,G,Te,ie)):!1}function Ay(d){if(!ka(d)||jy(d))return!1;var x=Wa(d)?Ee:q;return x.test(er(d))}function Ry(d){return zr(d)&&Ya(d.length)&&!!Y[jr(d)]}function Py(d){if(!zy(d))return yn(d);var x=[];for(var C in Object(d))re.call(d,C)&&C!="constructor"&&x.push(C);return x}function Ha(d,x,C,G,Te,ie){var Fe=C&i,Ze=d.length,nt=x.length;if(Ze!=nt&&!(Fe&&nt>Ze))return!1;var Ae=ie.get(d);if(Ae&&ie.get(x))return Ae==x;var _t=-1,Dt=!0,st=C&s?new bn:void 0;for(ie.set(d,x),ie.set(x,d);++_t<Ze;){var wt=d[_t],vt=x[_t];if(G)var qt=Fe?G(vt,wt,_t,x,d,ie):G(wt,vt,_t,d,x,ie);if(qt!==void 0){if(qt)continue;Dt=!1;break}if(st){if(!ve(x,function(Ft,tr){if(!_e(st,tr)&&(wt===Ft||Te(wt,Ft,C,G,ie)))return st.push(tr)})){Dt=!1;break}}else if(!(wt===vt||Te(wt,vt,C,G,ie))){Dt=!1;break}}return ie.delete(d),ie.delete(x),Dt}function Cy(d,x,C,G,Te,ie,Fe){switch(C){case X:if(d.byteLength!=x.byteLength||d.byteOffset!=x.byteOffset)return!1;d=d.buffer,x=x.buffer;case k:return!(d.byteLength!=x.byteLength||!ie(new Et(d),new Et(x)));case h:case m:case P:return Ga(+d,+x);case b:return d.name==x.name&&d.message==x.message;case v:case o:return d==x+"";case R:var Ze=he;case w:var nt=G&i;if(Ze||(Ze=ce),d.size!=x.size&&!nt)return!1;var Ae=Fe.get(d);if(Ae)return Ae==x;G|=s,Fe.set(d,x);var _t=Ha(Ze(d),Ze(x),G,Te,ie,Fe);return Fe.delete(d),_t;case p:if(Be)return Be.call(d)==Be.call(x)}return!1}function Fy(d,x,C,G,Te,ie){var Fe=C&i,Ze=Va(d),nt=Ze.length,Ae=Va(x),_t=Ae.length;if(nt!=_t&&!Fe)return!1;for(var Dt=nt;Dt--;){var st=Ze[Dt];if(!(Fe?st in x:re.call(x,st)))return!1}var wt=ie.get(d);if(wt&&ie.get(x))return wt==x;var vt=!0;ie.set(d,x),ie.set(x,d);for(var qt=Fe;++Dt<nt;){st=Ze[Dt];var Ft=d[st],tr=x[st];if(G)var Ja=Fe?G(tr,Ft,st,x,d,ie):G(Ft,tr,st,d,x,ie);if(!(Ja===void 0?Ft===tr||Te(Ft,tr,C,G,ie):Ja)){vt=!1;break}qt||(qt=st=="constructor")}if(vt&&!qt){var En=d.constructor,Dn=x.constructor;En!=Dn&&"constructor"in d&&"constructor"in x&&!(typeof En=="function"&&En instanceof En&&typeof Dn=="function"&&Dn instanceof Dn)&&(vt=!1)}return ie.delete(d),ie.delete(x),vt}function Va(d){return Ty(d,Vy,Uy)}function vn(d,x){var C=d.__data__;return My(x)?C[typeof x=="string"?"string":"hash"]:C.map}function fr(d,x){var C=pe(d,x);return Ay(C)?C:void 0}function Ly(d){var x=re.call(d,gt),C=d[gt];try{d[gt]=void 0;var G=!0}catch{}var Te=we.call(d);return G&&(x?d[gt]=C:delete d[gt]),Te}var Uy=Zt?function(d){return d==null?[]:(d=Object(d),ye(Zt(d),function(x){return Nt.call(d,x)}))}:Gy,Bt=jr;($e&&Bt(new $e(new ArrayBuffer(1)))!=X||Pe&&Bt(new Pe)!=R||Me&&Bt(Me.resolve())!=O||je&&Bt(new je)!=w||ze&&Bt(new ze)!=z)&&(Bt=function(d){var x=jr(d),C=x==E?d.constructor:void 0,G=C?er(C):"";if(G)switch(G){case Ve:return X;case Ge:return R;case We:return O;case Ye:return w;case ke:return z}return x});function $y(d,x){return x=x??a,!!x&&(typeof d=="number"||Q.test(d))&&d>-1&&d%1==0&&d<x}function My(d){var x=typeof d;return x=="string"||x=="number"||x=="symbol"||x=="boolean"?d!=="__proto__":d===null}function jy(d){return!!be&&be in d}function zy(d){var x=d&&d.constructor,C=typeof x=="function"&&x.prototype||ee;return d===C}function By(d){return we.call(d)}function er(d){if(d!=null){try{return ge.call(d)}catch{}try{return d+""}catch{}}return""}function Ga(d,x){return d===x||d!==d&&x!==x}var qy=qa(function(){return arguments}())?qa:function(d){return zr(d)&&re.call(d,"callee")&&!Nt.call(d,"callee")},mn=Array.isArray;function Ky(d){return d!=null&&Ya(d.length)&&!Wa(d)}var ji=Mr||Wy;function Hy(d,x){return Ka(d,x)}function Wa(d){if(!ka(d))return!1;var x=jr(d);return x==y||x==D||x==f||x==g}function Ya(d){return typeof d=="number"&&d>-1&&d%1==0&&d<=a}function ka(d){var x=typeof d;return d!=null&&(x=="object"||x=="function")}function zr(d){return d!=null&&typeof d=="object"}var Xa=le?Re(le):Ry;function Vy(d){return Ky(d)?Iy(d):Py(d)}function Gy(){return[]}function Wy(){return!1}e.exports=Hy})(Ti,Ti.exports);var Eg=Ti.exports,Dg=Object.defineProperty,na=Object.getOwnPropertySymbols,Sg=Object.prototype.hasOwnProperty,xg=Object.prototype.propertyIsEnumerable,ia=(e,t,r)=>t in e?Dg(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ct=(e,t)=>{for(var r in t||(t={}))Sg.call(t,r)&&ia(e,r,t[r]);if(na)for(var r of na(t))xg.call(t,r)&&ia(e,r,t[r]);return e};function Og(e,t){if(e.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<e.length;i++){var s=e.charAt(i),a=s.charCodeAt(0);if(r[a]!==255)throw new TypeError(s+" is ambiguous");r[a]=i}var c=e.length,l=e.charAt(0),f=Math.log(c)/Math.log(256),h=Math.log(256)/Math.log(c);function m(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var R=0,P=0,j=0,E=D.length;j!==E&&D[j]===0;)j++,R++;for(var O=(E-j)*h+1>>>0,g=new Uint8Array(O);j!==E;){for(var v=D[j],w=0,o=O-1;(v!==0||w<P)&&o!==-1;o--,w++)v+=256*g[o]>>>0,g[o]=v%c>>>0,v=v/c>>>0;if(v!==0)throw new Error("Non-zero carry");P=w,j++}for(var p=O-P;p!==O&&g[p]===0;)p++;for(var L=l.repeat(R);p<O;++p)L+=e.charAt(g[p]);return L}function b(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var R=0;if(D[R]!==" "){for(var P=0,j=0;D[R]===l;)P++,R++;for(var E=(D.length-R)*f+1>>>0,O=new Uint8Array(E);D[R];){var g=r[D.charCodeAt(R)];if(g===255)return;for(var v=0,w=E-1;(g!==0||v<j)&&w!==-1;w--,v++)g+=c*O[w]>>>0,O[w]=g%256>>>0,g=g/256>>>0;if(g!==0)throw new Error("Non-zero carry");j=v,R++}if(D[R]!==" "){for(var o=E-j;o!==E&&O[o]===0;)o++;for(var p=new Uint8Array(P+(E-o)),L=P;o!==E;)p[L++]=O[o++];return p}}}function y(D){var R=b(D);if(R)return R;throw new Error(`Non-${t} character`)}return{encode:m,decodeUnsafe:b,decode:y}}var Ig=Og,Tg=Ig;const sa=e=>{if(e instanceof Uint8Array&&e.constructor.name==="Uint8Array")return e;if(e instanceof ArrayBuffer)return new Uint8Array(e);if(ArrayBuffer.isView(e))return new Uint8Array(e.buffer,e.byteOffset,e.byteLength);throw new Error("Unknown type, must be binary type")},Ng=e=>new TextEncoder().encode(e),Ag=e=>new TextDecoder().decode(e);class Rg{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class Pg{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return oa(this,t)}}class Cg{constructor(t){this.decoders=t}or(t){return oa(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const oa=(e,t)=>new Cg(ct(ct({},e.decoders||{[e.prefix]:e}),t.decoders||{[t.prefix]:t}));class Fg{constructor(t,r,n,i){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Rg(t,r,n),this.decoder=new Pg(t,r,i)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const un=({name:e,prefix:t,encode:r,decode:n})=>new Fg(e,t,r,n),Lr=({prefix:e,name:t,alphabet:r})=>{const{encode:n,decode:i}=Tg(r,t);return un({prefix:e,name:t,encode:n,decode:s=>sa(i(s))})},Lg=(e,t,r,n)=>{const i={};for(let h=0;h<t.length;++h)i[t[h]]=h;let s=e.length;for(;e[s-1]==="=";)--s;const a=new Uint8Array(s*r/8|0);let c=0,l=0,f=0;for(let h=0;h<s;++h){const m=i[e[h]];if(m===void 0)throw new SyntaxError(`Non-${n} character`);l=l<<r|m,c+=r,c>=8&&(c-=8,a[f++]=255&l>>c)}if(c>=r||255&l<<8-c)throw new SyntaxError("Unexpected end of data");return a},Ug=(e,t,r)=>{const n=t[t.length-1]==="=",i=(1<<r)-1;let s="",a=0,c=0;for(let l=0;l<e.length;++l)for(c=c<<8|e[l],a+=8;a>r;)a-=r,s+=t[i&c>>a];if(a&&(s+=t[i&c<<r-a]),n)for(;s.length*r&7;)s+="=";return s},tt=({name:e,prefix:t,bitsPerChar:r,alphabet:n})=>un({prefix:t,name:e,encode(i){return Ug(i,n,r)},decode(i){return Lg(i,n,r,e)}}),$g=un({prefix:"\0",name:"identity",encode:e=>Ag(e),decode:e=>Ng(e)});var Mg=Object.freeze({__proto__:null,identity:$g});const jg=tt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var zg=Object.freeze({__proto__:null,base2:jg});const Bg=tt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var qg=Object.freeze({__proto__:null,base8:Bg});const Kg=Lr({prefix:"9",name:"base10",alphabet:"0123456789"});var Hg=Object.freeze({__proto__:null,base10:Kg});const Vg=tt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),Gg=tt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var Wg=Object.freeze({__proto__:null,base16:Vg,base16upper:Gg});const Yg=tt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),kg=tt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Xg=tt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Jg=tt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Zg=tt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Qg=tt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),e0=tt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),t0=tt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),r0=tt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var n0=Object.freeze({__proto__:null,base32:Yg,base32upper:kg,base32pad:Xg,base32padupper:Jg,base32hex:Zg,base32hexupper:Qg,base32hexpad:e0,base32hexpadupper:t0,base32z:r0});const i0=Lr({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),s0=Lr({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var o0=Object.freeze({__proto__:null,base36:i0,base36upper:s0});const a0=Lr({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),c0=Lr({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var u0=Object.freeze({__proto__:null,base58btc:a0,base58flickr:c0});const f0=tt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),l0=tt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),h0=tt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),d0=tt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var p0=Object.freeze({__proto__:null,base64:f0,base64pad:l0,base64url:h0,base64urlpad:d0});const aa=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),g0=aa.reduce((e,t,r)=>(e[r]=t,e),[]),_0=aa.reduce((e,t,r)=>(e[t.codePointAt(0)]=r,e),[]);function y0(e){return e.reduce((t,r)=>(t+=g0[r],t),"")}function b0(e){const t=[];for(const r of e){const n=_0[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const w0=un({prefix:"\u{1F680}",name:"base256emoji",encode:y0,decode:b0});var v0=Object.freeze({__proto__:null,base256emoji:w0}),m0=ua,ca=128,E0=127,D0=~E0,S0=Math.pow(2,31);function ua(e,t,r){t=t||[],r=r||0;for(var n=r;e>=S0;)t[r++]=e&255|ca,e/=128;for(;e&D0;)t[r++]=e&255|ca,e>>>=7;return t[r]=e|0,ua.bytes=r-n+1,t}var x0=Ni,O0=128,fa=127;function Ni(e,n){var r=0,n=n||0,i=0,s=n,a,c=e.length;do{if(s>=c)throw Ni.bytes=0,new RangeError("Could not decode varint");a=e[s++],r+=i<28?(a&fa)<<i:(a&fa)*Math.pow(2,i),i+=7}while(a>=O0);return Ni.bytes=s-n,r}var I0=Math.pow(2,7),T0=Math.pow(2,14),N0=Math.pow(2,21),A0=Math.pow(2,28),R0=Math.pow(2,35),P0=Math.pow(2,42),C0=Math.pow(2,49),F0=Math.pow(2,56),L0=Math.pow(2,63),U0=function(e){return e<I0?1:e<T0?2:e<N0?3:e<A0?4:e<R0?5:e<P0?6:e<C0?7:e<F0?8:e<L0?9:10},$0={encode:m0,decode:x0,encodingLength:U0},la=$0;const ha=(e,t,r=0)=>(la.encode(e,t,r),t),da=e=>la.encodingLength(e),Ai=(e,t)=>{const r=t.byteLength,n=da(e),i=n+da(r),s=new Uint8Array(i+r);return ha(e,s,0),ha(r,s,n),s.set(t,i),new M0(e,r,t,s)};class M0{constructor(t,r,n,i){this.code=t,this.size=r,this.digest=n,this.bytes=i}}const pa=({name:e,code:t,encode:r})=>new j0(e,t,r);class j0{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?Ai(this.code,r):r.then(n=>Ai(this.code,n))}else throw Error("Unknown type, must be binary type")}}const ga=e=>async t=>new Uint8Array(await crypto.subtle.digest(e,t)),z0=pa({name:"sha2-256",code:18,encode:ga("SHA-256")}),B0=pa({name:"sha2-512",code:19,encode:ga("SHA-512")});var q0=Object.freeze({__proto__:null,sha256:z0,sha512:B0});const _a=0,K0="identity",ya=sa;var H0=Object.freeze({__proto__:null,identity:{code:_a,name:K0,encode:ya,digest:e=>Ai(_a,ya(e))}});new TextEncoder,new TextDecoder;const ba=ct(ct(ct(ct(ct(ct(ct(ct(ct(ct({},Mg),zg),qg),Hg),Wg),n0),o0),u0),p0),v0);ct(ct({},q0),H0);function V0(e=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?globalThis.Buffer.allocUnsafe(e):new Uint8Array(e)}function wa(e,t,r,n){return{name:e,prefix:t,encoder:{name:e,prefix:t,encode:r},decoder:{decode:n}}}const va=wa("utf8","u",e=>"u"+new TextDecoder("utf8").decode(e),e=>new TextEncoder().encode(e.substring(1))),Ri=wa("ascii","a",e=>{let t="a";for(let r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},e=>{e=e.substring(1);const t=V0(e.length);for(let r=0;r<e.length;r++)t[r]=e.charCodeAt(r);return t}),G0=ct({utf8:va,"utf-8":va,hex:ba.base16,latin1:Ri,ascii:Ri,binary:Ri},ba);function W0(e,t="utf8"){const r=G0[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(e,"utf8"):r.decoder.decode(`${r.prefix}${e}`)}const ma="wc",Y0=2,Pi="core",Mt=`${ma}@${2}:${Pi}:`,k0={name:Pi,logger:"error"},X0={database:":memory:"},J0="crypto",Ea="client_ed25519_seed",Z0=Z.ONE_DAY,Q0="keychain",e_="0.3",t_="messages",r_="0.3",n_=Z.SIX_HOURS,i_="publisher",Da="irn",s_="error",Sa="wss://relay.walletconnect.com",o_="relayer",rt={message:"relayer_message",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},a_="_subscription",fn={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},xa=Z.ONE_SECOND,c_="2.4.3",u_="0.3",It={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},f_="subscription",l_="0.3",h_=Z.FIVE_SECONDS*1e3,d_="pairing",p_="0.3",Ur={wc_pairingDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:0},res:{ttl:Z.ONE_DAY,prompt:!1,tag:0}}},Tt={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},g_="history",__="0.3",y_="expirer",yt={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},b_="0.3";class w_{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=Q0,this.version=e_,this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,i)=>{this.isInitialized(),this.keychain.set(n,i),await this.persist()},this.get=n=>{this.isInitialized();const i=this.keychain.get(n);if(typeof i>"u"){const{message:s}=H("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(s)}return i},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Uo(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?$o(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}class v_{constructor(t,r,n){this.core=t,this.logger=r,this.name=J0,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=i=>(this.isInitialized(),this.keychain.has(i)),this.getClientId=async()=>{this.isInitialized();const i=await this.getClientSeed(),s=ao(i);return oo(s.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const i=xd();return this.setPrivateKey(i.publicKey,i.privateKey)},this.signJWT=async i=>{this.isInitialized();const s=await this.getClientSeed(),a=ao(s),c=di();return await Ch(c,i,Z0,a)},this.generateSharedKey=(i,s,a)=>{this.isInitialized();const c=this.getPrivateKey(i),l=Od(c,s);return this.setSymKey(l,a)},this.setSymKey=async(i,s)=>{this.isInitialized();const a=s||Id(i);return await this.keychain.set(a,i),a},this.deleteKeyPair=async i=>{this.isInitialized(),await this.keychain.del(i)},this.deleteSymKey=async i=>{this.isInitialized(),await this.keychain.del(i)},this.encode=async(i,s,a)=>{this.isInitialized();const c=Ao(a),l=Vn(s);if(Ro(c)){const b=c.senderPublicKey,y=c.receiverPublicKey;i=await this.generateSharedKey(b,y)}const f=this.getSymKey(i),{type:h,senderPublicKey:m}=c;return Nd({type:h,symKey:f,message:l,senderPublicKey:m})},this.decode=async(i,s,a)=>{this.isInitialized();const c=Pd(s,a);if(Ro(c)){const h=c.receiverPublicKey,m=c.senderPublicKey;i=await this.generateSharedKey(h,m)}const l=this.getSymKey(i),f=Ad({symKey:l,encoded:s});return As(f)},this.core=t,this.logger=xe.generateChildLogger(r,this.name),this.keychain=n||new w_(this.core,this.logger)}get context(){return xe.getLoggerContext(this.logger)}getPayloadType(t){const r=pi(t);return Nr(r.type)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Ea)}catch{t=di(),await this.keychain.set(Ea,t)}return W0(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}class m_ extends _f{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=t_,this.version=r_,this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,i)=>{this.isInitialized();const s=sn(i);let a=this.messages.get(n);return typeof a>"u"&&(a={}),typeof a[s]<"u"||(a[s]=i,this.messages.set(n,a),await this.persist()),s},this.get=n=>{this.isInitialized();let i=this.messages.get(n);return typeof i>"u"&&(i={}),i},this.has=(n,i)=>{this.isInitialized();const s=this.get(n),a=sn(i);return typeof s[a]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=xe.generateChildLogger(t,this.name),this.core=r}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Uo(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?$o(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}class E_ extends yf{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new ut.exports.EventEmitter,this.name=i_,this.queue=new Map,this.publishTimeout=1e4,this.publish=async(n,i,s)=>{this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}});try{const a=s?.ttl||n_,c=gi(s),l=s?.prompt||!1,f=s?.tag||0,h={topic:n,message:i,opts:{ttl:a,relay:c,prompt:l,tag:f}},m=sn(i);this.queue.set(m,h);try{await await Mo(this.rpcPublish(n,i,a,c,l,f),this.publishTimeout),this.relayer.events.emit(rt.publish,h)}catch{this.logger.debug("Publishing Payload stalled"),this.relayer.events.emit(rt.connection_stalled);return}this.onPublish(m,h),this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:i,opts:s}})}catch(a){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(a),a}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.relayer=t,this.logger=xe.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return xe.getLoggerContext(this.logger)}rpcPublish(t,r,n,i,s,a){var c,l,f,h;const m={method:_i(i.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:s,tag:a}};return at((c=m.params)==null?void 0:c.prompt)&&((l=m.params)==null||delete l.prompt),at((f=m.params)==null?void 0:f.tag)&&((h=m.params)==null||delete h.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:m}),this.relayer.provider.request(m)}onPublish(t,r){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:i}=t;await this.publish(r,n,i)})}registerEventListeners(){this.relayer.core.heartbeat.on(br.HEARTBEAT_EVENTS.pulse,()=>{this.checkQueue()})}}class D_{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const i=n.filter(s=>s!==r);if(!i.length){this.map.delete(t);return}this.map.set(t,i)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var S_=Object.defineProperty,x_=Object.defineProperties,O_=Object.getOwnPropertyDescriptors,Oa=Object.getOwnPropertySymbols,I_=Object.prototype.hasOwnProperty,T_=Object.prototype.propertyIsEnumerable,Ia=(e,t,r)=>t in e?S_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,ln=(e,t)=>{for(var r in t||(t={}))I_.call(t,r)&&Ia(e,r,t[r]);if(Oa)for(var r of Oa(t))T_.call(t,r)&&Ia(e,r,t[r]);return e},Ci=(e,t)=>x_(e,O_(t));class N_ extends vf{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new D_,this.events=new ut.exports.EventEmitter,this.name=f_,this.version=l_,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Mt,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restart(),this.registerEventListeners(),this.onEnable(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}});try{const s=gi(i),a={topic:n,relay:s};this.pending.set(n,a);const c=await this.rpcSubscribe(n,s);return this.onSubscribe(c,a),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:i}}),c}catch(s){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(s),s}},this.unsubscribe=async(n,i)=>{await this.restartToComplete(),this.isInitialized(),typeof i?.id<"u"?await this.unsubscribeById(n,i.id,i):await this.unsubscribeByTopic(n,i)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((i,s)=>{const a=new Z.Watch;a.start(this.pendingSubscriptionWatchLabel);const c=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),i(!0)),a.elapsed(this.pendingSubscriptionWatchLabel)>=h_&&(clearInterval(c),a.stop(this.pendingSubscriptionWatchLabel),s(!1))},this.pollingInterval)}),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=xe.generateChildLogger(r,this.name),this.clientId=""}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear(),this.initialized=!1}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async i=>await this.unsubscribeById(t,i,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const i=gi(n);await this.rpcUnsubscribe(t,r,i);const s=Ke("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,s),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(i){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(i),i}}async rpcSubscribe(t,r){const n={method:_i(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await Mo(this.relayer.provider.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(rt.connection_stalled)}return sn(t+this.clientId)}rpcUnsubscribe(t,r,n){const i={method:_i(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:i}),this.relayer.provider.request(i)}onSubscribe(t,r){this.setSubscription(t,Ci(ln({},r),{id:t})),this.pending.delete(r.topic)}onResubscribe(t,r){this.addSubscription(t,Ci(ln({},r),{id:t})),this.pending.delete(r.topic)}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,ln({},r)),this.topicMap.set(r.topic,t),this.events.emit(It.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(It.deleted,Ci(ln({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(It.sync)}async reset(){this.cached.length&&await Promise.all(this.cached.map(async t=>await this.resubscribe(t))),this.events.emit(It.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async resubscribe(t){if(!this.ids.includes(t.id)){const{topic:r,relay:n}=t,i={topic:r,relay:n};this.pending.set(i.topic,i);const s=await this.rpcSubscribe(i.topic,i.relay);this.onResubscribe(s,i)}}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}checkPending(){this.relayer.transportExplicitlyClosed||this.pending.forEach(async t=>{const r=await this.rpcSubscribe(t.topic,t.relay);this.onSubscribe(r,t)})}registerEventListeners(){this.relayer.core.heartbeat.on(br.HEARTBEAT_EVENTS.pulse,()=>{this.checkPending()}),this.relayer.on(rt.connect,async()=>{await this.onConnect()}),this.relayer.on(rt.disconnect,()=>{this.onDisconnect()}),this.events.on(It.created,async t=>{const r=It.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(It.deleted,async t=>{const r=It.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var A_=Object.defineProperty,Ta=Object.getOwnPropertySymbols,R_=Object.prototype.hasOwnProperty,P_=Object.prototype.propertyIsEnumerable,Na=(e,t,r)=>t in e?A_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,C_=(e,t)=>{for(var r in t||(t={}))R_.call(t,r)&&Na(e,r,t[r]);if(Ta)for(var r of Ta(t))P_.call(t,r)&&Na(e,r,t[r]);return e};class F_ extends bf{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new ut.exports.EventEmitter,this.name=o_,this.transportExplicitlyClosed=!1,this.initialized=!1,this.reconnecting=!1,this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?xe.generateChildLogger(t.logger,this.name):Br(xe.getDefaultLoggerOptions({level:t.logger||s_})),this.messages=new m_(this.logger,t.core),this.subscriber=new N_(this,this.logger),this.publisher=new E_(this,this.logger),this.relayUrl=t?.relayUrl||Sa,this.projectId=t.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.provider=await this.createProvider(),await Promise.all([this.messages.init(),this.transportOpen(),this.subscriber.init()]),this.registerEventListeners(),this.initialized=!0}get context(){return xe.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r})}async subscribe(t,r){this.isInitialized();let n="";return await Promise.all([new Promise(i=>{this.subscriber.once(It.created,s=>{s.topic===t&&i()})}),new Promise(async i=>{n=await this.subscriber.subscribe(t,r),i()})]),n}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.connected&&(await this.provider.disconnect(),this.events.emit(rt.transport_closed))}async transportOpen(t){if(!this.reconnecting){this.relayUrl=t||this.relayUrl,this.transportExplicitlyClosed=!1,this.reconnecting=!0;try{await Promise.all([new Promise(r=>{this.initialized||r(),this.subscriber.once(It.resubscribed,()=>{r()})}),await Promise.race([new Promise(async r=>{await this.provider.connect(),this.removeListener(rt.transport_closed,this.rejectTransportOpen),r()}),new Promise(r=>this.once(rt.transport_closed,this.rejectTransportOpen))])])}catch(r){const n=r;if(!/socket hang up/i.test(n.message))throw r;this.logger.error(r),this.events.emit(rt.transport_closed)}finally{this.reconnecting=!1}}}async restartTransport(t){this.transportExplicitlyClosed||(await this.transportClose(),await new Promise(r=>setTimeout(r,xa)),await this.transportOpen(t))}rejectTransportOpen(){throw new Error("closeTransport called before connection was established")}async createProvider(){const t=await this.core.crypto.signJWT(this.relayUrl);return new yg(new mg(Gd({sdkVersion:c_,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t})))}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;return await this.subscriber.isSubscribed(r)?this.messages.has(r,n):!0}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Oi(t)){if(!t.method.endsWith(a_))return;const r=t.params,{topic:n,message:i}=r.data,s={topic:n,message:i};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(C_({type:"event",event:r.id},s)),this.events.emit(r.id,s),await this.acknowledgePayload(t),await this.onMessageEvent(s)}}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(rt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Si(t.id,!0);await this.provider.connection.send(r)}registerEventListeners(){this.provider.on(fn.payload,t=>this.onProviderPayload(t)),this.provider.on(fn.connect,()=>{this.events.emit(rt.connect)}),this.provider.on(fn.disconnect,()=>{this.events.emit(rt.disconnect),this.attemptToReconnect()}),this.provider.on(fn.error,t=>this.events.emit(rt.error,t)),this.events.on(rt.connection_stalled,async()=>{await this.restartTransport()})}attemptToReconnect(){this.transportExplicitlyClosed||setTimeout(async()=>{await this.transportOpen()},Z.toMiliseconds(xa))}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}var L_=Object.defineProperty,Aa=Object.getOwnPropertySymbols,U_=Object.prototype.hasOwnProperty,$_=Object.prototype.propertyIsEnumerable,Ra=(e,t,r)=>t in e?L_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,Pa=(e,t)=>{for(var r in t||(t={}))U_.call(t,r)&&Ra(e,r,t[r]);if(Aa)for(var r of Aa(t))$_.call(t,r)&&Ra(e,r,t[r]);return e};class hn extends wf{constructor(t,r,n,i=Mt,s=void 0){super(t,r,n,i),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=u_,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(a=>{dp(a)?this.map.set(a.id,a):pp(a)?this.map.set(a.topic,a):this.getKey&&a!==null&&!at(a)&&this.map.set(this.getKey(a),a)}),this.cached=[],this.initialized=!0)},this.set=async(a,c)=>{this.isInitialized(),this.map.has(a)?await this.update(a,c):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:a,value:c}),this.map.set(a,c),await this.persist())},this.get=a=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:a}),this.getData(a)),this.getAll=a=>(this.isInitialized(),a?this.values.filter(c=>Object.keys(a).every(l=>Eg(c[l],a[l]))):this.values),this.update=async(a,c)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:a,update:c});const l=Pa(Pa({},this.getData(a)),c);this.map.set(a,l),await this.persist()},this.delete=async(a,c)=>{this.isInitialized(),this.map.has(a)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:a,reason:c}),this.map.delete(a),await this.persist())},this.logger=xe.generateChildLogger(r,this.name),this.storagePrefix=i,this.getKey=s}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}class M_{constructor(t,r){this.core=t,this.logger=r,this.name=d_,this.version=p_,this.events=new ut.exports,this.initialized=!1,this.storagePrefix=Mt,this.ignoredPayloadTypes=[Xt],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=di(),i=await this.core.crypto.setSymKey(n),s=Ot(Z.FIVE_MINUTES),a={protocol:Da},c={topic:i,expiry:s,relay:a,active:!1},l=np({protocol:this.core.protocol,version:this.core.version,topic:i,symKey:n,relay:a});return await this.pairings.set(i,c),await this.core.relayer.subscribe(i),this.core.expirer.set(i,s),{topic:i,uri:l}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:i,symKey:s,relay:a}=tp(n.uri),c=Ot(Z.FIVE_MINUTES),l={topic:i,relay:a,expiry:c,active:!1};return await this.pairings.set(i,l),await this.core.crypto.setSymKey(s,i),await this.core.relayer.subscribe(i,{relay:a}),this.core.expirer.set(i,c),n.activatePairing&&await this.activate({topic:i}),l},this.activate=async({topic:n})=>{this.isInitialized();const i=Ot(Z.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:i}),this.core.expirer.set(n,i)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:i}=n;if(this.pairings.keys.includes(i)){const s=await this.sendRequest(i,"wc_pairingPing",{}),{done:a,resolve:c,reject:l}=Jt();this.events.once(Le("pairing_ping",s),({error:f})=>{f?l(f):c()}),await a()}},this.updateExpiry=async({topic:n,expiry:i})=>{this.isInitialized(),await this.pairings.update(n,{expiry:i})},this.updateMetadata=async({topic:n,metadata:i})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:i})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:i}=n;this.pairings.keys.includes(i)&&(await this.sendRequest(i,"wc_pairingDelete",Ke("USER_DISCONNECTED")),await this.deletePairing(i))},this.sendRequest=async(n,i,s)=>{const a=cn(i,s),c=await this.core.crypto.encode(n,a),l=Ur[i].req;return this.core.history.set(n,a),await this.core.relayer.publish(n,c,l),a.id},this.sendResult=async(n,i,s)=>{const a=Si(n,s),c=await this.core.crypto.encode(i,a),l=await this.core.history.get(i,n),f=Ur[l.request.method].res;await this.core.relayer.publish(i,c,f),await this.core.history.resolve(a)},this.sendError=async(n,i,s)=>{const a=xi(n,s),c=await this.core.crypto.encode(i,a),l=await this.core.history.get(i,n),f=Ur[l.request.method]?Ur[l.request.method].res:Ur.unregistered_method.res;await this.core.relayer.publish(i,c,f),await this.core.history.resolve(a)},this.deletePairing=async(n,i)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,Ke("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),i?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(i=>$t(i.expiry));await Promise.all(n.map(i=>this.deletePairing(i.topic)))},this.onRelayEventRequest=n=>{const{topic:i,payload:s}=n,a=s.method;if(this.pairings.keys.includes(i))switch(a){case"wc_pairingPing":return this.onPairingPingRequest(i,s);case"wc_pairingDelete":return this.onPairingDeleteRequest(i,s);default:return this.onUnknownRpcMethodRequest(i,s)}},this.onRelayEventResponse=async n=>{const{topic:i,payload:s}=n,a=(await this.core.history.get(i,s.id)).request.method;if(this.pairings.keys.includes(i))switch(a){case"wc_pairingPing":return this.onPairingPingResponse(i,s);default:return this.onUnknownRpcMethodResponse(a)}},this.onPairingPingRequest=async(n,i)=>{const{id:s}=i;try{this.isValidPing({topic:n}),await this.sendResult(s,n,!0),this.events.emit("pairing_ping",{id:s,topic:n})}catch(a){await this.sendError(s,n,a),this.logger.error(a)}},this.onPairingPingResponse=(n,i)=>{const{id:s}=i;setTimeout(()=>{Pt(i)?this.events.emit(Le("pairing_ping",s),{}):mt(i)&&this.events.emit(Le("pairing_ping",s),{error:i.error})},500)},this.onPairingDeleteRequest=async(n,i)=>{const{id:s}=i;try{this.isValidDisconnect({topic:n}),await this.sendResult(s,n,!0),await this.deletePairing(n),this.events.emit("pairing_delete",{id:s,topic:n})}catch(a){await this.sendError(s,n,a),this.logger.error(a)}},this.onUnknownRpcMethodRequest=async(n,i)=>{const{id:s,method:a}=i;try{if(this.registeredMethods.includes(a))return;const c=Ke("WC_METHOD_UNSUPPORTED",a);await this.sendError(s,n,c),this.logger.error(c)}catch(c){await this.sendError(s,n,c),this.logger.error(c)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(Ke("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{if(!dt(n)){const{message:i}=H("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(i)}if(!hp(n.uri)){const{message:i}=H("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(i)}},this.isValidPing=async n=>{if(!dt(n)){const{message:s}=H("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidDisconnect=async n=>{if(!dt(n)){const{message:s}=H("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(s)}const{topic:i}=n;await this.isValidPairingTopic(i)},this.isValidPairingTopic=async n=>{if(!He(n,!1)){const{message:i}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(i)}if(!this.pairings.keys.includes(n)){const{message:i}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(i)}if($t(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:i}=H("EXPIRED",`pairing topic: ${n}`);throw new Error(i)}},this.core=t,this.logger=xe.generateChildLogger(r,this.name),this.pairings=new hn(this.core,this.logger,this.name,this.storagePrefix)}get context(){return xe.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(rt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const i=await this.core.crypto.decode(r,n);Oi(i)?(this.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):Ii(i)&&(await this.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.core.expirer.on(yt.expired,async t=>{const{topic:r}=zo(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit("pairing_expire",{topic:r}))})}}class j_ extends gf{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new ut.exports.EventEmitter,this.name=g_,this.version=__,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,i,s)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:i,chainId:s}),this.records.has(i.id))return;const a={id:i.id,topic:n,request:{method:i.method,params:i.params||null},chainId:s};this.records.set(a.id,a),this.events.emit(Tt.created,a)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const i=await this.getRecord(n.id);typeof i.response>"u"&&(i.response=mt(n)?{error:n.error}:{result:n.result},this.records.set(i.id,i),this.events.emit(Tt.updated,i))},this.get=async(n,i)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:i}),await this.getRecord(i)),this.delete=(n,i)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:i}),this.values.forEach(s=>{if(s.topic===n){if(typeof i<"u"&&s.id!==i)return;this.records.delete(s.id),this.events.emit(Tt.deleted,s)}})},this.exists=async(n,i)=>(this.isInitialized(),this.records.has(i)?(await this.getRecord(i)).topic===n:!1),this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:cn(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Tt.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Tt.created,t=>{const r=Tt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Tt.updated,t=>{const r=Tt.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Tt.deleted,t=>{const r=Tt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}class z_ extends mf{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new ut.exports.EventEmitter,this.name=y_,this.version=b_,this.cached=[],this.initialized=!1,this.storagePrefix=Mt,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const i=this.formatTarget(n);return typeof this.getExpiration(i)<"u"}catch{return!1}},this.set=(n,i)=>{this.isInitialized();const s=this.formatTarget(n),a={target:s,expiry:i};this.expirations.set(s,a),this.checkExpiry(s,a),this.events.emit(yt.created,{target:s,expiration:a})},this.get=n=>{this.isInitialized();const i=this.formatTarget(n);return this.getExpiration(i)},this.del=n=>{if(this.isInitialized(),this.has(n)){const i=this.formatTarget(n),s=this.getExpiration(i);this.expirations.delete(i),this.events.emit(yt.deleted,{target:i,expiration:s})}},this.on=(n,i)=>{this.events.on(n,i)},this.once=(n,i)=>{this.events.once(n,i)},this.off=(n,i)=>{this.events.off(n,i)},this.removeListener=(n,i)=>{this.events.removeListener(n,i)},this.logger=xe.generateChildLogger(r,this.name)}get context(){return xe.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return Wd(t);if(typeof t=="number")return Yd(t);const{message:r}=H("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(yt.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=H("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=H("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;Z.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(yt.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(br.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(yt.created,t=>{const r=yt.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(yt.expired,t=>{const r=yt.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(yt.deleted,t=>{const r=yt.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}}var B_=Object.defineProperty,Ca=Object.getOwnPropertySymbols,q_=Object.prototype.hasOwnProperty,K_=Object.prototype.propertyIsEnumerable,Fa=(e,t,r)=>t in e?B_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,La=(e,t)=>{for(var r in t||(t={}))q_.call(t,r)&&Fa(e,r,t[r]);if(Ca)for(var r of Ca(t))K_.call(t,r)&&Fa(e,r,t[r]);return e};class Fi extends pf{constructor(t){super(t),this.protocol=ma,this.version=Y0,this.name=Pi,this.events=new ut.exports.EventEmitter,this.initialized=!1,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.projectId=t?.projectId,this.relayUrl=t?.relayUrl||Sa;const r=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:Br(xe.getDefaultLoggerOptions({level:t?.logger||k0.logger}));this.logger=xe.generateChildLogger(r,this.name),this.heartbeat=new br.HeartBeat,this.crypto=new v_(this,this.logger,t?.keychain),this.history=new j_(this,this.logger),this.expirer=new z_(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new Vc(La(La({},X0),t?.storageOptions)),this.relayer=new F_({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new M_(this,this.logger)}static async init(t){const r=new Fi(t);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const H_=Fi,Li="wc",Ui=2,$i="client",dn=`${Li}@${Ui}:${$i}:`,pn={name:$i,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},V_={session_proposal:"session_proposal",session_update:"session_update",session_extend:"session_extend",session_ping:"session_ping",session_delete:"session_delete",session_expire:"session_expire",session_request:"session_request",session_request_sent:"session_request_sent",session_event:"session_event",proposal_expire:"proposal_expire"},G_={database:":memory:"},W_={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},Y_="history",k_="0.3",Ua="proposal",X_=Z.THIRTY_DAYS,$a="session",$r=Z.SEVEN_DAYS,Ma="engine",ur={wc_sessionPropose:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1104},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1106},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:Z.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:Z.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:Z.ONE_DAY,prompt:!1,tag:1112},res:{ttl:Z.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:Z.THIRTY_SECONDS,prompt:!1,tag:1115}}},gn={min:Z.FIVE_MINUTES,max:Z.SEVEN_DAYS},ja="request";var J_=Object.defineProperty,Z_=Object.defineProperties,Q_=Object.getOwnPropertyDescriptors,za=Object.getOwnPropertySymbols,ey=Object.prototype.hasOwnProperty,ty=Object.prototype.propertyIsEnumerable,Ba=(e,t,r)=>t in e?J_(e,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[t]=r,bt=(e,t)=>{for(var r in t||(t={}))ey.call(t,r)&&Ba(e,r,t[r]);if(za)for(var r of za(t))ty.call(t,r)&&Ba(e,r,t[r]);return e},Mi=(e,t)=>Z_(e,Q_(t));class ry extends Df{constructor(t){super(t),this.name=Ma,this.events=new ut.exports,this.initialized=!1,this.ignoredPayloadTypes=[Xt],this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(ur)}),this.initialized=!0)},this.connect=async r=>{this.isInitialized();const n=Mi(bt({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:i,requiredNamespaces:s,optionalNamespaces:a,sessionProperties:c,relays:l}=n;let f=i,h,m=!1;if(f&&(m=this.client.core.pairing.pairings.get(f).active),!f||!m){const{topic:O,uri:g}=await this.client.core.pairing.create();f=O,h=g}const b=await this.client.core.crypto.generateKeyPair(),y=bt({requiredNamespaces:s,optionalNamespaces:a,relays:l??[{protocol:Da}],proposer:{publicKey:b,metadata:this.client.metadata}},c&&{sessionProperties:c}),{reject:D,resolve:R,done:P}=Jt();if(this.events.once(Le("session_connect"),async({error:O,session:g})=>{if(O)D(O);else if(g){g.self.publicKey=b;const v=Mi(bt({},g),{requiredNamespaces:g.requiredNamespaces,optionalNamespaces:g.optionalNamespaces});await this.client.session.set(g.topic,v),await this.setExpiry(g.topic,g.expiry),f&&await this.client.core.pairing.updateMetadata({topic:f,metadata:g.peer.metadata}),R(v)}}),!f){const{message:O}=H("NO_MATCHING_KEY",`connect() pairing topic: ${f}`);throw new Error(O)}const j=await this.sendRequest(f,"wc_sessionPropose",y),E=Ot(Z.FIVE_MINUTES);return await this.setProposal(j,bt({id:j,expiry:E},y)),{uri:h,approval:P}},this.pair=async r=>(this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:i,namespaces:s,sessionProperties:a}=r,c=this.client.proposal.get(n);let{pairingTopic:l,proposer:f,requiredNamespaces:h,optionalNamespaces:m}=c;Pr(h)||(h=ap(s,"approve()"));const b=await this.client.core.crypto.generateKeyPair(),y=f.publicKey,D=await this.client.core.crypto.generateSharedKey(b,y);l&&n&&(await this.client.core.pairing.updateMetadata({topic:l,metadata:f.metadata}),await this.sendResult(n,l,{relay:{protocol:i??"irn"},responderPublicKey:b}),await this.client.proposal.delete(n,Ke("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:l}));const R=bt({relay:{protocol:i??"irn"},namespaces:s,requiredNamespaces:h,optionalNamespaces:m,controller:{publicKey:b,metadata:this.client.metadata},expiry:Ot($r)},a&&{sessionProperties:a});await this.client.core.relayer.subscribe(D);const P=await this.sendRequest(D,"wc_sessionSettle",R),{done:j,resolve:E,reject:O}=Jt();this.events.once(Le("session_approve",P),({error:v})=>{v?O(v):E(this.client.session.get(D))});const g=Mi(bt({},R),{topic:D,acknowledged:!1,self:R.controller,peer:{publicKey:f.publicKey,metadata:f.metadata},controller:b});return await this.client.session.set(D,g),await this.setExpiry(D,Ot($r)),{topic:D,acknowledged:j}},this.reject=async r=>{this.isInitialized(),await this.isValidReject(r);const{id:n,reason:i}=r,{pairingTopic:s}=this.client.proposal.get(n);s&&(await this.sendError(n,s,i),await this.client.proposal.delete(n,Ke("USER_DISCONNECTED")))},this.update=async r=>{this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:i}=r,s=await this.sendRequest(n,"wc_sessionUpdate",{namespaces:i}),{done:a,resolve:c,reject:l}=Jt();return this.events.once(Le("session_update",s),({error:f})=>{f?l(f):c()}),await this.client.session.update(n,{namespaces:i}),{acknowledged:a}},this.extend=async r=>{this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,i=await this.sendRequest(n,"wc_sessionExtend",{}),{done:s,resolve:a,reject:c}=Jt();return this.events.once(Le("session_extend",i),({error:l})=>{l?c(l):a()}),await this.setExpiry(n,Ot($r)),{acknowledged:s}},this.request=async r=>{this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:i,topic:s,expiry:a}=r,c=await this.sendRequest(s,"wc_sessionRequest",{request:i,chainId:n},a),{done:l,resolve:f,reject:h}=Jt(a);return this.events.once(Le("session_request",c),({error:m,result:b})=>{m?h(m):f(b)}),this.client.events.emit("session_request_sent",{topic:s,request:i,chainId:n}),await l()},this.respond=async r=>{this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:i}=r,{id:s}=i;Pt(i)?await this.sendResult(s,n,i.result):mt(i)&&await this.sendError(s,n,i.error),this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0})},this.ping=async r=>{this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const i=await this.sendRequest(n,"wc_sessionPing",{}),{done:s,resolve:a,reject:c}=Jt();this.events.once(Le("session_ping",i),({error:l})=>{l?c(l):a()}),await s()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:i,chainId:s}=r;await this.sendRequest(n,"wc_sessionEvent",{event:i,chainId:s})},this.disconnect=async r=>{this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest(n,"wc_sessionDelete",Ke("USER_DISCONNECTED")),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>fp(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.deleteSession=async(r,n)=>{const{self:i}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),await Promise.all([this.client.session.delete(r,Ke("USER_DISCONNECTED")),this.client.core.crypto.deleteKeyPair(i.publicKey),this.client.core.crypto.deleteSymKey(r),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,Ke("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,i=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),i?Promise.resolve():this.client.core.expirer.del(r)])},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=ur.wc_sessionRequest.req.ttl,{id:i,topic:s,params:a}=r;await this.client.pendingRequest.set(i,{id:i,topic:s,params:a}),n&&this.client.core.expirer.set(i,Ot(n))},this.sendRequest=async(r,n,i,s)=>{const a=cn(n,i),c=await this.client.core.crypto.encode(r,a),l=ur[n].req;return s&&(l.ttl=s),this.client.core.history.set(r,a),this.client.core.relayer.publish(r,c,l),a.id},this.sendResult=async(r,n,i)=>{const s=Si(r,i),a=await this.client.core.crypto.encode(n,s),c=await this.client.core.history.get(n,r),l=ur[c.request.method].res;this.client.core.relayer.publish(n,a,l),await this.client.core.history.resolve(s)},this.sendError=async(r,n,i)=>{const s=xi(r,i),a=await this.client.core.crypto.encode(n,s),c=await this.client.core.history.get(n,r),l=ur[c.request.method].res;this.client.core.relayer.publish(n,a,l),await this.client.core.history.resolve(s)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(i=>{$t(i.expiry)&&r.push(i.topic)}),this.client.proposal.getAll().forEach(i=>{$t(i.expiry)&&n.push(i.id)}),await Promise.all([...r.map(i=>this.deleteSession(i)),...n.map(i=>this.deleteProposal(i))])},this.onRelayEventRequest=r=>{const{topic:n,payload:i}=r,s=i.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeRequest(n,i);case"wc_sessionSettle":return this.onSessionSettleRequest(n,i);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,i);case"wc_sessionExtend":return this.onSessionExtendRequest(n,i);case"wc_sessionPing":return this.onSessionPingRequest(n,i);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,i);case"wc_sessionRequest":return this.onSessionRequest(n,i);case"wc_sessionEvent":return this.onSessionEventRequest(n,i);default:return this.client.logger.info(`Unsupported request method ${s}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:i}=r,s=(await this.client.core.history.get(n,i.id)).request.method;switch(s){case"wc_sessionPropose":return this.onSessionProposeResponse(n,i);case"wc_sessionSettle":return this.onSessionSettleResponse(n,i);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,i);case"wc_sessionExtend":return this.onSessionExtendResponse(n,i);case"wc_sessionPing":return this.onSessionPingResponse(n,i);case"wc_sessionRequest":return this.onSessionRequestResponse(n,i);default:return this.client.logger.info(`Unsupported response method ${s}`)}},this.onSessionProposeRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidConnect(bt({},n.params));const a=Ot(Z.FIVE_MINUTES),c=bt({id:s,pairingTopic:r,expiry:a},i);await this.setProposal(s,c),this.client.events.emit("session_proposal",{id:s,params:c})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionProposeResponse=async(r,n)=>{const{id:i}=n;if(Pt(n)){const{result:s}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:s});const a=this.client.proposal.get(i);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:a});const c=a.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:c});const l=s.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:l});const f=await this.client.core.crypto.generateSharedKey(c,l);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:f});const h=await this.client.core.relayer.subscribe(f);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:h}),await this.client.core.pairing.activate({topic:r})}else mt(n)&&(await this.client.proposal.delete(i,Ke("USER_DISCONNECTED")),this.events.emit(Le("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidSessionSettleRequest(s);const{relay:a,controller:c,expiry:l,namespaces:f,requiredNamespaces:h,optionalNamespaces:m,sessionProperties:b}=n.params,y=bt({topic:r,relay:a,expiry:l,namespaces:f,acknowledged:!0,requiredNamespaces:h,optionalNamespaces:m,controller:c.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:c.publicKey,metadata:c.metadata}},b&&{sessionProperties:b});await this.sendResult(n.id,r,!0),this.events.emit(Le("session_connect"),{session:y})}catch(a){await this.sendError(i,r,a),this.client.logger.error(a)}},this.onSessionSettleResponse=async(r,n)=>{const{id:i}=n;Pt(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Le("session_approve",i),{})):mt(n)&&(await this.client.session.delete(r,Ke("USER_DISCONNECTED")),this.events.emit(Le("session_approve",i),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:i,id:s}=n;try{this.isValidUpdate(bt({topic:r},i)),await this.client.session.update(r,{namespaces:i.namespaces}),await this.sendResult(s,r,!0),this.client.events.emit("session_update",{id:s,topic:r,params:i})}catch(a){await this.sendError(s,r,a),this.client.logger.error(a)}},this.onSessionUpdateResponse=(r,n)=>{const{id:i}=n;Pt(n)?this.events.emit(Le("session_update",i),{}):mt(n)&&this.events.emit(Le("session_update",i),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:i}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Ot($r)),await this.sendResult(i,r,!0),this.client.events.emit("session_extend",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionExtendResponse=(r,n)=>{const{id:i}=n;Pt(n)?this.events.emit(Le("session_extend",i),{}):mt(n)&&this.events.emit(Le("session_extend",i),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:i}=n;try{this.isValidPing({topic:r}),await this.sendResult(i,r,!0),this.client.events.emit("session_ping",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionPingResponse=(r,n)=>{const{id:i}=n;setTimeout(()=>{Pt(n)?this.events.emit(Le("session_ping",i),{}):mt(n)&&this.events.emit(Le("session_ping",i),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:i}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),this.client.core.relayer.once(rt.publish,async()=>{await this.deleteSession(r)}),await this.sendResult(i,r,!0),this.client.events.emit("session_delete",{id:i,topic:r})}catch(s){await this.sendError(i,r,s),this.client.logger.error(s)}},this.onSessionRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidRequest(bt({topic:r},s)),await this.setPendingSessionRequest({id:i,topic:r,params:s}),this.client.events.emit("session_request",{id:i,topic:r,params:s})}catch(a){await this.sendError(i,r,a),this.client.logger.error(a)}},this.onSessionRequestResponse=(r,n)=>{const{id:i}=n;Pt(n)?this.events.emit(Le("session_request",i),{result:n.result}):mt(n)&&this.events.emit(Le("session_request",i),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:i,params:s}=n;try{this.isValidEmit(bt({topic:r},s)),this.client.events.emit("session_event",{id:i,topic:r,params:s})}catch(a){await this.sendError(i,r,a),this.client.logger.error(a)}},this.isValidConnect=async r=>{if(!dt(r)){const{message:l}=H("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(l)}const{pairingTopic:n,requiredNamespaces:i,optionalNamespaces:s,sessionProperties:a,relays:c}=r;if(at(n)||await this.isValidPairingTopic(n),!Ep(c,!0)){const{message:l}=H("MISSING_OR_INVALID",`connect() relays: ${c}`);throw new Error(l)}!at(i)&&Pr(i)!==0&&this.validateNamespaces(i,"requiredNamespaces"),!at(s)&&Pr(s)!==0&&this.validateNamespaces(s,"optionalNamespaces"),at(a)||this.validateSessionProps(a,"sessionProperties")},this.validateNamespaces=(r,n)=>{const i=mp(r,"connect()",n);if(i)throw new Error(i.message)},this.isValidApprove=async r=>{if(!dt(r))throw new Error(H("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:i,relayProtocol:s,sessionProperties:a}=r;await this.isValidProposalId(n);const c=this.client.proposal.get(n),l=an(i,"approve()");if(l)throw new Error(l.message);const f=wi(c.requiredNamespaces,i,"approve()","requiredNamespaces");if(f)throw new Error(f.message);if(!He(s,!0)){const{message:h}=H("MISSING_OR_INVALID",`approve() relayProtocol: ${s}`);throw new Error(h)}if(Object.keys(i).length>Object.keys(c.requiredNamespaces).length){const h=Object.keys(c.optionalNamespaces).filter(y=>i[y]),m={};for(const y in c.optionalNamespaces)h.includes(y)&&(m[y]=c.optionalNamespaces[y]);const b=wi(m,i,"approve()","optionalNamespaces");if(b)throw new Error(b.message)}at(a)||this.validateSessionProps(a,"sessionProperties")},this.isValidReject=async r=>{if(!dt(r)){const{message:s}=H("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(s)}const{id:n,reason:i}=r;if(await this.isValidProposalId(n),!Sp(i)){const{message:s}=H("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidSessionSettleRequest=r=>{if(!dt(r)){const{message:f}=H("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(f)}const{relay:n,controller:i,namespaces:s,expiry:a}=r;if(!Vo(n)){const{message:f}=H("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(f)}const c=gp(i,"onSessionSettleRequest()");if(c)throw new Error(c.message);const l=an(s,"onSessionSettleRequest()");if(l)throw new Error(l.message);if($t(a)){const{message:f}=H("EXPIRED","onSessionSettleRequest()");throw new Error(f)}},this.isValidUpdate=async r=>{if(!dt(r)){const{message:l}=H("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(l)}const{topic:n,namespaces:i}=r;await this.isValidSessionTopic(n);const s=this.client.session.get(n),a=an(i,"update()");if(a)throw new Error(a.message);const c=wi(s.requiredNamespaces,i,"update()","requiredNamespaces");if(c)throw new Error(c.message)},this.isValidExtend=async r=>{if(!dt(r)){const{message:i}=H("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!dt(r)){const{message:l}=H("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(l)}const{topic:n,request:i,chainId:s,expiry:a}=r;await this.isValidSessionTopic(n);const{namespaces:c}=this.client.session.get(n);if(!Go(c,s)){const{message:l}=H("MISSING_OR_INVALID",`request() chainId: ${s}`);throw new Error(l)}if(!xp(i)){const{message:l}=H("MISSING_OR_INVALID",`request() ${JSON.stringify(i)}`);throw new Error(l)}if(!Tp(c,s,i.method)){const{message:l}=H("MISSING_OR_INVALID",`request() method: ${i.method}`);throw new Error(l)}if(a&&!Ap(a,gn)){const{message:l}=H("MISSING_OR_INVALID",`request() expiry: ${a}. Expiry must be a number (in seconds) between ${gn.min} and ${gn.max}`);throw new Error(l)}},this.isValidRespond=async r=>{if(!dt(r)){const{message:s}=H("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(s)}const{topic:n,response:i}=r;if(await this.isValidSessionTopic(n),!Op(i)){const{message:s}=H("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(i)}`);throw new Error(s)}},this.isValidPing=async r=>{if(!dt(r)){const{message:i}=H("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!dt(r)){const{message:c}=H("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(c)}const{topic:n,event:i,chainId:s}=r;await this.isValidSessionTopic(n);const{namespaces:a}=this.client.session.get(n);if(!Go(a,s)){const{message:c}=H("MISSING_OR_INVALID",`emit() chainId: ${s}`);throw new Error(c)}if(!Ip(i)){const{message:c}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(c)}if(!Np(a,s,i.name)){const{message:c}=H("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(i)}`);throw new Error(c)}},this.isValidDisconnect=async r=>{if(!dt(r)){const{message:i}=H("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(i)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(i=>{if(!He(i,!1)){const{message:s}=H("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(i)}`);throw new Error(s)}})}}isInitialized(){if(!this.initialized){const{message:t}=H("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.client.core.relayer.on(rt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const i=await this.client.core.crypto.decode(r,n);Oi(i)?(this.client.core.history.set(r,i),this.onRelayEventRequest({topic:r,payload:i})):Ii(i)&&(await this.client.core.history.resolve(i),this.onRelayEventResponse({topic:r,payload:i}))})}registerExpirerEvents(){this.client.core.expirer.on(yt.expired,async t=>{const{topic:r,id:n}=zo(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,H("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}isValidPairingTopic(t){if(!He(t,!1)){const{message:r}=H("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=H("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if($t(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=H("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!He(t,!1)){const{message:r}=H("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=H("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if($t(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=H("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(He(t,!1)){const{message:r}=H("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=H("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!Dp(t)){const{message:r}=H("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=H("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if($t(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=H("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class ny extends hn{constructor(t,r){super(t,r,Ua,dn),this.core=t,this.logger=r}}class iy extends hn{constructor(t,r){super(t,r,$a,dn),this.core=t,this.logger=r}}class sy extends hn{constructor(t,r){super(t,r,ja,dn),this.core=t,this.logger=r}}class _n extends Ef{constructor(t){super(t),this.protocol=Li,this.version=Ui,this.name=pn.name,this.events=new ut.exports.EventEmitter,this.on=(n,i)=>this.events.on(n,i),this.once=(n,i)=>this.events.once(n,i),this.off=(n,i)=>this.events.off(n,i),this.removeListener=(n,i)=>this.events.removeListener(n,i),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(i){throw this.logger.error(i.message),i}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(i){throw this.logger.error(i.message),i}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(i){throw this.logger.error(i.message),i}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(i){throw this.logger.error(i.message),i}},this.update=async n=>{try{return await this.engine.update(n)}catch(i){throw this.logger.error(i.message),i}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(i){throw this.logger.error(i.message),i}},this.request=async n=>{try{return await this.engine.request(n)}catch(i){throw this.logger.error(i.message),i}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(i){throw this.logger.error(i.message),i}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(i){throw this.logger.error(i.message),i}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(i){throw this.logger.error(i.message),i}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(i){throw this.logger.error(i.message),i}},this.find=n=>{try{return this.engine.find(n)}catch(i){throw this.logger.error(i.message),i}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=t?.name||pn.name,this.metadata=t?.metadata||qd();const r=typeof t?.logger<"u"&&typeof t?.logger!="string"?t.logger:Br(xe.getDefaultLoggerOptions({level:t?.logger||pn.logger}));this.core=t?.core||new H_(t),this.logger=xe.generateChildLogger(r,this.name),this.session=new iy(this.core,this.logger),this.proposal=new ny(this.core,this.logger),this.pendingRequest=new sy(this.core,this.logger),this.engine=new ry(this)}static async init(t){const r=new _n(t);return await r.initialize(),r}get context(){return xe.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}}const oy=_n;Ie.ENGINE_CONTEXT=Ma,Ie.ENGINE_RPC_OPTS=ur,Ie.HISTORY_CONTEXT=Y_,Ie.HISTORY_EVENTS=W_,Ie.HISTORY_STORAGE_VERSION=k_,Ie.PROPOSAL_CONTEXT=Ua,Ie.PROPOSAL_EXPIRY=X_,Ie.REQUEST_CONTEXT=ja,Ie.SESSION_CONTEXT=$a,Ie.SESSION_EXPIRY=$r,Ie.SESSION_REQUEST_EXPIRY_BOUNDARIES=gn,Ie.SIGN_CLIENT_CONTEXT=$i,Ie.SIGN_CLIENT_DEFAULT=pn,Ie.SIGN_CLIENT_EVENTS=V_,Ie.SIGN_CLIENT_PROTOCOL=Li,Ie.SIGN_CLIENT_STORAGE_OPTIONS=G_,Ie.SIGN_CLIENT_STORAGE_PREFIX=dn,Ie.SIGN_CLIENT_VERSION=Ui,Ie.SignClient=oy,Ie.default=_n,Object.defineProperty(Ie,"__esModule",{value:!0})});
//# sourceMappingURL=index.umd.js.map
